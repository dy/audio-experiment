<!DOCTYPE html>
<html>
<head>
<title>---</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta charset=utf-8></head>
<body></body>
<script>
!function(){"use strict";var e=Object.prototype.toString,t=function(t){var n=e.call(t),r="[object Arguments]"===n;return r||(r="[object Array]"!==n&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),r},n={},r=Object.prototype.hasOwnProperty,a=Object.prototype.toString,i=Array.prototype.slice,o=Object.prototype.propertyIsEnumerable,s=!o.call({toString:null},"toString"),f=o.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(e){var t=e.constructor;return t&&t.prototype===e},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!c["$"+e]&&r.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{l(window[e])}catch(e){return!0}}catch(e){return!0}return!1}(),p=function(e){var n=null!==e&&"object"==typeof e,i="[object Function]"===a.call(e),o=t(e),c=n&&"[object String]"===a.call(e),p=[];if(!n&&!i&&!o)throw new TypeError("Object.keys called on a non-object");var d=f&&i;if(c&&e.length>0&&!r.call(e,0))for(var g=0;g<e.length;++g)p.push(String(g));if(o&&e.length>0)for(var m=0;m<e.length;++m)p.push(String(m));else for(var y in e)d&&"prototype"===y||!r.call(e,y)||p.push(String(y));if(s)for(var v=function(e){if("undefined"==typeof window||!h)return l(e);try{return l(e)}catch(e){return!1}}(e),b=0;b<u.length;++b)v&&"constructor"===u[b]||!r.call(e,u[b])||p.push(u[b]);return p};p.shim=function(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var e=Object.keys;Object.keys=function(n){return t(n)?e(i.call(n)):e(n)}}}else Object.keys=p;return Object.keys||p},n=p;var d={},g="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),m=Object.prototype.toString,y=Array.prototype.concat,v=Object.defineProperty,b=v&&function(){var e={};try{for(var t in v(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),w=function(e,t,n,r){(!(t in e)||function(e){return"function"==typeof e&&"[object Function]"===m.call(e)}(r)&&r())&&(b?v(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},x=function(e,t){var r=arguments.length>2?arguments[2]:{},a=n(t);g&&(a=y.call(a,Object.getOwnPropertySymbols(t)));for(var i=0;i<a.length;i+=1)w(e,a[i],t[a[i]],r[a[i]])};x.supportsDescriptors=!!b,d=x;var A={};(function(e){var t=e.Symbol;A=function(){return"function"==typeof t&&"function"==typeof Symbol&&"symbol"==typeof t("foo")&&"symbol"==typeof Symbol("bar")&&function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var a=Object.getOwnPropertyDescriptor(e,t);if(42!==a.value||!0!==a.enumerable)return!1}return!0}()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var C={},O=Object.prototype.toString;if(A()){var _=Symbol.prototype.toString,S=/^Symbol\(.*\)$/;C=function(e){if("symbol"==typeof e)return!0;if("[object Symbol]"!==O.call(e))return!1;try{return function(e){return"symbol"==typeof e.valueOf()&&S.test(_.call(e))}(e)}catch(e){return!1}}}else C=function(e){return!1};var k={};(function(e){var t="__ global cache key __";"function"==typeof Symbol&&C(Symbol("foo"))&&"function"==typeof Symbol.for&&(t=Symbol.for(t));var n=function(){return!0},r=function(){if(!e[t]){var r={};r[t]={};var a={};a[t]=n,d(e,r,a)}return e[t]},a=r(),i=function(e){return C(e)?Symbol.prototype.valueOf.call(e):typeof e+" | "+String(e)},o=function(e){if(!function(e){return null===e||"object"!=typeof e&&"function"!=typeof e}(e))throw new TypeError("key must not be an object")},s={clear:function(){delete e[t],a=r()},delete:function(e){return o(e),delete a[i(e)],!s.has(e)},get:function(e){return o(e),a[i(e)]},has:function(e){return o(e),i(e)in a},set:function(e,t){o(e);var r=i(e),f={};f[r]=t;var u={};return u[r]=n,d(a,f,u),s.has(e)},setIfMissingThenGet:function(e,t){if(s.has(e))return s.get(e);var n=t();return s.set(e,n),n}};k=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var E={};!function(){if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=g);var e=!1;if("function"==typeof WeakMap){var t=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var n=new t,r=Object.freeze({});if(n.set(r,1),1===n.get(r))return void(E=WeakMap);e=!0}}Object.prototype.hasOwnProperty;var a=Object.getOwnPropertyNames,i=Object.defineProperty,o=Object.isExtensible,s="weakmap:",f=s+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var u=new ArrayBuffer(25),l=new Uint8Array(u);crypto.getRandomValues(l),f=s+"rand:"+Array.prototype.map.call(l,function(e){return(e%36).toString(36)}).join("")+"___"}if(i(Object,"getOwnPropertyNames",{value:function(e){return a(e).filter(m)}}),"getPropertyNames"in Object){var c=Object.getPropertyNames;i(Object,"getPropertyNames",{value:function(e){return c(e).filter(m)}})}!function(){var e=Object.freeze;i(Object,"freeze",{value:function(t){return y(t),e(t)}});var t=Object.seal;i(Object,"seal",{value:function(e){return y(e),t(e)}});var n=Object.preventExtensions;i(Object,"preventExtensions",{value:function(e){return y(e),n(e)}})}();var h=!1,p=0,d=function(){this instanceof d||b();var e=[],t=[],n=p++;return Object.create(d.prototype,{get___:{value:v(function(r,a){var i,o=y(r);return o?n in o?o[n]:a:(i=e.indexOf(r))>=0?t[i]:a})},has___:{value:v(function(t){var r=y(t);return r?n in r:e.indexOf(t)>=0})},set___:{value:v(function(r,a){var i,o=y(r);return o?o[n]=a:(i=e.indexOf(r))>=0?t[i]=a:(i=e.length,t[i]=a,e[i]=r),this})},delete___:{value:v(function(r){var a,i,o=y(r);return o?n in o&&delete o[n]:!((a=e.indexOf(r))<0||(i=e.length-1,e[a]=void 0,t[a]=t[i],e[a]=e[i],e.length=i,t.length=i,0))})}})};d.prototype=Object.create(Object.prototype,{get:{value:function(e,t){return this.get___(e,t)},writable:!0,configurable:!0},has:{value:function(e){return this.has___(e)},writable:!0,configurable:!0},set:{value:function(e,t){return this.set___(e,t)},writable:!0,configurable:!0},delete:{value:function(e){return this.delete___(e)},writable:!0,configurable:!0}}),"function"==typeof t?function(){function n(){this instanceof d||b();var n,r=new t,a=void 0,i=!1;return n=e?function(e,t){return r.set(e,t),r.has(e)||(a||(a=new d),a.set(e,t)),this}:function(e,t){if(i)try{r.set(e,t)}catch(n){a||(a=new d),a.set___(e,t)}else r.set(e,t);return this},Object.create(d.prototype,{get___:{value:v(function(e,t){return a?r.has(e)?r.get(e):a.get___(e,t):r.get(e,t)})},has___:{value:v(function(e){return r.has(e)||!!a&&a.has___(e)})},set___:{value:v(n)},delete___:{value:v(function(e){var t=!!r.delete(e);return a&&a.delete___(e)||t})},permitHostObjects___:{value:v(function(e){if(e!==g)throw new Error("bogus call to permitHostObjects___");i=!0})}})}e&&"undefined"!=typeof Proxy&&(Proxy=void 0),n.prototype=d.prototype,E=n,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),E=d)}function g(e){e.permitHostObjects___&&e.permitHostObjects___(g)}function m(e){return!(e.substr(0,s.length)==s&&"___"===e.substr(e.length-3))}function y(e){if(e!==Object(e))throw new TypeError("Not an object: "+e);var t=e[f];if(t&&t.key===e)return t;if(o(e)){t={key:e};try{return i(e,f,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}catch(e){return}}}function v(e){return e.prototype=null,Object.freeze(e)}function b(){h||"undefined"==typeof console||(h=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}();var T={},D=k.get("emmy");function R(e,t){if(!e._ns)return!1;for(var n=t.length;n--;)if(e._ns.indexOf(t[n])>=0)return!0}D||(D=new E,k.set("emmy",D)),T={get:function(e,t,n){var r,a=D.get(e);if(!t){if(r=a||{},n&&n.length){var i={};for(var t in r)i[t]=r[t].filter(function(e){return R(e,n)});r=i}return r}return a&&a[t]?(r=a[t],n&&n.length&&(r=r.filter(function(e){return R(e,n)})),r):[]},remove:function(e,t,n,r){var a=D.get(e);if(!a||!a[t])return!1;var i=a[t];if(r&&r.length&&!R(n,r))return!1;for(var o=0;o<i.length;o++)if(i[o]===n){i.splice(o,1);break}},add:function(e,t,n,r){if(n){var a=D.get(e);a||(a={},D.set(e,a)),(a[t]=a[t]||[]).push(n),r&&r.length&&(n._ns=r)}}};var F={freeze:function(e,t){var n=j.get(e);return!(n&&n[t]||(n||(n={},j.set(e,n)),n[t]=!0,0))},unfreeze:function(e,t){var n=j.get(e);return!(!n||!n[t]||(n[t]=null,0))},isFrozen:function(e,t){var n=j.get(e);return n&&n[t]}},j=new WeakMap;var B=function(e,t,n,r){if(e){var a=arguments;return"string"==typeof t?(a=[].slice.call(arguments,2),t.split(/\s+/).forEach(function(t){z.apply(this,[e,t].concat(a))}),e):z.apply(this,a)}},I="undefined"==typeof jQuery?void 0:jQuery,P="undefined"==typeof document?void 0:document,L="undefined"==typeof window?void 0:window;function z(e,t,n,r){var a,i=t;P&&(e instanceof Node||e===L)?(P&&t instanceof Event?i=t:(i=P.createEvent("CustomEvent")).initCustomEvent(t,r,!0,n),a=e.dispatchEvent):I&&e instanceof I?((i=I.Event(t,n)).detail=n,a=r?targte.trigger:e.triggerHandler):a=e.dispatchEvent||e.emit||e.trigger||e.fire||e.raise;var o=[].slice.call(arguments,2);if(a&&F.freeze(e,"emit"+t))return a.apply(e,[i].concat(o)),F.unfreeze(e,"emit"+t),e;var s=i.split(".");i=s.shift();for(var f=T.get(e,i,s).slice(),u=0;u<f.length;u++)f[u]&&f[u].apply(e,o);return e}var N=function e(t,n,r){if(!t)return t;var a;if(void 0===r){var i=[].slice.call(arguments,1),o=t.removeAll||t.removeAllListeners;if(o&&o.apply(t,i),!n){for(n in a=T.get(t))e(t,n);return t}if("function"==typeof n){for(n in r=n,n=null,a=T.get(t))a[n].indexOf(r)>=0&&e(t,n,r);return t}return(n=""+n).split(/\s+/).forEach(function(n){var r=n.split(".");if(n=r.shift(),a=T.get(t,n,r),n){var i={};i[n]=a,a=i}for(var o in a)[].slice.call(a[o]).forEach(function(n){e(t,o,n)})}),t}Array.isArray(n)||(n=(n+"").split(/\s+/));var s=t.removeEventListener||t.removeListener||t.detachEvent||t.off;if(n.forEach(function(e){var n=e.split(".");if(e=n.shift(),s){if(!F.freeze(t,"off"+e))return t;s.call(t,e,r),F.unfreeze(t,"off"+e)}T.remove(t,e,r,n)}),r.__planned&&(r.__planned=!1),r.__wrapFn){var f=r.__wrapFn;r.__wrapFn=null,e(t,n,f)}r.__origFn&&(f=r.__origFn,r.__origFn=null,e(t,n,f));return t};var M=Object.prototype.toString,U=function(e){var t;return"[object Object]"===M.call(e)&&(null===(t=Object.getPrototypeOf(e))||t===Object.getPrototypeOf({}))},q={};(function(e){q=function e(n,r,a,i){if(!n)return n;if("function"==typeof i){var o=i;i=a,a=o}if("number"==typeof i?i={throttle:i}:("string"==typeof i||t&&(i instanceof Node||Array.isArray(i)))&&(i={delegate:i}),i){for(;a.__wrapFn;)a=a.__wrapFn;null!=i.throttle&&(a.__wrapFn=function e(t){var n=this.cb,r=this.o.throttle,a=this.target;if(n.__blocked)n.__planned=!0;else{n.apply(a,arguments);var i=this;n.__blocked=setTimeout(function(){n.__blocked=!1,n.__planned&&(e.apply(i,arguments),n.__planned=null)},r)}}.bind({target:n,o:i,cb:a}),a.__wrapFn.__origFn=a,a=a.__wrapFn),null!=i.delegate&&(a.__wrapFn=function(e){var t=this.cb,n=this.o.delegate,r=this.target,a=e.target;a!==r&&(Array.isArray(n)||(n=[n]),n.some(function(t){var n;if("string"!=typeof t){if(!t.contains(a))return!1;n=t}else n=a.closest&&a.closest(t);return!(!n||r===n||!r.contains(n)||(e.delegateTarget=n,0))})&&t.apply(a,arguments))}.bind({target:n,o:i,cb:a}),a.__wrapFn.__origFn=a,a=a.__wrapFn)}if(U(r)){for(var s in r)e(n,s,r[s]);return n}Array.isArray(r)||(r=(r+"").split(/\s+/));var f=n.addEventListener||n.addListener||n.attachEvent||n.on;return r.forEach(function(e){var t=e.split(".");if(e=t.shift(),f){if(!F.freeze(n,"on"+e))return n;f.call(n,e,a),F.unfreeze(n,"on"+e)}T.add(n,e,a,t)}),n};var t=e.document}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var W;function H(e){return e?(e.on=q.bind(e,e),e.off=N.bind(e,e),e.emit=B.bind(e,e),e):H({})}H.on=q,H.off=N,H.emit=B,W=H;var V=function(e,t,n){return t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e},Y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},$=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},Q={};(function(e){Q=function(n){var r,a,i=[],o=1;if("string"==typeof n)if(Y[n])i=Y[n].slice(),a="rgb";else if("transparent"===n)o=0,a="rgb",i=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(n)){var s=n.slice(1);o=1,(u=s.length)<=4?(i=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===u&&(o=parseInt(s[3]+s[3],16)/255)):(i=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===u&&(o=parseInt(s[6]+s[7],16)/255)),i[0]||(i[0]=0),i[1]||(i[1]=0),i[2]||(i[2]=0),a="rgb"}else if(r=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(n)){var f=r[1];a=s=f.replace(/a$/,"");var u="cmyk"===s?4:"gray"===s?1:3;i=r[2].trim().split(/\s*,\s*/).map(function(e,n){if(/%$/.test(e))return n===u?parseFloat(e)/100:"rgb"===s?255*parseFloat(e)/100:parseFloat(e);if("h"===s[n]){if(/deg$/.test(e))return parseFloat(e);if(void 0!==t[e])return t[e]}return parseFloat(e)}),f===s&&i.push(1),o=void 0===i[u]?1:i[u],i=i.slice(0,u)}else n.length>10&&/[0-9](?:\s|\/)/.test(n)&&(i=n.match(/([0-9]+)/g).map(function(e){return parseFloat(e)}),a=n.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(n))if(U(n)){var l=$(n.r,n.red,n.R,null);null!==l?(a="rgb",i=[l,$(n.g,n.green,n.G),$(n.b,n.blue,n.B)]):(a="hsl",i=[$(n.h,n.hue,n.H),$(n.s,n.saturation,n.S),$(n.l,n.lightness,n.L,n.b,n.brightness)]),o=$(n.a,n.alpha,n.opacity,1),null!=n.opacity&&(o/=100)}else(Array.isArray(n)||e.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(n))&&(i=[n[0],n[1],n[2]],a="rgb",o=4===n.length?n[3]:1);else a="rgb",i=[n>>>16,(65280&n)>>>8,255&n];return{space:a,values:i,alpha:o}};var t={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var G;G={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var t,n,r,a,i,o=e[0]/360,s=e[1]/100,f=e[2]/100;if(0===s)return[i=255*f,i,i];t=2*f-(n=f<.5?f*(1+s):f+s-f*s),a=[0,0,0];for(var u=0;u<3;u++)(r=o+1/3*-(u-1))<0?r++:r>1&&r--,i=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,a[u]=255*i;return a}};var X=function(e,t){"float"!==t&&t||(t="array"),"uint"===t&&(t="uint8"),"uint_clamped"===t&&(t="uint8_clamped");var n=new(function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}(t))(4),r="uint8"!==t&&"uint8_clamped"!==t;return e.length&&"string"!=typeof e||((e=function(e){var t,n=Q(e);return n.space?((t=Array(3))[0]=V(n.values[0],0,255),t[1]=V(n.values[1],0,255),t[2]=V(n.values[2],0,255),"h"===n.space[0]&&(t=G.rgb(t)),t.push(V(n.alpha,0,1)),t):[]}(e))[0]/=255,e[1]/=255,e[2]/=255),function(e){return e instanceof Uint8Array||e instanceof Uint8ClampedArray||!!(Array.isArray(e)&&(e[0]>1||0===e[0])&&(e[1]>1||0===e[1])&&(e[2]>1||0===e[2])&&(!e[3]||e[3]>1))}(e)?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=null!=e[3]?e[3]:255,r&&(n[0]/=255,n[1]/=255,n[2]/=255,n[3]/=255),n):(r?(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=null!=e[3]?e[3]:1):(n[0]=V(Math.floor(255*e[0]),0,255),n[1]=V(Math.floor(255*e[1]),0,255),n[2]=V(Math.floor(255*e[2]),0,255),n[3]=null==e[3]?255:V(Math.floor(255*e[3]),0,255)),n)},Z=function(e,t,n){var r,a,i={};if("string"==typeof t&&(t=K(t)),Array.isArray(t)){var o={};for(a=0;a<t.length;a++)o[t[a]]=!0;t=o}for(r in t)t[r]=K(t[r]);var s={};for(r in t){var f=t[r];if(Array.isArray(f))for(a=0;a<f.length;a++){var u=f[a];if(n&&(s[u]=!0),u in e){if(i[r]=e[u],n)for(var l=a;l<f.length;l++)s[f[l]]=!0;break}}else r in e&&(t[r]&&(i[r]=e[r]),n&&(s[r]=!0))}if(n)for(r in e)s[r]||(i[r]=e[r]);return i},J={};function K(e){return J[e]?J[e]:("string"==typeof e&&(e=J[e]=e.split(/\s*,\s*|\s+/)),e)}var ee={};(function(e){function t(t){if(t.container)if(t.container==document.body)document.body.style.width||(t.canvas.width=t.width||t.pixelRatio*e.innerWidth),document.body.style.height||(t.canvas.height=t.height||t.pixelRatio*e.innerHeight);else{var n=t.container.getBoundingClientRect();t.canvas.width=t.width||n.right-n.left,t.canvas.height=t.height||n.bottom-n.top}}function n(e){return"function"==typeof e.getContext&&"width"in e&&"height"in e}function r(){var e=document.createElement("canvas");return e.style.position="absolute",e.style.top=0,e.style.left=0,e}ee=function(a){if(a?"string"==typeof a&&(a={container:a}):a={},(a=n(a)?{container:a}:function(e){return"string"==typeof e.nodeName&&"function"==typeof e.appendChild&&"function"==typeof e.getBoundingClientRect}(a)?{container:a}:function(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}(a)?{gl:a}:Z(a,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0)).pixelRatio||(a.pixelRatio=e.pixelRatio||1),a.gl)return a.gl;if(a.canvas&&(a.container=a.canvas.parentNode),a.container){if("string"==typeof a.container){var i=document.querySelector(a.container);if(!i)throw Error("Element "+a.container+" is not found");a.container=i}n(a.container)?(a.canvas=a.container,a.container=a.canvas.parentNode):a.canvas||(a.canvas=r(),a.container.appendChild(a.canvas),t(a))}else if(!a.canvas){if("undefined"==typeof document)throw Error("Not DOM environment. Use headless-gl.");a.container=document.body||document.documentElement,a.canvas=r(),a.container.appendChild(a.canvas),t(a)}if(!a.gl)try{a.gl=a.canvas.getContext("webgl",a.attrs)}catch(i){try{a.gl=a.canvas.getContext("experimental-webgl",a.attrs)}catch(i){a.gl=a.canvas.getContext("webgl-experimental",a.attrs)}}return a.gl}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var te=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")},ne=!0;var re=e=>Object.is(e,-0),ae=function(e,t){return null==e?0:re(e)?t:e<=-t?0:e<0?t+e%t:Math.min(t,e)},ie=Object.getOwnPropertySymbols,oe=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var fe=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,r,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),i=1;i<arguments.length;i++){for(var o in n=Object(arguments[i]))oe.call(n,o)&&(a[o]=n[o]);if(ie){r=ie(n);for(var s=0;s<r.length;s++)se.call(n,r[s])&&(a[r[s]]=n[r[s]])}}return a},ue={};function le(e,t){if(!e)throw new Error(t||"AssertionError")}le.notEqual=function(e,t,n){le(e!=t,n)},le.notOk=function(e,t){le(!e,t)},le.equal=function(e,t,n){le(e==t,n)},le.ok=le,ue=le;var ce={},he="undefined"!=typeof window,pe=he&&window.requestIdleCallback;var de=function e(t,n){var r;return n=n||ce,ue.equal(typeof t,"function","on-idle: cb should be type function"),ue.equal(typeof n,"object","on-idle: opts should be type object"),pe?(r=window.requestIdleCallback(function(r){if(r.timeRemaining()<=1&&!r.didTimeout)return e(t,n);t(r)},n),window.cancelIdleCallback.bind(window,r)):he?(r=setTimeout(t,0),clearTimeout.bind(window,r)):void 0};var ge,me,ye=function(e){var t;return arguments.length>1&&(e=arguments),"string"==typeof e?e=e.split(/\s/).map(parseFloat):"number"==typeof e&&(e=[e]),e.length&&"number"==typeof e[0]?t=1===e.length?{width:e[0],height:e[0],x:0,y:0}:2===e.length?{width:e[0],height:e[1],x:0,y:0}:{x:e[0],y:e[1],width:e[2]-e[0]||0,height:e[3]-e[1]||0}:e&&(t={x:(e=Z(e,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"})).left||0,y:e.top||0},null==e.width?e.right?t.width=e.right-t.x:t.width=0:t.width=e.width,null==e.height?e.bottom?t.height=e.bottom-t.y:t.height=0:t.height=e.height),t},ve=function(e,t){t||(t=[0,""]),e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t},be={exports:{}};ge=this,me=function(){function e(e,t){this.id=U++,this.type=e,this.data=t}function t(e){return"["+function e(t){if(0===t.length)return[];var n=t.charAt(0),r=t.charAt(t.length-1);if(1<t.length&&n===r&&('"'===n||"'"===n))return['"'+t.substr(1,t.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t))return e(t.substr(0,n.index)).concat(e(n[1])).concat(e(t.substr(n.index+n[0].length)));if(1===(n=t.split(".")).length)return['"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(t=[],r=0;r<n.length;++r)t=t.concat(e(n[r]));return t}(e).join("][")+"]"}function n(e){return"string"==typeof e?e.split():e}function r(e){return"string"==typeof e?document.querySelector(e):e}function a(e){var t,a,i,o,s=e||{};e={};var f=[],u=[],l="undefined"==typeof window?1:window.devicePixelRatio,c=!1,h=function(e){},p=function(){};if("string"==typeof s?t=document.querySelector(s):"object"==typeof s&&("string"==typeof s.nodeName&&"function"==typeof s.appendChild&&"function"==typeof s.getBoundingClientRect?t=s:"function"==typeof s.drawArrays||"function"==typeof s.drawElements?i=(o=s).canvas:("gl"in s?o=s.gl:"canvas"in s?i=r(s.canvas):"container"in s&&(a=r(s.container)),"attributes"in s&&(e=s.attributes),"extensions"in s&&(f=n(s.extensions)),"optionalExtensions"in s&&(u=n(s.optionalExtensions)),"onDone"in s&&(h=s.onDone),"profile"in s&&(c=!!s.profile),"pixelRatio"in s&&(l=+s.pixelRatio))),t&&("canvas"===t.nodeName.toLowerCase()?i=t:a=t),!o){if(!i){if(!(t=function(e,t,n){function r(){var t=window.innerWidth,r=window.innerHeight;e!==document.body&&(t=(r=e.getBoundingClientRect()).right-r.left,r=r.bottom-r.top),a.width=n*t,a.height=n*r,M(a.style,{width:t+"px",height:r+"px"})}var a=document.createElement("canvas");return M(a.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(a),e===document.body&&(a.style.position="absolute",M(e.style,{margin:0,padding:0})),window.addEventListener("resize",r,!1),r(),{canvas:a,onDestroy:function(){window.removeEventListener("resize",r),e.removeChild(a)}}}(a||document.body,0,l)))return null;i=t.canvas,p=t.onDestroy}o=function(e,t){function n(n){try{return e.getContext(n,t)}catch(e){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}(i,e)}return o?{gl:o,canvas:i,container:a,extensions:f,optionalExtensions:u,pixelRatio:l,profile:c,onDone:h,onDestroy:p}:(p(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function i(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}function o(e){var t,n;return t=(65535<e)<<4,t|=n=(255<(e>>>=t))<<3,(t|=n=(15<(e>>>=n))<<2)|(n=(3<(e>>>=n))<<1)|e>>>n>>1}function s(){function e(e){e:{for(var t=16;268435456>=t;t*=16)if(e<=t){e=t;break e}e=0}return 0<(t=n[o(e)>>2]).length?t.pop():new ArrayBuffer(e)}function t(e){n[o(e.byteLength)>>2].push(e)}var n=i(8,function(){return[]});return{alloc:e,free:t,allocType:function(t,n){var r=null;switch(t){case 5120:r=new Int8Array(e(n),0,n);break;case 5121:r=new Uint8Array(e(n),0,n);break;case 5122:r=new Int16Array(e(2*n),0,n);break;case 5123:r=new Uint16Array(e(2*n),0,n);break;case 5124:r=new Int32Array(e(4*n),0,n);break;case 5125:r=new Uint32Array(e(4*n),0,n);break;case 5126:r=new Float32Array(e(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r},freeType:function(e){t(e.buffer)}}}function f(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||$(e.data))}function u(e,t,n,r,a,i){for(var o=0;o<t;++o)for(var s=e[o],f=0;f<n;++f)for(var u=s[f],l=0;l<r;++l)a[i++]=u[l]}function l(e){return 0|X[Object.prototype.toString.call(e)]}function c(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function h(e,t,n,r,a,i,o){for(var s=0,f=0;f<n;++f)for(var u=0;u<r;++u)e[s++]=t[a*f+i*u+o]}function p(e,t,n,r){function a(t){this.id=u++,this.buffer=e.createBuffer(),this.type=t,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,n.profile&&(this.stats={size:0})}function i(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function o(e,t,n,r,a,o){if(e.usage=n,Array.isArray(t)){if(e.dtype=r||5126,0<t.length)if(Array.isArray(t[0])){a=ee(t);for(var s=r=1;s<a.length;++s)r*=a[s];e.dimension=r,i(e,t=K(t,a,e.dtype),n),o?e.persistentData=t:V.freeType(t)}else"number"==typeof t[0]?(e.dimension=a,c(a=V.allocType(e.dtype,t.length),t),i(e,a,n),o?e.persistentData=a:V.freeType(a)):$(t[0])&&(e.dimension=t[0].length,e.dtype=r||l(t[0])||5126,i(e,t=K(t,[t.length,t[0].length],e.dtype),n),o?e.persistentData=t:V.freeType(t))}else if($(t))e.dtype=r||l(t),e.dimension=a,i(e,t,n),o&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(f(t)){a=t.shape;var u=t.stride,p=(s=t.offset,0),d=0,g=0,m=0;1===a.length?(p=a[0],d=1,g=u[0],m=0):2===a.length&&(p=a[0],d=a[1],g=u[0],m=u[1]),e.dtype=r||l(t.data)||5126,e.dimension=d,h(a=V.allocType(e.dtype,p*d),t.data,p,d,g,m,s),i(e,a,n),o?e.persistentData=a:V.freeType(a)}}function s(n){t.bufferCount--;for(var a=0;a<r.state.length;++a){var i=r.state[a];i.buffer===n&&(e.disableVertexAttribArray(a),i.buffer=null)}e.deleteBuffer(n.buffer),n.buffer=null,delete p[n.id]}var u=0,p={};a.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},a.prototype.destroy=function(){s(this)};var d=[];return n.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(p).forEach(function(t){e+=p[t].stats.size}),e}),{create:function(r,i,u,d){function g(t){var r=35044,a=null,i=0,s=0,u=1;return Array.isArray(t)||$(t)||f(t)?a=t:"number"==typeof t?i=0|t:t&&("data"in t&&(a=t.data),"usage"in t&&(r=J[t.usage]),"type"in t&&(s=Z[t.type]),"dimension"in t&&(u=0|t.dimension),"length"in t&&(i=0|t.length)),m.bind(),a?o(m,a,r,s,u,d):(i&&e.bufferData(m.type,i,r),m.dtype=s||5121,m.usage=r,m.dimension=u,m.byteLength=i),n.profile&&(m.stats.size=m.byteLength*te[m.dtype]),g}t.bufferCount++;var m=new a(i);return p[m.id]=m,u||g(r),g._reglType="buffer",g._buffer=m,g.subdata=function(t,n){var r,a=0|(n||0);if(m.bind(),$(t))e.bufferSubData(m.type,a,t);else if(Array.isArray(t)){if(0<t.length)if("number"==typeof t[0]){var i=V.allocType(m.dtype,t.length);c(i,t),e.bufferSubData(m.type,a,i),V.freeType(i)}else(Array.isArray(t[0])||$(t[0]))&&(r=ee(t),i=K(t,r,m.dtype),e.bufferSubData(m.type,a,i),V.freeType(i))}else if(f(t)){r=t.shape;var o=t.stride,s=i=0,u=0,p=0;1===r.length?(i=r[0],s=1,u=o[0],p=0):2===r.length&&(i=r[0],s=r[1],u=o[0],p=o[1]),r=Array.isArray(t.data)?m.dtype:l(t.data),h(r=V.allocType(r,i*s),t.data,i,s,u,p,t.offset),e.bufferSubData(m.type,a,r),V.freeType(r)}return g},n.profile&&(g.stats=m.stats),g.destroy=function(){s(m)},g},createStream:function(e,t){var n=d.pop();return n||(n=new a(e)),n.bind(),o(n,t,35040,0,1,!1),n},destroyStream:function(e){d.push(e)},clear:function(){Q(p).forEach(s),d.forEach(s)},getBuffer:function(e){return e&&e._buffer instanceof a?e._buffer:null},restore:function(){Q(p).forEach(function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)})},_initBuffer:o}}function d(e,t,n,r){function a(e){this.id=u++,s[this.id]=this,this.buffer=e,this.primType=4,this.type=this.vertCount=0}function i(r,a,i,o,s,u,l){if(r.buffer.bind(),a){var c=l;l||$(a)&&(!f(a)||$(a.data))||(c=t.oes_element_index_uint?5125:5123),n._initBuffer(r.buffer,a,i,c,3)}else e.bufferData(34963,u,i),r.buffer.dtype=c||5121,r.buffer.usage=i,r.buffer.dimension=3,r.buffer.byteLength=u;if(c=l,!l){switch(r.buffer.dtype){case 5121:case 5120:c=5121;break;case 5123:case 5122:c=5123;break;case 5125:case 5124:c=5125}r.buffer.dtype=c}r.type=c,0>(a=s)&&(a=r.buffer.byteLength,5123===c?a>>=1:5125===c&&(a>>=2)),r.vertCount=a,a=o,0>o&&(a=4,1===(o=r.buffer.dimension)&&(a=0),2===o&&(a=1),3===o&&(a=4)),r.primType=a}function o(e){r.elementsCount--,delete s[e.id],e.buffer.destroy(),e.buffer=null}var s={},u=0,l={uint8:5121,uint16:5123};t.oes_element_index_uint&&(l.uint32=5125),a.prototype.bind=function(){this.buffer.bind()};var c=[];return{create:function(e,t){function s(e){if(e)if("number"==typeof e)u(e),c.primType=4,c.vertCount=0|e,c.type=5121;else{var t=null,n=35044,r=-1,a=-1,o=0,h=0;Array.isArray(e)||$(e)||f(e)?t=e:("data"in e&&(t=e.data),"usage"in e&&(n=J[e.usage]),"primitive"in e&&(r=ne[e.primitive]),"count"in e&&(a=0|e.count),"type"in e&&(h=l[e.type]),"length"in e?o=0|e.length:(o=a,5123===h||5122===h?o*=2:5125!==h&&5124!==h||(o*=4))),i(c,t,n,r,a,o,h)}else u(),c.primType=4,c.vertCount=0,c.type=5121;return s}var u=n.create(null,34963,!0),c=new a(u._buffer);return r.elementsCount++,s(e),s._reglType="elements",s._elements=c,s.subdata=function(e,t){return u.subdata(e,t),s},s.destroy=function(){o(c)},s},createStream:function(e){var t=c.pop();return t||(t=new a(n.create(null,34963,!0,!1)._buffer)),i(t,e,35040,-1,-1,0,0),t},destroyStream:function(e){c.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof a?e._elements:null},clear:function(){Q(s).forEach(o)}}}function g(e){for(var t=V.allocType(5123,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(1/0===e[n])t[n]=31744;else if(-1/0===e[n])t[n]=64512;else{re[0]=e[n];var r=(i=ae[0])>>>31<<15,a=(i<<1>>>24)-127,i=i>>13&1023;t[n]=-24>a?r:-14>a?r+(i+1024>>-14-a):15<a?r+31744:r+(a+15<<10)+i}return t}function m(e){return Array.isArray(e)||$(e)}function y(e){return"[object "+e+"]"}function v(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function b(e){return!(!Array.isArray(e)||0===e.length||!m(e[0]))}function w(e){return Object.prototype.toString.call(e)}function x(e){if(!e)return!1;var t=w(e);return 0<=pe.indexOf(t)||v(e)||b(e)||f(e)}function A(e,t){36193===e.type?(e.data=g(t),V.freeType(t)):e.data=t}function C(e,t,n,r,a,i){if(e=void 0!==ge[e]?ge[e]:se[e]*de[t],i&&(e*=6),a){for(r=0;1<=n;)r+=e*n*n,n/=2;return r}return e*n*r}function O(e,t,n,r,a,i,o){function s(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function u(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function l(e,t){if("object"==typeof t&&t){"premultiplyAlpha"in t&&(e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(e.flipY=t.flipY),"alignment"in t&&(e.unpackAlignment=t.alignment),"colorSpace"in t&&(e.colorSpace=W[t.colorSpace]),"type"in t&&(e.type=H[t.type]);var n=e.width,r=e.height,a=e.channels,i=!1;"shape"in t?(n=t.shape[0],r=t.shape[1],3===t.shape.length&&(a=t.shape[2],i=!0)):("radius"in t&&(n=r=t.radius),"width"in t&&(n=t.width),"height"in t&&(r=t.height),"channels"in t&&(a=t.channels,i=!0)),e.width=0|n,e.height=0|r,e.channels=0|a,n=!1,"format"in t&&(n=t.format,r=e.internalformat=Y[n],e.format=pe[r],n in H&&!("type"in t)&&(e.type=H[n]),n in Z&&(e.compressed=!0),n=!0),!i&&n?e.channels=se[e.format]:i&&!n&&e.channels!==oe[e.format]&&(e.format=e.internalformat=oe[e.channels])}}function c(t){e.pixelStorei(37440,t.flipY),e.pixelStorei(37441,t.premultiplyAlpha),e.pixelStorei(37443,t.colorSpace),e.pixelStorei(3317,t.unpackAlignment)}function h(){s.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function p(e,t){var n=null;if(x(t)?n=t:t&&(l(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),x(t.data)&&(n=t.data)),t.copy){var r=a.viewportWidth,i=a.viewportHeight;e.width=e.width||r-e.xOffset,e.height=e.height||i-e.yOffset,e.needsCopy=!0}else if(n){if($(n))e.channels=e.channels||4,e.data=n,"type"in t||5121!==e.type||(e.type=0|X[Object.prototype.toString.call(n)]);else if(v(n)){switch(e.channels=e.channels||4,i=(r=n).length,e.type){case 5121:case 5123:case 5125:case 5126:(i=V.allocType(e.type,i)).set(r),e.data=i;break;case 36193:e.data=g(r)}e.alignment=1,e.needsFree=!0}else if(f(n)){r=n.data,Array.isArray(r)||5121!==e.type||(e.type=0|X[Object.prototype.toString.call(r)]),i=n.shape;var o,s,u,c,h=n.stride;3===i.length?(u=i[2],c=h[2]):c=u=1,o=i[0],s=i[1],i=h[0],h=h[1],e.alignment=1,e.width=o,e.height=s,e.channels=u,e.format=e.internalformat=oe[u],e.needsFree=!0,o=c,n=n.offset,u=e.width,c=e.height,s=e.channels;for(var p=V.allocType(36193===e.type?5126:e.type,u*c*s),d=0,y=0;y<c;++y)for(var C=0;C<u;++C)for(var O=0;O<s;++O)p[d++]=r[i*C+h*y+o*O+n];A(e,p)}else if(w(n)===fe||w(n)===ue)w(n)===fe?e.element=n:e.element=n.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(w(n)===le)e.element=n,e.width=n.width,e.height=n.height,e.channels=4;else if(w(n)===ce)e.element=n,e.width=n.naturalWidth,e.height=n.naturalHeight,e.channels=4;else if(w(n)===he)e.element=n,e.width=n.videoWidth,e.height=n.videoHeight,e.channels=4;else if(b(n)){for(r=e.width||n[0].length,i=e.height||n.length,h=e.channels,h=m(n[0][0])?h||n[0][0].length:h||1,o=G.shape(n),u=1,c=0;c<o.length;++c)u*=o[c];u=V.allocType(36193===e.type?5126:e.type,u),G.flatten(n,o,"",u),A(e,u),e.alignment=1,e.width=r,e.height=i,e.channels=h,e.format=e.internalformat=oe[h],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4}function d(t,n,a,i,o){var s=t.element,f=t.data,u=t.internalformat,l=t.format,h=t.type,p=t.width,d=t.height;c(t),s?e.texSubImage2D(n,o,a,i,l,h,s):t.compressed?e.compressedTexSubImage2D(n,o,a,i,u,p,d,f):t.needsCopy?(r(),e.copyTexSubImage2D(n,o,a,i,t.xOffset,t.yOffset,p,d)):e.texSubImage2D(n,o,a,i,p,d,l,h,f)}function y(){return de.pop()||new h}function O(e){e.needsFree&&V.freeType(e.data),h.call(e),de.push(e)}function _(){s.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function S(e,t,n){var r=e.images[0]=y();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function k(e,t){var n=null;if(x(t))u(n=e.images[0]=y(),e),p(n,t),e.mipmask=1;else if(l(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,a=0;a<r.length;++a)u(n=e.images[a]=y(),e),n.width>>=a,n.height>>=a,p(n,r[a]),e.mipmask|=1<<a;else u(n=e.images[0]=y(),e),p(n,t),e.mipmask=1;u(e,e.images[0])}function E(t,n){for(var a=t.images,i=0;i<a.length&&a[i];++i){var o=a[i],s=n,f=i,u=o.element,l=o.data,h=o.internalformat,p=o.format,d=o.type,g=o.width,m=o.height,y=o.channels;c(o),u?e.texImage2D(s,f,p,p,d,u):o.compressed?e.compressedTexImage2D(s,f,h,g,m,0,l):o.needsCopy?(r(),e.copyTexImage2D(s,f,p,o.xOffset,o.yOffset,g,m,0)):((o=!l)&&(l=V.zero.allocType(d,g*m*y)),e.texImage2D(s,f,p,g,m,0,p,d,l),o&&l&&V.zero.freeType(l))}}function T(){var e=ge.pop()||new _;s.call(e);for(var t=e.mipmask=0;16>t;++t)e.images[t]=null;return e}function D(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&O(t[n]),t[n]=null;ge.push(e)}function R(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function F(e,t){"min"in t&&(e.minFilter=q[t.min],0<=ie.indexOf(e.minFilter)&&!("faces"in t)&&(e.genMipmaps=!0)),"mag"in t&&(e.magFilter=U[t.mag]);var n=e.wrapS,r=e.wrapT;if("wrap"in t){var a=t.wrap;"string"==typeof a?n=r=N[a]:Array.isArray(a)&&(n=N[a[0]],r=N[a[1]])}else"wrapS"in t&&(n=N[t.wrapS]),"wrapT"in t&&(r=N[t.wrapT]);if(e.wrapS=n,e.wrapT=r,"anisotropic"in t&&(e.anisotropic=t.anisotropic),"mipmap"in t){switch(n=!1,typeof t.mipmap){case"string":e.mipmapHint=z[t.mipmap],n=e.genMipmaps=!0;break;case"boolean":n=e.genMipmaps=t.mipmap;break;case"object":e.genMipmaps=!1,n=!0}!n||"min"in t||(e.minFilter=9984)}}function j(n,r){e.texParameteri(r,10241,n.minFilter),e.texParameteri(r,10240,n.magFilter),e.texParameteri(r,10242,n.wrapS),e.texParameteri(r,10243,n.wrapT),t.ext_texture_filter_anisotropic&&e.texParameteri(r,34046,n.anisotropic),n.genMipmaps&&(e.hint(33170,n.mipmapHint),e.generateMipmap(r))}function B(t){s.call(this),this.mipmask=0,this.internalformat=6408,this.id=me++,this.refCount=1,this.target=t,this.texture=e.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new R,o.profile&&(this.stats={size:0})}function I(t){e.activeTexture(33984),e.bindTexture(t.target,t.texture)}function P(){var t=be[0];t?e.bindTexture(t.target,t.texture):e.bindTexture(3553,null)}function L(t){var n=t.texture,r=t.unit,a=t.target;0<=r&&(e.activeTexture(33984+r),e.bindTexture(a,null),be[r]=null),e.deleteTexture(n),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete ye[t.id],i.textureCount--}var z={"don't care":4352,"dont care":4352,nice:4354,fast:4353},N={repeat:10497,clamp:33071,mirror:33648},U={nearest:9728,linear:9729},q=M({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},U),W={none:0,browser:37444},H={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Y={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Z={};t.ext_srgb&&(Y.srgb=35904,Y.srgba=35906),t.oes_texture_float&&(H.float32=H.float=5126),t.oes_texture_half_float&&(H.float16=H["half float"]=36193),t.webgl_depth_texture&&(M(Y,{depth:6402,"depth stencil":34041}),M(H,{uint16:5123,uint32:5125,"depth stencil":34042})),t.webgl_compressed_texture_s3tc&&M(Z,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),t.webgl_compressed_texture_atc&&M(Z,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),t.webgl_compressed_texture_pvrtc&&M(Z,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),t.webgl_compressed_texture_etc1&&(Z["rgb etc1"]=36196);var J=Array.prototype.slice.call(e.getParameter(34467));Object.keys(Z).forEach(function(e){var t=Z[e];0<=J.indexOf(t)&&(Y[e]=t)});var K=Object.keys(Y);n.textureFormats=K;var ee=[];Object.keys(Y).forEach(function(e){ee[Y[e]]=e});var te=[];Object.keys(H).forEach(function(e){te[H[e]]=e});var ne=[];Object.keys(U).forEach(function(e){ne[U[e]]=e});var re=[];Object.keys(q).forEach(function(e){re[q[e]]=e});var ae=[];Object.keys(N).forEach(function(e){ae[N[e]]=e});var pe=K.reduce(function(e,t){var n=Y[t];return 6409===n||6406===n||6409===n||6410===n||6402===n||34041===n?e[n]=n:32855===n||0<=t.indexOf("rgba")?e[n]=6408:e[n]=6407,e},{}),de=[],ge=[],me=0,ye={},ve=n.maxTextureUnits,be=Array(ve).map(function(){return null});return M(B.prototype,{bind:function(){this.bindCount+=1;var t=this.unit;if(0>t){for(var n=0;n<ve;++n){var r=be[n];if(r){if(0<r.bindCount)continue;r.unit=-1}be[n]=this,t=n;break}o.profile&&i.maxTextureUnits<t+1&&(i.maxTextureUnits=t+1),this.unit=t,e.activeTexture(33984+t),e.bindTexture(this.target,this.texture)}return t},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&L(this)}}),o.profile&&(i.getTotalTextureSize=function(){var e=0;return Object.keys(ye).forEach(function(t){e+=ye[t].stats.size}),e}),{create2D:function(t,n){function r(e,t){var n=a.texInfo;R.call(n);var i=T();return"number"==typeof e?S(i,0|e,"number"==typeof t?0|t:0|e):e?(F(n,e),k(i,e)):S(i,1,1),n.genMipmaps&&(i.mipmask=(i.width<<1)-1),a.mipmask=i.mipmask,u(a,i),a.internalformat=i.internalformat,r.width=i.width,r.height=i.height,I(a),E(i,3553),j(n,3553),P(),D(i),o.profile&&(a.stats.size=C(a.internalformat,a.type,i.width,i.height,n.genMipmaps,!1)),r.format=ee[a.internalformat],r.type=te[a.type],r.mag=ne[n.magFilter],r.min=re[n.minFilter],r.wrapS=ae[n.wrapS],r.wrapT=ae[n.wrapT],r}var a=new B(3553);return ye[a.id]=a,i.textureCount++,r(t,n),r.subimage=function(e,t,n,i){t|=0,n|=0,i|=0;var o=y();return u(o,a),o.width=0,o.height=0,p(o,e),o.width=o.width||(a.width>>i)-t,o.height=o.height||(a.height>>i)-n,I(a),d(o,3553,t,n,i),P(),O(o),r},r.resize=function(t,n){var i=0|t,s=0|n||i;if(i===a.width&&s===a.height)return r;r.width=a.width=i,r.height=a.height=s,I(a);for(var f,u=a.channels,l=a.type,c=0;a.mipmask>>c;++c){var h=i>>c,p=s>>c;if(!h||!p)break;f=V.zero.allocType(l,h*p*u),e.texImage2D(3553,c,a.format,h,p,0,a.format,a.type,f),f&&V.zero.freeType(f)}return P(),o.profile&&(a.stats.size=C(a.internalformat,a.type,i,s,!1,!1)),r},r._reglType="texture2d",r._texture=a,o.profile&&(r.stats=a.stats),r.destroy=function(){a.decRef()},r},createCube:function(t,n,r,a,s,f){function c(e,t,n,r,a,i){var s,f=h.texInfo;for(R.call(f),s=0;6>s;++s)g[s]=T();if("number"!=typeof e&&e){if("object"==typeof e)if(t)k(g[0],e),k(g[1],t),k(g[2],n),k(g[3],r),k(g[4],a),k(g[5],i);else if(F(f,e),l(h,e),"faces"in e)for(e=e.faces,s=0;6>s;++s)u(g[s],h),k(g[s],e[s]);else for(s=0;6>s;++s)k(g[s],e)}else for(e=0|e||1,s=0;6>s;++s)S(g[s],e,e);for(u(h,g[0]),h.mipmask=f.genMipmaps?(g[0].width<<1)-1:g[0].mipmask,h.internalformat=g[0].internalformat,c.width=g[0].width,c.height=g[0].height,I(h),s=0;6>s;++s)E(g[s],34069+s);for(j(f,34067),P(),o.profile&&(h.stats.size=C(h.internalformat,h.type,c.width,c.height,f.genMipmaps,!0)),c.format=ee[h.internalformat],c.type=te[h.type],c.mag=ne[f.magFilter],c.min=re[f.minFilter],c.wrapS=ae[f.wrapS],c.wrapT=ae[f.wrapT],s=0;6>s;++s)D(g[s]);return c}var h=new B(34067);ye[h.id]=h,i.cubeCount++;var g=Array(6);return c(t,n,r,a,s,f),c.subimage=function(e,t,n,r,a){n|=0,r|=0,a|=0;var i=y();return u(i,h),i.width=0,i.height=0,p(i,t),i.width=i.width||(h.width>>a)-n,i.height=i.height||(h.height>>a)-r,I(h),d(i,34069+e,n,r,a),P(),O(i),c},c.resize=function(t){if((t|=0)!==h.width){c.width=h.width=t,c.height=h.height=t,I(h);for(var n=0;6>n;++n)for(var r=0;h.mipmask>>r;++r)e.texImage2D(34069+n,r,h.format,t>>r,t>>r,0,h.format,h.type,null);return P(),o.profile&&(h.stats.size=C(h.internalformat,h.type,c.width,c.height,!1,!0)),c}},c._reglType="textureCube",c._texture=h,o.profile&&(c.stats=h.stats),c.destroy=function(){h.decRef()},c},clear:function(){for(var t=0;t<ve;++t)e.activeTexture(33984+t),e.bindTexture(3553,null),be[t]=null;Q(ye).forEach(L),i.cubeCount=0,i.textureCount=0},getTexture:function(e){return null},restore:function(){for(var t=0;t<ve;++t){var n=be[t];n&&(n.bindCount=0,n.unit=-1,be[t]=null)}Q(ye).forEach(function(t){t.texture=e.createTexture(),e.bindTexture(t.target,t.texture);for(var n=0;32>n;++n)if(0!=(t.mipmask&1<<n))if(3553===t.target)e.texImage2D(3553,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);else for(var r=0;6>r;++r)e.texImage2D(34069+r,n,t.internalformat,t.width>>n,t.height>>n,0,t.internalformat,t.type,null);j(t.texInfo,t.target)})}}}function _(e,t,n,r,a,i){function o(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=e=0;t?(e=t.width,r=t.height):n&&(e=n.width,r=n.height),this.width=e,this.height=r}function s(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function f(e,t,n){e&&(e.texture?e.texture._texture.refCount+=1:e.renderbuffer._renderbuffer.refCount+=1)}function u(t,n){n&&(n.texture?e.framebufferTexture2D(36160,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(36160,t,36161,n.renderbuffer._renderbuffer.renderbuffer))}function l(e){var t=3553,n=null,r=null,a=e;return"object"==typeof e&&(a=e.data,"target"in e&&(t=0|e.target)),"texture2d"===(e=a._reglType)?n=a:"textureCube"===e?n=a:"renderbuffer"===e&&(r=a,t=36161),new o(t,n,r)}function c(e,t,n,i,s){return n?((e=r.create2D({width:e,height:t,format:i,type:s}))._texture.refCount=0,new o(3553,e,null)):((e=a.create({width:e,height:t,format:i}))._renderbuffer.refCount=0,new o(36161,null,e))}function h(e){return e&&(e.texture||e.renderbuffer)}function p(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}function d(){this.id=C++,O[this.id]=this,this.framebuffer=e.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function g(e){e.colorAttachments.forEach(s),s(e.depthAttachment),s(e.stencilAttachment),s(e.depthStencilAttachment)}function m(t){e.deleteFramebuffer(t.framebuffer),t.framebuffer=null,i.framebufferCount--,delete O[t.id]}function y(t){var r;e.bindFramebuffer(36160,t.framebuffer);var a=t.colorAttachments;for(r=0;r<a.length;++r)u(36064+r,a[r]);for(r=a.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(36160,36064+r,3553,null,0);e.framebufferTexture2D(36160,33306,3553,null,0),e.framebufferTexture2D(36160,36096,3553,null,0),e.framebufferTexture2D(36160,36128,3553,null,0),u(36096,t.depthAttachment),u(36128,t.stencilAttachment),u(33306,t.depthStencilAttachment),e.checkFramebufferStatus(36160),e.isContextLost(),e.bindFramebuffer(36160,b.next?b.next.framebuffer:null),b.cur=b.next,e.getError()}function v(e,t){function n(e,t){var a,i=0,o=0,s=!0,u=!0;a=null;var p=!0,d="rgba",m="uint8",v=1,b=null,A=null,C=null,O=!1;"number"==typeof e?(i=0|e,o=0|t||i):e?("shape"in e?(i=(o=e.shape)[0],o=o[1]):("radius"in e&&(i=o=e.radius),"width"in e&&(i=e.width),"height"in e&&(o=e.height)),("color"in e||"colors"in e)&&(a=e.color||e.colors,Array.isArray(a)),a||("colorCount"in e&&(v=0|e.colorCount),"colorTexture"in e&&(p=!!e.colorTexture,d="rgba4"),"colorType"in e&&(m=e.colorType,!p)&&("half float"===m||"float16"===m?d="rgba16f":"float"!==m&&"float32"!==m||(d="rgba32f")),"colorFormat"in e&&(d=e.colorFormat,0<=w.indexOf(d)?p=!0:0<=x.indexOf(d)&&(p=!1))),("depthTexture"in e||"depthStencilTexture"in e)&&(O=!(!e.depthTexture&&!e.depthStencilTexture)),"depth"in e&&("boolean"==typeof e.depth?s=e.depth:(b=e.depth,u=!1)),"stencil"in e&&("boolean"==typeof e.stencil?u=e.stencil:(A=e.stencil,s=!1)),"depthStencil"in e&&("boolean"==typeof e.depthStencil?s=u=e.depthStencil:(C=e.depthStencil,u=s=!1))):i=o=1;var _=null,S=null,k=null,E=null;if(Array.isArray(a))_=a.map(l);else if(a)_=[l(a)];else for(_=Array(v),a=0;a<v;++a)_[a]=c(i,o,p,d,m);for(i=i||_[0].width,o=o||_[0].height,b?S=l(b):s&&!u&&(S=c(i,o,O,"depth","uint32")),A?k=l(A):u&&!s&&(k=c(i,o,!1,"stencil","uint8")),C?E=l(C):!b&&!A&&u&&s&&(E=c(i,o,O,"depth stencil","depth stencil")),s=null,a=0;a<_.length;++a)f(_[a]),_[a]&&_[a].texture&&(u=ve[_[a].texture._texture.format]*be[_[a].texture._texture.type],null===s&&(s=u));return f(S),f(k),f(E),g(r),r.width=i,r.height=o,r.colorAttachments=_,r.depthAttachment=S,r.stencilAttachment=k,r.depthStencilAttachment=E,n.color=_.map(h),n.depth=h(S),n.stencil=h(k),n.depthStencil=h(E),n.width=r.width,n.height=r.height,y(r),n}var r=new d;return i.framebufferCount++,n(e,t),M(n,{resize:function(e,t){var a=Math.max(0|e,1),i=Math.max(0|t||a,1);if(a===r.width&&i===r.height)return n;for(var o=r.colorAttachments,s=0;s<o.length;++s)p(o[s],a,i);return p(r.depthAttachment,a,i),p(r.stencilAttachment,a,i),p(r.depthStencilAttachment,a,i),r.width=n.width=a,r.height=n.height=i,y(r),n},_reglType:"framebuffer",_framebuffer:r,destroy:function(){m(r),g(r)},use:function(e){b.setFBO({framebuffer:n},e)}})}var b={cur:null,next:null,dirty:!1,setFBO:null},w=["rgba"],x=["rgba4","rgb565","rgb5 a1"];t.ext_srgb&&x.push("srgba"),t.ext_color_buffer_half_float&&x.push("rgba16f","rgb16f"),t.webgl_color_buffer_float&&x.push("rgba32f");var A=["uint8"];t.oes_texture_half_float&&A.push("half float","float16"),t.oes_texture_float&&A.push("float","float32");var C=0,O={};return M(b,{getFramebuffer:function(e){return"function"==typeof e&&"framebuffer"===e._reglType&&(e=e._framebuffer)instanceof d?e:null},create:v,createCube:function(e){function t(e){var a,i={color:null},o=0,s=null;a="rgba";var f="uint8",u=1;if("number"==typeof e?o=0|e:e?("shape"in e?o=e.shape[0]:("radius"in e&&(o=0|e.radius),"width"in e?o=0|e.width:"height"in e&&(o=0|e.height)),("color"in e||"colors"in e)&&(s=e.color||e.colors,Array.isArray(s)),s||("colorCount"in e&&(u=0|e.colorCount),"colorType"in e&&(f=e.colorType),"colorFormat"in e&&(a=e.colorFormat)),"depth"in e&&(i.depth=e.depth),"stencil"in e&&(i.stencil=e.stencil),"depthStencil"in e&&(i.depthStencil=e.depthStencil)):o=1,s)if(Array.isArray(s))for(e=[],a=0;a<s.length;++a)e[a]=s[a];else e=[s];else for(e=Array(u),s={radius:o,format:a,type:f},a=0;a<u;++a)e[a]=r.createCube(s);for(i.color=Array(e.length),a=0;a<e.length;++a)u=e[a],o=o||u.width,i.color[a]={target:34069,data:e[a]};for(a=0;6>a;++a){for(u=0;u<e.length;++u)i.color[u].target=34069+a;0<a&&(i.depth=n[0].depth,i.stencil=n[0].stencil,i.depthStencil=n[0].depthStencil),n[a]?n[a](i):n[a]=v(i)}return M(t,{width:o,height:o,color:e})}var n=Array(6);return t(e),M(t,{faces:n,resize:function(e){var r=0|e;if(r===t.width)return t;var a=t.color;for(e=0;e<a.length;++e)a[e].resize(r);for(e=0;6>e;++e)n[e].resize(r);return t.width=t.height=r,t},_reglType:"framebufferCube",destroy:function(){n.forEach(function(e){e.destroy()})}})},clear:function(){Q(O).forEach(m)},restore:function(){b.cur=null,b.next=null,b.dirty=!0,Q(O).forEach(function(t){t.framebuffer=e.createFramebuffer(),y(t)})}})}function S(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function k(e,t,n,r){function a(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function i(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function o(n,r,a){if(!(o=(a=35632===n?u:l)[r])){var i=t.str(r),o=e.createShader(n);e.shaderSource(o,i),e.compileShader(o),a[r]=o}return o}function s(e,t){this.id=p++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function f(n,s){var f,u;f=o(35632,n.fragId),u=o(35633,n.vertId);var l=n.program=e.createProgram();e.attachShader(l,f),e.attachShader(l,u),e.linkProgram(l);var c=e.getProgramParameter(l,35718);r.profile&&(n.stats.uniformsCount=c);var h=n.uniforms;for(f=0;f<c;++f)if(u=e.getActiveUniform(l,f))if(1<u.size)for(var p=0;p<u.size;++p){var d=u.name.replace("[0]","["+p+"]");i(h,new a(d,t.id(d),e.getUniformLocation(l,d),u))}else i(h,new a(u.name,t.id(u.name),e.getUniformLocation(l,u.name),u));for(c=e.getProgramParameter(l,35721),r.profile&&(n.stats.attributesCount=c),h=n.attributes,f=0;f<c;++f)(u=e.getActiveAttrib(l,f))&&i(h,new a(u.name,t.id(u.name),e.getAttribLocation(l,u.name),u))}var u={},l={},c={},h=[],p=0;return r.profile&&(n.getMaxUniformsCount=function(){var e=0;return h.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},n.getMaxAttributesCount=function(){var e=0;return h.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);Q(u).forEach(t),u={},Q(l).forEach(t),l={},h.forEach(function(t){e.deleteProgram(t.program)}),h.length=0,c={},n.shaderCount=0},program:function(e,t,r){var a=c[t];a||(a=c[t]={});var i=a[e];return i||(i=new s(t,e),n.shaderCount++,f(i),a[e]=i,h.push(i)),i},restore:function(){u={},l={};for(var e=0;e<h.length;++e)f(h[e])},shader:o,frag:-1,vert:-1}}function E(e,t,n,r,a,i,o){function s(a){var i;i=null===t.next?5121:t.next.colorAttachments[0].texture._texture.type;var o=0,s=0,f=r.framebufferWidth,u=r.framebufferHeight,l=null;return $(a)?l=a:a&&(o=0|a.x,s=0|a.y,f=0|(a.width||r.framebufferWidth-o),u=0|(a.height||r.framebufferHeight-s),l=a.data||null),n(),a=f*u*4,l||(5121===i?l=new Uint8Array(a):5126===i&&(l=l||new Float32Array(a))),e.pixelStorei(3333,4),e.readPixels(o,s,f,u,6408,i,l),l}return function(e){return e&&"framebuffer"in e?function(e){var n;return t.setFBO({framebuffer:e.framebuffer},function(){n=s(e)}),n}(e):s(e)}}function T(e){return Array.prototype.slice.call(e)}function D(e){return T(e).join("")}function R(){function e(){var e=[],t=[];return M(function(){e.push.apply(e,T(arguments))},{def:function(){var r="v"+n++;return t.push(r),0<arguments.length&&(e.push(r,"="),e.push.apply(e,T(arguments)),e.push(";")),r},toString:function(){return D([0<t.length?"var "+t+";":"",D(e)])}})}function t(){function t(e,t){r(e,t,"=",n.def(e,t),";")}var n=e(),r=e(),a=n.toString,i=r.toString;return M(function(){n.apply(n,T(arguments))},{def:n.def,entry:n,exit:r,save:t,set:function(e,r,a){t(e,r),n(e,r,"=",a,";")},toString:function(){return a()+i()}})}var n=0,r=[],a=[],i=e(),o={};return{global:i,link:function(e){for(var t=0;t<a.length;++t)if(a[t]===e)return r[t];return t="g"+n++,r.push(t),a.push(e),t},block:e,proc:function(e,n){function r(){var e="a"+a.length;return a.push(e),e}var a=[];n=n||0;for(var i=0;i<n;++i)r();var s=(i=t()).toString;return o[e]=M(i,{arg:r,toString:function(){return D(["function(",a.join(),"){",s(),"}"])}})},scope:t,cond:function(){var e=D(arguments),n=t(),r=t(),a=n.toString,i=r.toString;return M(n,{then:function(){return n.apply(n,T(arguments)),this},else:function(){return r.apply(r,T(arguments)),this},toString:function(){var t=i();return t&&(t="else{"+t+"}"),D(["if(",e,"){",a(),"}",t])}})},compile:function(){var e=['"use strict";',i,"return {"];Object.keys(o).forEach(function(t){e.push('"',t,'":',o[t].toString(),",")}),e.push("}");var t=D(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(t)).apply(null,a)}}}function F(e){return Array.isArray(e)||$(e)||f(e)}function j(e){return e.sort(function(e,t){return"viewport"===e?-1:"viewport"===t?1:e<t?-1:1})}function B(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function I(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function P(e){return new B(!1,!1,!1,e)}function L(e,t){var n=e.type;return 0===n?new B(!0,1<=(n=e.data.length),2<=n,t):4===n?new B((n=e.data).thisDep,n.contextDep,n.propDep,t):new B(3===n,2===n,1===n,t)}function z(e,t,n,r,a,o,s,f,u,l,c,h,p,d,g){function y(e){return e.replace(".","_")}function v(e,t,n){var r=y(e);re.push(e),te[r]=ee[r]=!!n,ae[r]=t}function b(e,t,n){var r=y(e);re.push(e),Array.isArray(n)?(ee[r]=n.slice(),te[r]=n.slice()):ee[r]=te[r]=n,ie[r]=t}function w(){var e=R(),n=e.link,r=e.global;e.id=fe++,e.batchId="0";var a=n(oe),i=e.shared={props:"a0"};Object.keys(oe).forEach(function(e){i[e]=r.def(a,".",e)});var o=e.next={},s=e.current={};Object.keys(ie).forEach(function(e){Array.isArray(ee[e])&&(o[e]=r.def(i.next,".",e),s[e]=r.def(i.current,".",e))});var f=e.constants={};Object.keys(se).forEach(function(e){f[e]=r.def(JSON.stringify(se[e]))}),e.invoke=function(t,r){switch(r.type){case 0:var a=["this",i.context,i.props,e.batchId];return t.def(n(r.data),".call(",a.slice(0,Math.max(r.data.length+1,4)),")");case 1:return t.def(i.props,r.data);case 2:return t.def(i.context,r.data);case 3:return t.def("this",r.data);case 4:return r.data.append(e,t),r.data.ref}},e.attribCache={};var u={};return e.scopeAttrib=function(e){if((e=t.id(e))in u)return u[e];var r=l.scope[e];return r||(r=l.scope[e]=new G),u[e]=n(r)},e}function x(e,t){var n=e.static,r=e.dynamic;if("framebuffer"in n){var a=n.framebuffer;return a?(a=f.getFramebuffer(a),P(function(e,t){var n=e.link(a),r=e.shared;return t.set(r.framebuffer,".next",n),r=r.context,t.set(r,".framebufferWidth",n+".width"),t.set(r,".framebufferHeight",n+".height"),n})):P(function(e,t){var n=e.shared;return t.set(n.framebuffer,".next","null"),n=n.context,t.set(n,".framebufferWidth",n+".drawingBufferWidth"),t.set(n,".framebufferHeight",n+".drawingBufferHeight"),"null"})}if("framebuffer"in r){var i=r.framebuffer;return L(i,function(e,t){var n=e.invoke(t,i),r=e.shared,a=r.framebuffer;return n=t.def(a,".getFramebuffer(",n,")"),t.set(a,".next",n),r=r.context,t.set(r,".framebufferWidth",n+"?"+n+".width:"+r+".drawingBufferWidth"),t.set(r,".framebufferHeight",n+"?"+n+".height:"+r+".drawingBufferHeight"),n})}return null}function A(e){function n(e){if(e in r){var n=t.id(r[e]);return(e=P(function(){return n})).id=n,e}if(e in a){var i=a[e];return L(i,function(e,t){var n=e.invoke(t,i);return t.def(e.shared.strings,".id(",n,")")})}return null}var r=e.static,a=e.dynamic,i=n("frag"),o=n("vert"),s=null;return I(i)&&I(o)?(s=c.program(o.id,i.id),e=P(function(e,t){return e.link(s)})):e=new B(i&&i.thisDep||o&&o.thisDep,i&&i.contextDep||o&&o.contextDep,i&&i.propDep||o&&o.propDep,function(e,t){var n,r,a=e.shared.shader;return n=i?i.append(e,t):t.def(a,".","frag"),r=o?o.append(e,t):t.def(a,".","vert"),t.def(a+".program("+r+","+n+")")}),{frag:i,vert:o,progVar:e,program:s}}function C(e,t){function n(e,t){if(e in r){var n=0|r[e];return P(function(e,r){return t&&(e.OFFSET=n),n})}if(e in a){var o=a[e];return L(o,function(e,n){var r=e.invoke(n,o);return t&&(e.OFFSET=r),r})}return t&&i?P(function(e,t){return e.OFFSET="0",0}):null}var r=e.static,a=e.dynamic,i=function(){if("elements"in r){var e=r.elements;F(e)?e=o.getElements(o.create(e,!0)):e&&(e=o.getElements(e));var t=P(function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r}return t.ELEMENTS=null});return t.value=e,t}if("elements"in a){var n=a.elements;return L(n,function(e,t){var r=(a=e.shared).isBufferArgs,a=a.elements,i=e.invoke(t,n),o=t.def("null");return r=t.def(r,"(",i,")"),i=e.cond(r).then(o,"=",a,".createStream(",i,");").else(o,"=",a,".getElements(",i,");"),t.entry(i),t.exit(e.cond(r).then(a,".destroyStream(",o,");")),e.ELEMENTS=o})}return null}(),s=n("offset",!0);return{elements:i,primitive:function(){if("primitive"in r){var e=r.primitive;return P(function(t,n){return ne[e]})}if("primitive"in a){var t=a.primitive;return L(t,function(e,n){var r=e.constants.primTypes,a=e.invoke(n,t);return n.def(r,"[",a,"]")})}return i?I(i)?i.value?P(function(e,t){return t.def(e.ELEMENTS,".primType")}):P(function(){return 4}):new B(i.thisDep,i.contextDep,i.propDep,function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",4)}):null}(),count:function(){if("count"in r){var e=0|r.count;return P(function(){return e})}if("count"in a){var t=a.count;return L(t,function(e,n){return e.invoke(n,t)})}return i?I(i)?i?s?new B(s.thisDep,s.contextDep,s.propDep,function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)}):P(function(e,t){return t.def(e.ELEMENTS,".vertCount")}):P(function(){return-1}):new B(i.thisDep||s.thisDep,i.contextDep||s.contextDep,i.propDep||s.propDep,function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}):null}(),instances:n("instances",!1),offset:s}}function O(e,n){var r=e.static,i=e.dynamic,o={};return Object.keys(r).forEach(function(e){var n=r[e],i=t.id(e),s=new G;if(F(n))s.state=1,s.buffer=a.getBuffer(a.create(n,34962,!1,!0)),s.type=0;else if(u=a.getBuffer(n))s.state=1,s.buffer=u,s.type=0;else if("constant"in n){var f=n.constant;s.buffer="null",s.state=2,"number"==typeof f?s.x=f:we.forEach(function(e,t){t<f.length&&(s[e]=f[t])})}else{var u=F(n.buffer)?a.getBuffer(a.create(n.buffer,34962,!1,!0)):a.getBuffer(n.buffer),l=0|n.offset,c=0|n.stride,h=0|n.size,p=!!n.normalized,d=0;"type"in n&&(d=Z[n.type]),n=0|n.divisor,s.buffer=u,s.state=1,s.size=h,s.normalized=p,s.type=d||u.dtype,s.offset=l,s.stride=c,s.divisor=n}o[e]=P(function(e,t){var n=e.attribCache;if(i in n)return n[i];var r={isStream:!1};return Object.keys(s).forEach(function(e){r[e]=s[e]}),s.buffer&&(r.buffer=e.link(s.buffer),r.type=r.type||r.buffer+".dtype"),n[i]=r})}),Object.keys(i).forEach(function(e){var t=i[e];o[e]=L(t,function(e,n){function r(e){n(f[e],"=",a,".",e,"|0;")}var a=e.invoke(n,t),i=e.shared,o=i.isBufferArgs,s=i.buffer,f={isStream:n.def(!1)},u=new G;u.state=1,Object.keys(u).forEach(function(e){f[e]=n.def(""+u[e])});var l=f.buffer,c=f.type;return n("if(",o,"(",a,")){",f.isStream,"=true;",l,"=",s,".createStream(",34962,",",a,");",c,"=",l,".dtype;","}else{",l,"=",s,".getBuffer(",a,");","if(",l,"){",c,"=",l,".dtype;",'}else if("constant" in ',a,"){",f.state,"=",2,";","if(typeof "+a+'.constant === "number"){',f[we[0]],"=",a,".constant;",we.slice(1).map(function(e){return f[e]}).join("="),"=0;","}else{",we.map(function(e,t){return f[e]+"="+a+".constant.length>"+t+"?"+a+".constant["+t+"]:0;"}).join(""),"}}else{","if(",o,"(",a,".buffer)){",l,"=",s,".createStream(",34962,",",a,".buffer);","}else{",l,"=",s,".getBuffer(",a,".buffer);","}",c,'="type" in ',a,"?",i.glTypes,"[",a,".type]:",l,".dtype;",f.normalized,"=!!",a,".normalized;"),r("size"),r("offset"),r("stride"),r("divisor"),n("}}"),n.exit("if(",f.isStream,"){",s,".destroyStream(",l,");","}"),f})}),o}function _(e,t,n,r,a){var o=x(e),s=function(e,t,n){function r(e){if(e in a){var n=a[e];e=!0;var r,o,s=0|n.x,f=0|n.y;return"width"in n?r=0|n.width:e=!1,"height"in n?o=0|n.height:e=!1,new B(!e&&t&&t.thisDep,!e&&t&&t.contextDep,!e&&t&&t.propDep,function(e,t){var a=e.shared.context,i=r;"width"in n||(i=t.def(a,".","framebufferWidth","-",s));var u=o;return"height"in n||(u=t.def(a,".","framebufferHeight","-",f)),[s,f,i,u]})}if(e in i){var u=i[e];return e=L(u,function(e,t){var n=e.invoke(t,u),r=e.shared.context,a=t.def(n,".x|0"),i=t.def(n,".y|0");return[a,i,t.def('"width" in ',n,"?",n,".width|0:","(",r,".","framebufferWidth","-",a,")"),n=t.def('"height" in ',n,"?",n,".height|0:","(",r,".","framebufferHeight","-",i,")")]}),t&&(e.thisDep=e.thisDep||t.thisDep,e.contextDep=e.contextDep||t.contextDep,e.propDep=e.propDep||t.propDep),e}return t?new B(t.thisDep,t.contextDep,t.propDep,function(e,t){var n=e.shared.context;return[0,0,t.def(n,".","framebufferWidth"),t.def(n,".","framebufferHeight")]}):null}var a=e.static,i=e.dynamic;if(e=r("viewport")){var o=e;e=new B(e.thisDep,e.contextDep,e.propDep,function(e,t){var n=o.append(e,t),r=e.shared.context;return t.set(r,".viewportWidth",n[2]),t.set(r,".viewportHeight",n[3]),n})}return{viewport:e,scissor_box:r("scissor.box")}}(e,o),f=C(e),u=function(e,t){var n=e.static,r=e.dynamic,a={};return re.forEach(function(e){function t(t,i){if(e in n){var s=t(n[e]);a[o]=P(function(){return s})}else if(e in r){var f=r[e];a[o]=L(f,function(e,t){return i(e,t,e.invoke(t,f))})}}var o=y(e);switch(e){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return t(function(e){return e},function(e,t,n){return n});case"depth.func":return t(function(e){return Ce[e]},function(e,t,n){return t.def(e.constants.compareFuncs,"[",n,"]")});case"depth.range":return t(function(e){return e},function(e,t,n){return[t.def("+",n,"[0]"),t=t.def("+",n,"[1]")]});case"blend.func":return t(function(e){return[Ae["srcRGB"in e?e.srcRGB:e.src],Ae["dstRGB"in e?e.dstRGB:e.dst],Ae["srcAlpha"in e?e.srcAlpha:e.src],Ae["dstAlpha"in e?e.dstAlpha:e.dst]]},function(e,t,n){function r(e,r){return t.def('"',e,r,'" in ',n,"?",n,".",e,r,":",n,".",e)}e=e.constants.blendFuncs;var a=r("src","RGB"),i=r("dst","RGB"),o=(a=t.def(e,"[",a,"]"),t.def(e,"[",r("src","Alpha"),"]"));return[a,i=t.def(e,"[",i,"]"),o,e=t.def(e,"[",r("dst","Alpha"),"]")]});case"blend.equation":return t(function(e){return"string"==typeof e?[X[e],X[e]]:"object"==typeof e?[X[e.rgb],X[e.alpha]]:void 0},function(e,t,n){var r=e.constants.blendEquations,a=t.def(),i=t.def();return(e=e.cond("typeof ",n,'==="string"')).then(a,"=",i,"=",r,"[",n,"];"),e.else(a,"=",r,"[",n,".rgb];",i,"=",r,"[",n,".alpha];"),t(e),[a,i]});case"blend.color":return t(function(e){return i(4,function(t){return+e[t]})},function(e,t,n){return i(4,function(e){return t.def("+",n,"[",e,"]")})});case"stencil.mask":return t(function(e){return 0|e},function(e,t,n){return t.def(n,"|0")});case"stencil.func":return t(function(e){return[Ce[e.cmp||"keep"],e.ref||0,"mask"in e?e.mask:-1]},function(e,t,n){return[e=t.def('"cmp" in ',n,"?",e.constants.compareFuncs,"[",n,".cmp]",":",7680),t.def(n,".ref|0"),t=t.def('"mask" in ',n,"?",n,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return t(function(t){return["stencil.opBack"===e?1029:1028,Oe[t.fail||"keep"],Oe[t.zfail||"keep"],Oe[t.zpass||"keep"]]},function(t,n,r){function a(e){return n.def('"',e,'" in ',r,"?",i,"[",r,".",e,"]:",7680)}var i=t.constants.stencilOps;return["stencil.opBack"===e?1029:1028,a("fail"),a("zfail"),a("zpass")]});case"polygonOffset.offset":return t(function(e){return[0|e.factor,0|e.units]},function(e,t,n){return[t.def(n,".factor|0"),t=t.def(n,".units|0")]});case"cull.face":return t(function(e){var t=0;return"front"===e?t=1028:"back"===e&&(t=1029),t},function(e,t,n){return t.def(n,'==="front"?',1028,":",1029)});case"lineWidth":return t(function(e){return e},function(e,t,n){return n});case"frontFace":return t(function(e){return _e[e]},function(e,t,n){return t.def(n+'==="cw"?2304:2305')});case"colorMask":return t(function(e){return e.map(function(e){return!!e})},function(e,t,n){return i(4,function(e){return"!!"+n+"["+e+"]"})});case"sample.coverage":return t(function(e){return["value"in e?e.value:1,!!e.invert]},function(e,t,n){return[t.def('"value" in ',n,"?+",n,".value:1"),t=t.def("!!",n,".invert")]})}}),a}(e),l=A(e),c=s.viewport;return c&&(u.viewport=c),(s=s[c=y("scissor.box")])&&(u[c]=s),(o={framebuffer:o,draw:f,shader:l,state:u,dirty:s=0<Object.keys(u).length}).profile=function(e){var t,n=e.static;if(e=e.dynamic,"profile"in n){var r=!!n.profile;(t=P(function(e,t){return r})).enable=r}else if("profile"in e){var a=e.profile;t=L(a,function(e,t){return e.invoke(t,a)})}return t}(e),o.uniforms=function(e,t){var n=e.static,r=e.dynamic,a={};return Object.keys(n).forEach(function(e){var t,r=n[e];if("number"==typeof r||"boolean"==typeof r)t=P(function(){return r});else if("function"==typeof r){var o=r._reglType;"texture2d"===o||"textureCube"===o?t=P(function(e){return e.link(r)}):"framebuffer"!==o&&"framebufferCube"!==o||(t=P(function(e){return e.link(r.color[0])}))}else m(r)&&(t=P(function(e){return e.global.def("[",i(r.length,function(e){return r[e]}),"]")}));t.value=r,a[e]=t}),Object.keys(r).forEach(function(e){var t=r[e];a[e]=L(t,function(e,n){return e.invoke(n,t)})}),a}(n),o.attributes=O(t),o.context=function(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach(function(e){var n=t[e];r[e]=P(function(e,t){return"number"==typeof n||"boolean"==typeof n?""+n:e.link(n)})}),Object.keys(n).forEach(function(e){var t=n[e];r[e]=L(t,function(e,n){return e.invoke(n,t)})}),r}(r),o}function S(e,t,n){var r=e.shared.context,a=e.scope();Object.keys(n).forEach(function(i){t.save(r,"."+i),a(r,".",i,"=",n[i].append(e,t),";")}),t(a)}function k(e,t,n,r){var a,i=(s=e.shared).gl,o=s.framebuffer;K&&(a=t.def(s.extensions,".webgl_draw_buffers"));var s=(f=e.constants).drawBuffer,f=f.backBuffer;e=n?n.append(e,t):t.def(o,".next"),r||t("if(",e,"!==",o,".cur){"),t("if(",e,"){",i,".bindFramebuffer(",36160,",",e,".framebuffer);"),K&&t(a,".drawBuffersWEBGL(",s,"[",e,".colorAttachments.length]);"),t("}else{",i,".bindFramebuffer(",36160,",null);"),K&&t(a,".drawBuffersWEBGL(",f,");"),t("}",o,".cur=",e,";"),r||t("}")}function E(e,t,n){var r=e.shared,a=r.gl,o=e.current,s=e.next,f=r.current,u=r.next,l=e.cond(f,".dirty");re.forEach(function(t){var r,c;if(!((t=y(t))in n.state))if(t in s){r=s[t],c=o[t];var h=i(ee[t].length,function(e){return l.def(r,"[",e,"]")});l(e.cond(h.map(function(e,t){return e+"!=="+c+"["+t+"]"}).join("||")).then(a,".",ie[t],"(",h,");",h.map(function(e,t){return c+"["+t+"]="+e}).join(";"),";"))}else r=l.def(u,".",t),h=e.cond(r,"!==",f,".",t),l(h),t in ae?h(e.cond(r).then(a,".enable(",ae[t],");").else(a,".disable(",ae[t],");"),f,".",t,"=",r,";"):h(a,".",ie[t],"(",r,");",f,".",t,"=",r,";")}),0===Object.keys(n.state).length&&l(f,".dirty=false;"),t(l)}function T(e,t,n,r){var a=e.shared,i=e.current,o=a.current,s=a.gl;j(Object.keys(n)).forEach(function(a){var f=n[a];if(!r||r(f)){var u=f.append(e,t);if(ae[a]){var l=ae[a];I(f)?t(s,u?".enable(":".disable(",l,");"):t(e.cond(u).then(s,".enable(",l,");").else(s,".disable(",l,");")),t(o,".",a,"=",u,";")}else if(m(u)){var c=i[a];t(s,".",ie[a],"(",u,");",u.map(function(e,t){return c+"["+t+"]="+e}).join(";"),";")}else t(s,".",ie[a],"(",u,");",o,".",a,"=",u,";")}})}function D(e,t){J&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function z(e,t,n,r,a){function i(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function o(e){e(u=t.def(),"=",i(),";"),"string"==typeof a?e(h,".count+=",a,";"):e(h,".count++;"),d&&(r?e(l=t.def(),"=",g,".getNumPendingQueries();"):e(g,".beginQuery(",h,");"))}function s(e){e(h,".cpuTime+=",i(),"-",u,";"),d&&(r?e(g,".pushScopeStats(",l,",",g,".getNumPendingQueries(),",h,");"):e(g,".endQuery();"))}function f(e){var n=t.def(p,".profile");t(p,".profile=",e,";"),t.exit(p,".profile=",n,";")}var u,l,c=e.shared,h=e.stats,p=c.current,g=c.timer;if(n=n.profile){if(I(n))return void(n.enable?(o(t),s(t.exit),f("true")):f("false"));f(n=n.append(e,t))}else n=t.def(p,".profile");o(c=e.block()),t("if(",n,"){",c,"}"),s(e=e.block()),t.exit("if(",n,"){",e,"}")}function N(e,t,n,r,a){function i(n,r,a){function i(){t("if(!",l,".buffer){",f,".enableVertexAttribArray(",u,");}");var n,i=a.type;n=a.size?t.def(a.size,"||",r):r,t("if(",l,".type!==",i,"||",l,".size!==",n,"||",p.map(function(e){return l+"."+e+"!=="+a[e]}).join("||"),"){",f,".bindBuffer(",34962,",",c,".buffer);",f,".vertexAttribPointer(",[u,n,i,a.normalized,a.stride,a.offset],");",l,".type=",i,";",l,".size=",n,";",p.map(function(e){return l+"."+e+"="+a[e]+";"}).join(""),"}"),J&&(i=a.divisor,t("if(",l,".divisor!==",i,"){",e.instancing,".vertexAttribDivisorANGLE(",[u,i],");",l,".divisor=",i,";}"))}function s(){t("if(",l,".buffer){",f,".disableVertexAttribArray(",u,");","}if(",we.map(function(e,t){return l+"."+e+"!=="+h[t]}).join("||"),"){",f,".vertexAttrib4f(",u,",",h,");",we.map(function(e,t){return l+"."+e+"="+h[t]+";"}).join(""),"}")}var f=o.gl,u=t.def(n,".location"),l=t.def(o.attributes,"[",u,"]");n=a.state;var c=a.buffer,h=[a.x,a.y,a.z,a.w],p=["buffer","normalized","offset","stride"];1===n?i():2===n?s():(t("if(",n,"===",1,"){"),i(),t("}else{"),s(),t("}"))}var o=e.shared;r.forEach(function(r){var o,s=r.name,f=n.attributes[s];if(f){if(!a(f))return;o=f.append(e,t)}else{if(!a(Se))return;var u=e.scopeAttrib(s);o={},Object.keys(new G).forEach(function(e){o[e]=t.def(u,".",e)})}i(e.link(r),function(e){switch(r.info.type){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(),o)})}function M(e,n,r,a,o){for(var s,f=e.shared,u=f.gl,l=0;l<a.length;++l){var c,h=(g=a[l]).name,p=g.info.type,d=r.uniforms[h],g=e.link(g)+".location";if(d){if(!o(d))continue;if(I(d)){if(h=d.value,35678===p||35680===p)n(u,".uniform1i(",g,",",(p=e.link(h._texture||h.color[0]._texture))+".bind());"),n.exit(p,".unbind();");else if(35674===p||35675===p||35676===p)d=2,35675===p?d=3:35676===p&&(d=4),n(u,".uniformMatrix",d,"fv(",g,",false,",h=e.global.def("new Float32Array(["+Array.prototype.slice.call(h)+"])"),");");else{switch(p){case 5126:s="1f";break;case 35664:s="2f";break;case 35665:s="3f";break;case 35666:s="4f";break;case 35670:case 5124:s="1i";break;case 35671:case 35667:s="2i";break;case 35672:case 35668:s="3i";break;case 35673:s="4i";break;case 35669:s="4i"}n(u,".uniform",s,"(",g,",",m(h)?Array.prototype.slice.call(h):h,");")}continue}c=d.append(e,n)}else{if(!o(Se))continue;c=n.def(f.uniforms,"[",t.id(h),"]")}switch(35678===p?n("if(",c,"&&",c,'._reglType==="framebuffer"){',c,"=",c,".color[0];","}"):35680===p&&n("if(",c,"&&",c,'._reglType==="framebufferCube"){',c,"=",c,".color[0];","}"),h=1,p){case 35678:case 35680:p=n.def(c,"._texture"),n(u,".uniform1i(",g,",",p,".bind());"),n.exit(p,".unbind();");continue;case 5124:case 35670:s="1i";break;case 35667:case 35671:s="2i",h=2;break;case 35668:case 35672:s="3i",h=3;break;case 35669:case 35673:s="4i",h=4;break;case 5126:s="1f";break;case 35664:s="2f",h=2;break;case 35665:s="3f",h=3;break;case 35666:s="4f",h=4;break;case 35674:s="Matrix2fv";break;case 35675:s="Matrix3fv";break;case 35676:s="Matrix4fv"}if(n(u,".uniform",s,"(",g,","),"M"===s.charAt(0)){g=Math.pow(p-35674+2,2);var y=e.global.def("new Float32Array(",g,")");n("false,(Array.isArray(",c,")||",c," instanceof Float32Array)?",c,":(",i(g,function(e){return y+"["+e+"]="+c+"["+e+"]"}),",",y,")")}else n(1<h?i(h,function(e){return c+"["+e+"]"}):c);n(");")}}function U(e,t,n,r){function a(a){var i=h[a];return i?i.contextDep&&r.contextDynamic||i.propDep?i.append(e,n):i.append(e,t):t.def(c,".",a)}function i(){function e(){n(f,".drawElementsInstancedANGLE(",[d,m,y,g+"<<(("+y+"-5121)>>1)",s],");")}function t(){n(f,".drawArraysInstancedANGLE(",[d,g,m,s],");")}p?v?e():(n("if(",p,"){"),e(),n("}else{"),t(),n("}")):t()}function o(){function e(){n(l+".drawElements("+[d,m,y,g+"<<(("+y+"-5121)>>1)"]+");")}function t(){n(l+".drawArrays("+[d,g,m]+");")}p?v?e():(n("if(",p,"){"),e(),n("}else{"),t(),n("}")):t()}var s,f,u=e.shared,l=u.gl,c=u.draw,h=r.draw,p=function(){var a=h.elements,i=t;return a?((a.contextDep&&r.contextDynamic||a.propDep)&&(i=n),a=a.append(e,i)):a=i.def(c,".","elements"),a&&i("if("+a+")"+l+".bindBuffer(34963,"+a+".buffer.buffer);"),a}(),d=a("primitive"),g=a("offset"),m=function(){var a=h.count,i=t;return a?((a.contextDep&&r.contextDynamic||a.propDep)&&(i=n),a=a.append(e,i)):a=i.def(c,".","count"),a}();if("number"==typeof m){if(0===m)return}else n("if(",m,"){"),n.exit("}");J&&(s=a("instances"),f=e.instancing);var y=p+".type",v=h.elements&&I(h.elements);J&&("number"!=typeof s||0<=s)?"string"==typeof s?(n("if(",s,">0){"),i(),n("}else if(",s,"<0){"),o(),n("}")):i():o()}function W(e,t,n,r,a){return a=(t=w()).proc("body",a),J&&(t.instancing=a.def(t.shared.extensions,".angle_instanced_arrays")),e(t,a,n,r),t.compile().body}function H(e,t,n,r){D(e,t),N(e,t,n,r.attributes,function(){return!0}),M(e,t,n,r.uniforms,function(){return!0}),U(e,t,t,n)}function V(e,t,n,r){function a(){return!0}e.batchId="a1",D(e,t),N(e,t,n,r.attributes,a),M(e,t,n,r.uniforms,a),U(e,t,t,n)}function Y(e,t,n,r){function a(e){return e.contextDep&&o||e.propDep}function i(e){return!a(e)}D(e,t);var o=n.contextDep,s=t.def(),f=t.def();e.shared.props=f,e.batchId=s;var u=e.scope(),l=e.scope();t(u.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",f,"=","a0","[",s,"];",l,"}",u.exit),n.needsContext&&S(e,l,n.context),n.needsFramebuffer&&k(e,l,n.framebuffer),T(e,l,n.state,a),n.profile&&a(n.profile)&&z(e,l,n,!1,!0),r?(N(e,u,n,r.attributes,i),N(e,l,n,r.attributes,a),M(e,u,n,r.uniforms,i),M(e,l,n,r.uniforms,a),U(e,u,l,n)):(t=e.global.def("{}"),r=n.shader.progVar.append(e,l),f=l.def(r,".id"),u=l.def(t,"[",f,"]"),l(e.shared.gl,".useProgram(",r,".program);","if(!",u,"){",u,"=",t,"[",f,"]=",e.link(function(t){return W(V,e,n,t,2)}),"(",r,");}",u,".call(this,a0[",s,"],",s,");"))}function $(e,n){function r(t){var r=n.shader[t];r&&a.set(i.shader,"."+t,r.append(e,a))}var a=e.proc("scope",3);e.batchId="a2";var i=e.shared,o=i.current;S(e,a,n.context),n.framebuffer&&n.framebuffer.append(e,a),j(Object.keys(n.state)).forEach(function(t){var r=n.state[t].append(e,a);m(r)?r.forEach(function(n,r){a.set(e.next[t],"["+r+"]",n)}):a.set(i.next,"."+t,r)}),z(e,a,n,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(t){var r=n.draw[t];r&&a.set(i.draw,"."+t,""+r.append(e,a))}),Object.keys(n.uniforms).forEach(function(r){a.set(i.uniforms,"["+t.id(r)+"]",n.uniforms[r].append(e,a))}),Object.keys(n.attributes).forEach(function(t){var r=n.attributes[t].append(e,a),i=e.scopeAttrib(t);Object.keys(new G).forEach(function(e){a.set(i,"."+e,r[e])})}),r("vert"),r("frag"),0<Object.keys(n.state).length&&(a(o,".dirty=true;"),a.exit(o,".dirty=true;")),a("a1(",e.shared.context,",a0,",e.batchId,");")}function Q(e,t,n){var r=t.static[n];if(r&&function(e){if("object"==typeof e&&!m(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(q.isDynamic(e[t[n]]))return!0;return!1}}(r)){var a=e.global,i=Object.keys(r),o=!1,s=!1,f=!1,u=e.global.def("{}");i.forEach(function(t){var n=r[t];if(q.isDynamic(n))"function"==typeof n&&(n=r[t]=q.unbox(n)),t=L(n,null),o=o||t.thisDep,f=f||t.propDep,s=s||t.contextDep;else{switch(a(u,".",t,"="),typeof n){case"number":a(n);break;case"string":a('"',n,'"');break;case"object":Array.isArray(n)&&a("[",n.join(),"]");break;default:a(e.link(n))}a(";")}}),t.dynamic[n]=new q.DynamicVariable(4,{thisDep:o,contextDep:s,propDep:f,ref:u,append:function(e,t){i.forEach(function(n){var a=r[n];q.isDynamic(a)&&(a=e.invoke(t,a),t(u,".",n,"=",a,";"))})}}),delete t.static[n]}}var G=l.Record,X={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(X.min=32775,X.max=32776);var J=n.angle_instanced_arrays,K=n.webgl_draw_buffers,ee={dirty:!0,profile:g.profile},te={},re=[],ae={},ie={};v("dither",3024),v("blend.enable",3042),b("blend.color","blendColor",[0,0,0,0]),b("blend.equation","blendEquationSeparate",[32774,32774]),b("blend.func","blendFuncSeparate",[1,0,1,0]),v("depth.enable",2929,!0),b("depth.func","depthFunc",513),b("depth.range","depthRange",[0,1]),b("depth.mask","depthMask",!0),b("colorMask","colorMask",[!0,!0,!0,!0]),v("cull.enable",2884),b("cull.face","cullFace",1029),b("frontFace","frontFace",2305),b("lineWidth","lineWidth",1),v("polygonOffset.enable",32823),b("polygonOffset.offset","polygonOffset",[0,0]),v("sample.alpha",32926),v("sample.enable",32928),b("sample.coverage","sampleCoverage",[1,!1]),v("stencil.enable",2960),b("stencil.mask","stencilMask",-1),b("stencil.func","stencilFunc",[519,0,-1]),b("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),b("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),v("scissor.enable",3089),b("scissor.box","scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),b("viewport","viewport",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var oe={gl:e,context:p,strings:t,next:te,current:ee,draw:h,elements:o,buffer:a,shader:c,attributes:l.state,uniforms:u,framebuffer:f,extensions:n,timer:d,isBufferArgs:F},se={primTypes:ne,compareFuncs:Ce,blendFuncs:Ae,blendEquations:X,stencilOps:Oe,glTypes:Z,orientationType:_e};K&&(se.backBuffer=[1029],se.drawBuffer=i(r.maxDrawbuffers,function(e){return 0===e?[0]:i(e,function(e){return 36064+e})}));var fe=0;return{next:te,current:ee,procs:function(){var e=w(),t=e.proc("poll"),n=e.proc("refresh"),a=e.block();t(a),n(a);var o,s=e.shared,f=s.gl,u=s.next,l=s.current;a(l,".dirty=false;"),k(e,t),k(e,n,null,!0),J&&(o=e.link(J));for(var c=0;c<r.maxAttributes;++c){var h=n.def(s.attributes,"[",c,"]"),p=e.cond(h,".buffer");p.then(f,".enableVertexAttribArray(",c,");",f,".bindBuffer(",34962,",",h,".buffer.buffer);",f,".vertexAttribPointer(",c,",",h,".size,",h,".type,",h,".normalized,",h,".stride,",h,".offset);").else(f,".disableVertexAttribArray(",c,");",f,".vertexAttrib4f(",c,",",h,".x,",h,".y,",h,".z,",h,".w);",h,".buffer=null;"),n(p),J&&n(o,".vertexAttribDivisorANGLE(",c,",",h,".divisor);")}return Object.keys(ae).forEach(function(r){var i=ae[r],o=a.def(u,".",r),s=e.block();s("if(",o,"){",f,".enable(",i,")}else{",f,".disable(",i,")}",l,".",r,"=",o,";"),n(s),t("if(",o,"!==",l,".",r,"){",s,"}")}),Object.keys(ie).forEach(function(r){var o,s,c=ie[r],h=ee[r],p=e.block();p(f,".",c,"("),m(h)?(c=h.length,o=e.global.def(u,".",r),s=e.global.def(l,".",r),p(i(c,function(e){return o+"["+e+"]"}),");",i(c,function(e){return s+"["+e+"]="+o+"["+e+"];"}).join("")),t("if(",i(c,function(e){return o+"["+e+"]!=="+s+"["+e+"]"}).join("||"),"){",p,"}")):(o=a.def(u,".",r),s=a.def(l,".",r),p(o,");",l,".",r,"=",o,";"),t("if(",o,"!==",s,"){",p,"}")),n(p)}),e.compile()}(),compile:function(e,t,n,r,a){var i=w();return i.stats=i.link(a),Object.keys(t.static).forEach(function(e){Q(i,t,e)}),xe.forEach(function(t){Q(i,e,t)}),n=_(e,t,n,r),function(e,t){var n=e.proc("draw",1);D(e,n),S(e,n,t.context),k(e,n,t.framebuffer),E(e,n,t),T(e,n,t.state),z(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)H(e,n,t,t.shader.program);else{var a=e.global.def("{}"),i=n.def(r,".id"),o=n.def(a,"[",i,"]");n(e.cond(o).then(o,".call(this,a0);").else(o,"=",a,"[",i,"]=",e.link(function(n){return W(H,e,t,n,1)}),"(",r,");",o,".call(this,a0);"))}0<Object.keys(t.state).length&&n(e.shared.current,".dirty=true;")}(i,n),$(i,n),function(e,t){function n(e){return e.contextDep&&a||e.propDep}var r=e.proc("batch",2);e.batchId="0",D(e,r);var a=!1,i=!0;Object.keys(t.context).forEach(function(e){a=a||t.context[e].propDep}),a||(S(e,r,t.context),i=!1);var o=!1;if((s=t.framebuffer)?(s.propDep?a=o=!0:s.contextDep&&a&&(o=!0),o||k(e,r,s)):k(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(a=!0),E(e,r,t),T(e,r,t.state,function(e){return!n(e)}),t.profile&&n(t.profile)||z(e,r,t,!1,"a1"),t.contextDep=a,t.needsContext=i,t.needsFramebuffer=o,(i=t.shader.progVar).contextDep&&a||i.propDep)Y(e,r,t,null);else if(i=i.append(e,r),r(e.shared.gl,".useProgram(",i,".program);"),t.shader.program)Y(e,r,t,t.shader.program);else{var s=e.global.def("{}"),f=(o=r.def(i,".id"),r.def(s,"[",o,"]"));r(e.cond(f).then(f,".call(this,a0,a1);").else(f,"=",s,"[",o,"]=",e.link(function(n){return W(Y,e,t,n,2)}),"(",i,");",f,".call(this,a0,a1);"))}0<Object.keys(t.state).length&&r(e.shared.current,".dirty=true;")}(i,n),i.compile()}}}function N(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var M=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},U=0,q={DynamicVariable:e,define:function(n,r){return new e(n,t(r+""))},isDynamic:function(t){return"function"==typeof t&&!t._reglType||t instanceof e},unbox:function(t,n){return"function"==typeof t?new e(0,t):t},accessor:t},W={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},H="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},V=s();V.zero=s();var Y=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(34047));var r=1,a=1;t.webgl_draw_buffers&&(r=e.getParameter(34852),a=e.getParameter(36063));var i=!!t.oes_texture_float;if(i){i=e.createTexture(),e.bindTexture(3553,i),e.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var o=e.createFramebuffer();if(e.bindFramebuffer(36160,o),e.framebufferTexture2D(36160,36064,3553,i,0),e.bindTexture(3553,null),36053!==e.checkFramebufferStatus(36160))i=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(16384);var s=V.allocType(5126,4);e.readPixels(0,0,1,1,6408,5126,s),e.getError()?i=!1:(e.deleteFramebuffer(o),e.deleteTexture(i),i=1===s[0]),V.freeType(s)}}return s=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(s=e.createTexture(),o=V.allocType(5121,36),e.activeTexture(33984),e.bindTexture(34067,s),e.texImage2D(34069,0,6408,3,3,0,6408,5121,o),V.freeType(o),e.bindTexture(34067,null),e.deleteTexture(s),s=!e.getError()),{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:a,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:i,npotTextureCube:s}},$=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},Q=function(e){return Object.keys(e).map(function(t){return e[t]})},G={shape:function(e){for(var t=[];e.length;e=e[0])t.push(e.length);return t},flatten:function(e,t,n,r){var a=1;if(t.length)for(var i=0;i<t.length;++i)a*=t[i];else a=0;switch(n=r||V.allocType(n,a),t.length){case 0:break;case 1:for(r=t[0],t=0;t<r;++t)n[t]=e[t];break;case 2:for(r=t[0],t=t[1],i=a=0;i<r;++i)for(var o=e[i],s=0;s<t;++s)n[a++]=o[s];break;case 3:u(e,t[0],t[1],t[2],n,0);break;default:!function e(t,n,r,a,i){for(var o=1,s=r+1;s<n.length;++s)o*=n[s];var f=n[r];if(4==n.length-r){var l=n[r+1],c=n[r+2];for(n=n[r+3],s=0;s<f;++s)u(t[s],l,c,n,a,i),i+=o}else for(s=0;s<f;++s)e(t[s],n,r+1,a,i),i+=o}(e,t,0,n,0)}return n}},X={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Z={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},J={dynamic:35048,stream:35040,static:35044},K=G.flatten,ee=G.shape,te=[];te[5120]=1,te[5122]=2,te[5124]=4,te[5121]=1,te[5123]=2,te[5125]=4,te[5126]=4;var ne={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},re=new Float32Array(1),ae=new Uint32Array(re.buffer),ie=[9984,9986,9985,9987],oe=[0,6409,6410,6407,6408],se={};se[6409]=se[6406]=se[6402]=1,se[34041]=se[6410]=2,se[6407]=se[35904]=3,se[6408]=se[35906]=4;var fe=y("HTMLCanvasElement"),ue=y("CanvasRenderingContext2D"),le=y("ImageBitmap"),ce=y("HTMLImageElement"),he=y("HTMLVideoElement"),pe=Object.keys(X).concat([fe,ue,le,ce,he]),de=[];de[5121]=1,de[5126]=4,de[36193]=2,de[5123]=2,de[5125]=4;var ge=[];ge[32854]=2,ge[32855]=2,ge[36194]=2,ge[34041]=4,ge[33776]=.5,ge[33777]=.5,ge[33778]=1,ge[33779]=1,ge[35986]=.5,ge[35987]=1,ge[34798]=1,ge[35840]=.5,ge[35841]=.25,ge[35842]=.5,ge[35843]=.25,ge[36196]=.5;var me=[];me[32854]=2,me[32855]=2,me[36194]=2,me[33189]=2,me[36168]=1,me[34041]=4,me[35907]=4,me[34836]=16,me[34842]=8,me[34843]=6;var ye=function(e,t,n,r,a){function i(e){this.id=u++,this.refCount=1,this.renderbuffer=e,this.format=32854,this.height=this.width=0,a.profile&&(this.stats={size:0})}function o(t){var n=t.renderbuffer;e.bindRenderbuffer(36161,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete l[t.id],r.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(s.srgba=35907),t.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843),t.webgl_color_buffer_float&&(s.rgba32f=34836);var f=[];Object.keys(s).forEach(function(e){f[s[e]]=e});var u=0,l={};return i.prototype.decRef=function(){0>=--this.refCount&&o(this)},a.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(l).forEach(function(t){e+=l[t].stats.size}),e}),{create:function(t,n){function o(t,n){var r=0,i=0,l=32854;if("object"==typeof t&&t?("shape"in t?(r=0|(i=t.shape)[0],i=0|i[1]):("radius"in t&&(r=i=0|t.radius),"width"in t&&(r=0|t.width),"height"in t&&(i=0|t.height)),"format"in t&&(l=s[t.format])):"number"==typeof t?(r=0|t,i="number"==typeof n?0|n:r):t||(r=i=1),r!==u.width||i!==u.height||l!==u.format)return o.width=u.width=r,o.height=u.height=i,u.format=l,e.bindRenderbuffer(36161,u.renderbuffer),e.renderbufferStorage(36161,l,r,i),a.profile&&(u.stats.size=me[u.format]*u.width*u.height),o.format=f[u.format],o}var u=new i(e.createRenderbuffer());return l[u.id]=u,r.renderbufferCount++,o(t,n),o.resize=function(t,n){var r=0|t,i=0|n||r;return r===u.width&&i===u.height?o:(o.width=u.width=r,o.height=u.height=i,e.bindRenderbuffer(36161,u.renderbuffer),e.renderbufferStorage(36161,u.format,r,i),a.profile&&(u.stats.size=me[u.format]*u.width*u.height),o)},o._reglType="renderbuffer",o._renderbuffer=u,a.profile&&(o.stats=u.stats),o.destroy=function(){u.decRef()},o},clear:function(){Q(l).forEach(o)},restore:function(){Q(l).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,t.renderbuffer),e.renderbufferStorage(36161,t.format,t.width,t.height)}),e.bindRenderbuffer(36161,null)}}},ve=[];ve[6408]=4,ve[6407]=3;var be=[];be[5121]=1,be[5126]=4,be[36193]=2;var we=["x","y","z","w"],xe="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Ae={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ce={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Oe={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},_e={cw:2304,ccw:2305},Se=new B(!1,!1,!1,function(){});return function(e){function t(){if(0===G.length)A&&A.update(),K=null;else{K=W.next(t),c();for(var e=G.length-1;0<=e;--e){var n=G[e];n&&n(R,null,0)}m.flush(),A&&A.update()}}function n(){!K&&0<G.length&&(K=W.next(t))}function r(){K&&(W.cancel(t),K=null)}function i(e){e.preventDefault(),r(),X.forEach(function(e){e()})}function o(e){m.getError(),v.restore(),I.restore(),j.restore(),P.restore(),L.restore(),U.restore(),A&&A.restore(),V.procs.refresh(),n(),Z.forEach(function(e){e()})}function s(e){function t(e){var t={},n={};return Object.keys(e).forEach(function(r){var a=e[r];q.isDynamic(a)?n[r]=q.unbox(a,r):t[r]=a}),{dynamic:n,static:t}}var n=t(e.context||{}),r=t(e.uniforms||{}),a=t(e.attributes||{}),i=t(function(e){function t(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach(function(r){n[e+"."+r]=t[r]})}}var n=M({},e);return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),t("blend"),t("depth"),t("cull"),t("stencil"),t("polygonOffset"),t("scissor"),t("sample"),n}(e));e={gpuTime:0,cpuTime:0,count:0};var o=(n=V.compile(i,a,r,n,e)).draw,s=n.batch,f=n.scope,u=[];return M(function(e,t){var n;if("function"==typeof e)return f.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(n=0;n<e;++n)f.call(this,null,t,n);else{if(!Array.isArray(e))return f.call(this,e,t,0);for(n=0;n<e.length;++n)f.call(this,e[n],t,n)}else if("number"==typeof e){if(0<e)return s.call(this,function(e){for(;u.length<e;)u.push(null);return u}(0|e),0|e)}else{if(!Array.isArray(e))return o.call(this,e);if(e.length)return s.call(this,e,e.length)}},{stats:e})}function f(e,t){var n=0;V.procs.poll();var r=t.color;r&&(m.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=16384),"depth"in t&&(m.clearDepth(+t.depth),n|=256),"stencil"in t&&(m.clearStencil(0|t.stencil),n|=1024),m.clear(n)}function u(e){return G.push(e),n(),{cancel:function(){var t=N(G,e);G[t]=function e(){var t=N(G,e);G[t]=G[G.length-1],--G.length,0>=G.length&&r()}}}}function l(){var e=$.viewport,t=$.scissor_box;e[0]=e[1]=t[0]=t[1]=0,R.viewportWidth=R.framebufferWidth=R.drawingBufferWidth=e[2]=t[2]=m.drawingBufferWidth,R.viewportHeight=R.framebufferHeight=R.drawingBufferHeight=e[3]=t[3]=m.drawingBufferHeight}function c(){R.tick+=1,R.time=g(),l(),V.procs.poll()}function h(){l(),V.procs.refresh(),A&&A.update()}function g(){return(H()-C)/1e3}if(!(e=a(e)))return null;var m=e.gl,y=m.getContextAttributes();m.isContextLost();var v=function(e,t){function n(t){var n;t=t.toLowerCase();try{n=r[t]=e.getExtension(t)}catch(e){}return!!n}for(var r={},a=0;a<t.extensions.length;++a){var i=t.extensions[a];if(!n(i))return t.onDestroy(),t.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(r[e]&&!n(e))throw Error("(regl): error restoring extension "+e)})}}}(m,e);if(!v)return null;var b=function(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r||(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}(),w={bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},x=v.extensions,A=function(e,t){function n(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function r(e,t,r){var a=o.pop()||new n;a.startQueryIndex=e,a.endQueryIndex=t,a.sum=0,a.stats=r,s.push(a)}if(!t.ext_disjoint_timer_query)return null;var a=[],i=[],o=[],s=[],f=[],u=[];return{beginQuery:function(e){var n=a.pop()||t.ext_disjoint_timer_query.createQueryEXT();t.ext_disjoint_timer_query.beginQueryEXT(35007,n),i.push(n),r(i.length-1,i.length,e)},endQuery:function(){t.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:r,update:function(){var e,n;if(0!==(e=i.length)){u.length=Math.max(u.length,e+1),f.length=Math.max(f.length,e+1),f[0]=0;var r=u[0]=0;for(n=e=0;n<i.length;++n){var l=i[n];t.ext_disjoint_timer_query.getQueryObjectEXT(l,34919)?(r+=t.ext_disjoint_timer_query.getQueryObjectEXT(l,34918),a.push(l)):i[e++]=l,f[n+1]=r,u[n+1]=e}for(i.length=e,n=e=0;n<s.length;++n){var c=(r=s[n]).startQueryIndex;l=r.endQueryIndex,r.sum+=f[l]-f[c],c=u[c],(l=u[l])===c?(r.stats.gpuTime+=r.sum/1e6,o.push(r)):(r.startQueryIndex=c,r.endQueryIndex=l,s[e++]=r)}s.length=e}},getNumPendingQueries:function(){return i.length},clear:function(){a.push.apply(a,i);for(var e=0;e<a.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(a[e]);i.length=0,a.length=0},restore:function(){i.length=0,a.length=0}}}(0,x),C=H(),T=m.drawingBufferWidth,D=m.drawingBufferHeight,R={tick:0,time:0,viewportWidth:T,viewportHeight:D,framebufferWidth:T,framebufferHeight:D,drawingBufferWidth:T,drawingBufferHeight:D,pixelRatio:e.pixelRatio},F=Y(m,x),j=(T=function(e,t,n,r){for(e=n.maxAttributes,t=Array(e),n=0;n<e;++n)t[n]=new S;return{Record:S,scope:{},state:t}}(m,x,F),p(m,w,e,T)),B=d(m,x,j,w),I=k(m,b,w,e),P=O(m,x,F,function(){V.procs.poll()},R,w,e),L=ye(m,x,0,w,e),U=_(m,x,F,P,L,w),V=z(m,b,x,F,j,B,0,U,{},T,I,{elements:null,primitive:4,count:-1,offset:0,instances:-1},R,A,e),$=(b=E(m,U,V.procs.poll,R),V.next),Q=m.canvas,G=[],X=[],Z=[],J=[e.onDestroy],K=null;Q&&(Q.addEventListener("webglcontextlost",i,!1),Q.addEventListener("webglcontextrestored",o,!1));var ee=U.setFBO=s({framebuffer:q.define.call(null,1,"framebuffer")});return h(),y=M(s,{clear:function(e){if("framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var t=0;6>t;++t)ee(M({framebuffer:e.framebuffer.faces[t]},e),f);else ee(e,f);else f(0,e)},prop:q.define.bind(null,1),context:q.define.bind(null,2),this:q.define.bind(null,3),draw:s({}),buffer:function(e){return j.create(e,34962,!1,!1)},elements:function(e){return B.create(e,!1)},texture:P.create2D,cube:P.createCube,renderbuffer:L.create,framebuffer:U.create,framebufferCube:U.createCube,attributes:y,frame:u,on:function(e,t){var n;switch(e){case"frame":return u(t);case"lost":n=X;break;case"restore":n=Z;break;case"destroy":n=J}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t){n[e]=n[n.length-1],n.pop();break}}}},limits:F,hasExtension:function(e){return 0<=F.extensions.indexOf(e.toLowerCase())},read:b,destroy:function(){G.length=0,r(),Q&&(Q.removeEventListener("webglcontextlost",i),Q.removeEventListener("webglcontextrestored",o)),I.clear(),U.clear(),L.clear(),P.clear(),B.clear(),j.clear(),A&&A.clear(),J.forEach(function(e){e()})},_gl:m,_refresh:h,poll:function(){c(),A&&A.update()},now:g,stats:w}),e.onDone(null,y),y}},"object"==typeof be.exports?be.exports=me():"function"==typeof define&&define.amd?define(me):ge.createREGL=me(),be=be.exports;var we={};(we=Ae).float32=we.float=Ae,we.fract32=we.fract=function(e){if(e.length){for(var t=Ae(e),n=0,r=t.length;n<r;n++)t[n]=e[n]-t[n];return t}return Ae(e-Ae(e))};var xe=new Float32Array(1);function Ae(e){if(e.length){if(e instanceof Float32Array)return e;var t=new Float32Array(e);return t.set(e),t}return xe[0]=e,xe[0]}var Ce=ke,Oe=Se("in",document.body);function _e(e,t){var n=ve(getComputedStyle(e).getPropertyValue(t));return n[0]*ke(n[1],e)}function Se(e,t){var n=document.createElement("div");n.style.height="128"+e,t.appendChild(n);var r=_e(n,"height")/128;return t.removeChild(n),r}function ke(e,t){if(!e)return null;switch(t=t||document.body,e=(e+""||"px").trim().toLowerCase(),t!==window&&t!==document||(t=document.body),e){case"%":return t.clientHeight/100;case"ch":case"ex":return Se(e,t);case"em":return _e(t,"font-size");case"rem":return _e(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return Oe;case"cm":return Oe/2.54;case"mm":return Oe/25.4;case"pt":return Oe/72;case"pc":return Oe/6;case"px":return 1}var n=ve(e);if(!isNaN(n[0])&&n[1]){var r=ke(n[1],t);return"number"==typeof r?n[0]*r:null}return null}var Ee={};function Te(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}Ee.INT_BITS=32,Ee.INT_MAX=2147483647,Ee.INT_MIN=-1<<31,Ee.sign=function(e){return(e>0)-(e<0)},Ee.abs=function(e){var t=e>>31;return(e^t)-t},Ee.min=function(e,t){return t^(e^t)&-(e<t)},Ee.max=function(e,t){return e^(e^t)&-(e<t)},Ee.isPow2=function(e){return!(e&e-1||!e)},Ee.log2=function(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1},Ee.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},Ee.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},Ee.countTrailingZeros=Te,Ee.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,1+(e|=e>>>16)},Ee.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},Ee.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var De=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,a=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--a;e[t]=r<<a&255}}(De),Ee.reverse=function(e){return De[255&e]<<24|De[e>>>8&255]<<16|De[e>>>16&255]<<8|De[e>>>24&255]},Ee.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},Ee.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},Ee.interleave3=function(e,t,n){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},Ee.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},Ee.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>Te(e)+1};for(var Re=function(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(e>0)return function(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}(0|e,t);break;case"object":if("number"==typeof e.length)return function e(t,n,r){var a=0|t[r];if(a<=0)return[];var i,o=new Array(a);if(r===t.length-1)for(i=0;i<a;++i)o[i]=n;else for(i=0;i<a;++i)o[i]=e(t,n,r+1);return o}(e,t,0)}return[]},Fe={byteLength:function(e){var t=Ne(e),n=t[0],r=t[1];return 3*(n+r)/4-r},toByteArray:function(e){for(var t,n=Ne(e),r=n[0],a=n[1],i=new Ie(function(e,t,n){return 3*(t+n)/4-n}(0,r,a)),o=0,s=a>0?r-4:r,f=0;f<s;f+=4)t=Be[e.charCodeAt(f)]<<18|Be[e.charCodeAt(f+1)]<<12|Be[e.charCodeAt(f+2)]<<6|Be[e.charCodeAt(f+3)],i[o++]=t>>16&255,i[o++]=t>>8&255,i[o++]=255&t;return 2===a&&(t=Be[e.charCodeAt(f)]<<2|Be[e.charCodeAt(f+1)]>>4,i[o++]=255&t),1===a&&(t=Be[e.charCodeAt(f)]<<10|Be[e.charCodeAt(f+1)]<<4|Be[e.charCodeAt(f+2)]>>2,i[o++]=t>>8&255,i[o++]=255&t),i},fromByteArray:function(e){for(var t,n=e.length,r=n%3,a=[],i=0,o=n-r;i<o;i+=16383)a.push(Ue(e,i,i+16383>o?o:i+16383));return 1===r?(t=e[n-1],a.push(je[t>>2]+je[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],a.push(je[t>>10]+je[t>>4&63]+je[t<<2&63]+"=")),a.join("")}},je=[],Be=[],Ie="undefined"!=typeof Uint8Array?Uint8Array:Array,Pe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Le=0,ze=Pe.length;Le<ze;++Le)je[Le]=Pe[Le],Be[Pe.charCodeAt(Le)]=Le;function Ne(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function Me(e){return je[e>>18&63]+je[e>>12&63]+je[e>>6&63]+je[63&e]}function Ue(e,t,n){for(var r,a=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),a.push(Me(r));return a.join("")}Be["-".charCodeAt(0)]=62,Be["_".charCodeAt(0)]=63;var qe={read:function(e,t,n,r,a){var i,o,s=8*a-r-1,f=(1<<s)-1,u=f>>1,l=-7,c=n?a-1:0,h=n?-1:1,p=e[t+c];for(c+=h,i=p&(1<<-l)-1,p>>=-l,l+=s;l>0;i=256*i+e[t+c],c+=h,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=r;l>0;o=256*o+e[t+c],c+=h,l-=8);if(0===i)i=1-u;else{if(i===f)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),i-=u}return(p?-1:1)*o*Math.pow(2,i-r)},write:function(e,t,n,r,a,i){var o,s,f,u=8*i-a-1,l=(1<<u)-1,c=l>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-o))<1&&(o--,f*=2),(t+=o+c>=1?h/f:h*Math.pow(2,1-c))*f>=2&&(o++,f/=2),o+c>=l?(s=0,o=l):o+c>=1?(s=(t*f-1)*Math.pow(2,a),o+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,a),o=0));a>=8;e[n+p]=255&s,p+=d,s/=256,a-=8);for(o=o<<a|s,u+=a;u>0;e[n+p]=255&o,p+=d,o/=256,u-=8);e[n+p-d]|=128*g}},We={};We.Buffer=Ye,We.SlowBuffer=function(e){return+e!=e&&(e=0),Ye.alloc(+e)},We.INSPECT_MAX_BYTES=50;var He=2147483647;function Ve(e){if(e>He)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=Ye.prototype,t}function Ye(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return Ge(e)}return $e(e,t,n)}function $e(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!Ye.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|Je(e,t),r=Ve(n),a=r.write(e,t);return a!==n&&(r=r.slice(0,a)),r}(e,t);if(ArrayBuffer.isView(e))return Xe(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(_t(e,ArrayBuffer)||e&&_t(e.buffer,ArrayBuffer))return function(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n)).__proto__=Ye.prototype,r}(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return Ye.from(r,t,n);var a=function(e){if(Ye.isBuffer(e)){var t=0|Ze(e.length),n=Ve(t);return 0===n.length?n:(e.copy(n,0,0,t),n)}return void 0!==e.length?"number"!=typeof e.length||St(e.length)?Ve(0):Xe(e):"Buffer"===e.type&&Array.isArray(e.data)?Xe(e.data):void 0}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return Ye.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function Qe(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function Ge(e){return Qe(e),Ve(e<0?0:0|Ze(e))}function Xe(e){for(var t=e.length<0?0:0|Ze(e.length),n=Ve(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function Ze(e){if(e>=He)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+He.toString(16)+" bytes");return 0|e}function Je(e,t){if(Ye.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||_t(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return At(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Ct(e).length;default:if(a)return r?-1:At(e).length;t=(""+t).toLowerCase(),a=!0}}function Ke(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function et(e,t,n,r,a){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),St(n=+n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof t&&(t=Ye.from(t,r)),Ye.isBuffer(t))return 0===t.length?-1:tt(e,t,n,r,a);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):tt(e,[t],n,r,a);throw new TypeError("val must be string, number or Buffer")}function tt(e,t,n,r,a){var i,o=1,s=e.length,f=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,f/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(a){var l=-1;for(i=n;i<s;i++)if(u(e,i)===u(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===f)return l*o}else-1!==l&&(i-=i-l),l=-1}else for(n+f>s&&(n=s-f),i=n;i>=0;i--){for(var c=!0,h=0;h<f;h++)if(u(e,i+h)!==u(t,h)){c=!1;break}if(c)return i}return-1}function nt(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var i=t.length;r>i/2&&(r=i/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(St(s))return o;e[n+o]=s}return o}function rt(e,t,n,r){return Ot(At(t,e.length-n),e,n,r)}function at(e,t,n,r){return Ot(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function it(e,t,n,r){return at(e,t,n,r)}function ot(e,t,n,r){return Ot(Ct(t),e,n,r)}function st(e,t,n,r){return Ot(function(e,t){for(var n,r,a,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,a=n%256,i.push(a),i.push(r);return i}(t,e.length-n),e,n,r)}function ft(e,t,n){return 0===t&&n===e.length?Fe.fromByteArray(e):Fe.fromByteArray(e.slice(t,n))}function ut(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var i,o,s,f,u=e[a],l=null,c=u>239?4:u>223?3:u>191?2:1;if(a+c<=n)switch(c){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[a+1]))&&(f=(31&u)<<6|63&i)>127&&(l=f);break;case 3:i=e[a+1],o=e[a+2],128==(192&i)&&128==(192&o)&&(f=(15&u)<<12|(63&i)<<6|63&o)>2047&&(f<55296||f>57343)&&(l=f);break;case 4:i=e[a+1],o=e[a+2],s=e[a+3],128==(192&i)&&128==(192&o)&&128==(192&s)&&(f=(15&u)<<18|(63&i)<<12|(63&o)<<6|63&s)>65535&&f<1114112&&(l=f)}null===l?(l=65533,c=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),a+=c}return function(e){var t=e.length;if(t<=lt)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=lt));return n}(r)}We.kMaxLength=He,Ye.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),Ye.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Ye.prototype,"parent",{enumerable:!0,get:function(){if(Ye.isBuffer(this))return this.buffer}}),Object.defineProperty(Ye.prototype,"offset",{enumerable:!0,get:function(){if(Ye.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&Ye[Symbol.species]===Ye&&Object.defineProperty(Ye,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Ye.poolSize=8192,Ye.from=function(e,t,n){return $e(e,t,n)},Ye.prototype.__proto__=Uint8Array.prototype,Ye.__proto__=Uint8Array,Ye.alloc=function(e,t,n){return function(e,t,n){return Qe(e),e<=0?Ve(e):void 0!==t?"string"==typeof n?Ve(e).fill(t,n):Ve(e).fill(t):Ve(e)}(e,t,n)},Ye.allocUnsafe=function(e){return Ge(e)},Ye.allocUnsafeSlow=function(e){return Ge(e)},Ye.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==Ye.prototype},Ye.compare=function(e,t){if(_t(e,Uint8Array)&&(e=Ye.from(e,e.offset,e.byteLength)),_t(t,Uint8Array)&&(t=Ye.from(t,t.offset,t.byteLength)),!Ye.isBuffer(e)||!Ye.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,a=0,i=Math.min(n,r);a<i;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},Ye.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Ye.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Ye.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=Ye.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var i=e[n];if(_t(i,Uint8Array)&&(i=Ye.from(i)),!Ye.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,a),a+=i.length}return r},Ye.byteLength=Je,Ye.prototype._isBuffer=!0,Ye.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Ke(this,t,t+1);return this},Ye.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Ke(this,t,t+3),Ke(this,t+1,t+2);return this},Ye.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Ke(this,t,t+7),Ke(this,t+1,t+6),Ke(this,t+2,t+5),Ke(this,t+3,t+4);return this},Ye.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?ut(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return pt(this,t,n);case"utf8":case"utf-8":return ut(this,t,n);case"ascii":return ct(this,t,n);case"latin1":case"binary":return ht(this,t,n);case"base64":return ft(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return dt(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},Ye.prototype.toLocaleString=Ye.prototype.toString,Ye.prototype.equals=function(e){if(!Ye.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Ye.compare(this,e)},Ye.prototype.inspect=function(){var e="",t=We.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},Ye.prototype.compare=function(e,t,n,r,a){if(_t(e,Uint8Array)&&(e=Ye.from(e,e.offset,e.byteLength)),!Ye.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),t<0||n>e.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(a>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(i,o),f=this.slice(r,a),u=e.slice(t,n),l=0;l<s;++l)if(f[l]!==u[l]){i=f[l],o=u[l];break}return i<o?-1:o<i?1:0},Ye.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},Ye.prototype.indexOf=function(e,t,n){return et(this,e,t,n,!0)},Ye.prototype.lastIndexOf=function(e,t,n){return et(this,e,t,n,!1)},Ye.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return nt(this,e,t,n);case"utf8":case"utf-8":return rt(this,e,t,n);case"ascii":return at(this,e,t,n);case"latin1":case"binary":return it(this,e,t,n);case"base64":return ot(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return st(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},Ye.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var lt=4096;function ct(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function ht(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function pt(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=t;i<n;++i)a+=xt(e[i]);return a}function dt(e,t,n){for(var r=e.slice(t,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function gt(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function mt(e,t,n,r,a,i){if(!Ye.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function yt(e,t,n,r,a,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function vt(e,t,n,r,a){return t=+t,n>>>=0,a||yt(e,0,n,4),qe.write(e,t,n,r,23,4),n+4}function bt(e,t,n,r,a){return t=+t,n>>>=0,a||yt(e,0,n,8),qe.write(e,t,n,r,52,8),n+8}Ye.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return r.__proto__=Ye.prototype,r},Ye.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||gt(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r},Ye.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||gt(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},Ye.prototype.readUInt8=function(e,t){return e>>>=0,t||gt(e,1,this.length),this[e]},Ye.prototype.readUInt16LE=function(e,t){return e>>>=0,t||gt(e,2,this.length),this[e]|this[e+1]<<8},Ye.prototype.readUInt16BE=function(e,t){return e>>>=0,t||gt(e,2,this.length),this[e]<<8|this[e+1]},Ye.prototype.readUInt32LE=function(e,t){return e>>>=0,t||gt(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Ye.prototype.readUInt32BE=function(e,t){return e>>>=0,t||gt(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Ye.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||gt(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*t)),r},Ye.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||gt(e,t,this.length);for(var r=t,a=1,i=this[e+--r];r>0&&(a*=256);)i+=this[e+--r]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},Ye.prototype.readInt8=function(e,t){return e>>>=0,t||gt(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Ye.prototype.readInt16LE=function(e,t){e>>>=0,t||gt(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},Ye.prototype.readInt16BE=function(e,t){e>>>=0,t||gt(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},Ye.prototype.readInt32LE=function(e,t){return e>>>=0,t||gt(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Ye.prototype.readInt32BE=function(e,t){return e>>>=0,t||gt(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Ye.prototype.readFloatLE=function(e,t){return e>>>=0,t||gt(e,4,this.length),qe.read(this,e,!0,23,4)},Ye.prototype.readFloatBE=function(e,t){return e>>>=0,t||gt(e,4,this.length),qe.read(this,e,!1,23,4)},Ye.prototype.readDoubleLE=function(e,t){return e>>>=0,t||gt(e,8,this.length),qe.read(this,e,!0,52,8)},Ye.prototype.readDoubleBE=function(e,t){return e>>>=0,t||gt(e,8,this.length),qe.read(this,e,!1,52,8)},Ye.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||mt(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,i=0;for(this[t]=255&e;++i<n&&(a*=256);)this[t+i]=e/a&255;return t+n},Ye.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||mt(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+n},Ye.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||mt(this,e,t,1,255,0),this[t]=255&e,t+1},Ye.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||mt(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},Ye.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||mt(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},Ye.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||mt(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},Ye.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||mt(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Ye.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var a=Math.pow(2,8*n-1);mt(this,e,t,n,a-1,-a)}var i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},Ye.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var a=Math.pow(2,8*n-1);mt(this,e,t,n,a-1,-a)}var i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},Ye.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||mt(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},Ye.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||mt(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},Ye.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||mt(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},Ye.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||mt(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},Ye.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||mt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},Ye.prototype.writeFloatLE=function(e,t,n){return vt(this,e,t,!0,n)},Ye.prototype.writeFloatBE=function(e,t,n){return vt(this,e,t,!1,n)},Ye.prototype.writeDoubleLE=function(e,t,n){return bt(this,e,t,!0,n)},Ye.prototype.writeDoubleBE=function(e,t,n){return bt(this,e,t,!1,n)},Ye.prototype.copy=function(e,t,n,r){if(!Ye.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var i=a-1;i>=0;--i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return a},Ye.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!Ye.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var a=e.charCodeAt(0);("utf8"===r&&a<128||"latin1"===r)&&(e=a)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var o=Ye.isBuffer(e)?e:Ye.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%s]}return this};var wt=/[^+\/0-9A-Za-z-_]/g;function xt(e){return e<16?"0"+e.toString(16):e.toString(16)}function At(e,t){var n;t=t||1/0;for(var r=e.length,a=null,i=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function Ct(e){return Fe.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(wt,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Ot(e,t,n,r){for(var a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function _t(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function St(e){return e!=e}var kt={};(function(e,t){e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:Re([32,0]),UINT16:Re([32,0]),UINT32:Re([32,0]),INT8:Re([32,0]),INT16:Re([32,0]),INT32:Re([32,0]),FLOAT:Re([32,0]),DOUBLE:Re([32,0]),DATA:Re([32,0]),UINT8C:Re([32,0]),BUFFER:Re([32,0])});var n="undefined"!=typeof Uint8ClampedArray,r=e.__TYPEDARRAY_POOL;r.UINT8C||(r.UINT8C=Re([32,0])),r.BUFFER||(r.BUFFER=Re([32,0]));var a=r.DATA,i=r.BUFFER;function o(e){if(e){var t=e.length||e.byteLength,n=Ee.log2(t);a[n].push(e)}}function s(e){e=Ee.nextPow2(e);var t=Ee.log2(e),n=a[t];return n.length>0?n.pop():new ArrayBuffer(e)}function f(e){return new Uint8Array(s(e),0,e)}function u(e){return new Uint16Array(s(2*e),0,e)}function l(e){return new Uint32Array(s(4*e),0,e)}function c(e){return new Int8Array(s(e),0,e)}function h(e){return new Int16Array(s(2*e),0,e)}function p(e){return new Int32Array(s(4*e),0,e)}function d(e){return new Float32Array(s(4*e),0,e)}function g(e){return new Float64Array(s(8*e),0,e)}function m(e){return n?new Uint8ClampedArray(s(e),0,e):f(e)}function y(e){return new DataView(s(e),0,e)}function v(e){e=Ee.nextPow2(e);var n=Ee.log2(e),r=i[n];return r.length>0?r.pop():new t(e)}kt.free=function(e){if(t.isBuffer(e))i[Ee.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var n=e.length||e.byteLength,r=0|Ee.log2(n);a[r].push(e)}},kt.freeUint8=kt.freeUint16=kt.freeUint32=kt.freeInt8=kt.freeInt16=kt.freeInt32=kt.freeFloat32=kt.freeFloat=kt.freeFloat64=kt.freeDouble=kt.freeUint8Clamped=kt.freeDataView=function(e){o(e.buffer)},kt.freeArrayBuffer=o,kt.freeBuffer=function(e){i[Ee.log2(e.length)].push(e)},kt.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return s(e);switch(t){case"uint8":return f(e);case"uint16":return u(e);case"uint32":return l(e);case"int8":return c(e);case"int16":return h(e);case"int32":return p(e);case"float":case"float32":return d(e);case"double":case"float64":return g(e);case"uint8_clamped":return m(e);case"buffer":return v(e);case"data":case"dataview":return y(e);default:return null}return null},kt.mallocArrayBuffer=s,kt.mallocUint8=f,kt.mallocUint16=u,kt.mallocUint32=l,kt.mallocInt8=c,kt.mallocInt16=h,kt.mallocInt32=p,kt.mallocFloat32=kt.mallocFloat=d,kt.mallocFloat64=kt.mallocDouble=g,kt.mallocUint8Clamped=m,kt.mallocDataView=y,kt.mallocBuffer=v,kt.clearCache=function(){for(var e=0;e<32;++e)r.UINT8[e].length=0,r.UINT16[e].length=0,r.UINT32[e].length=0,r.INT8[e].length=0,r.INT16[e].length=0,r.INT32[e].length=0,r.FLOAT[e].length=0,r.DOUBLE[e].length=0,r.UINT8C[e].length=0,a[e].length=0,i[e].length=0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},We.Buffer);var Et;let Tt=new E;function Dt(e){return this instanceof Dt?e instanceof Dt?(Ft(this,"textures",e),Ft(this,"textures2",e),Ft(this,"lastY",e),Ft(this,"minY",e),Ft(this,"maxY",e),Ft(this,"total",e),Ft(this,"shader",e),Ft(this,"gl",e),Ft(this,"regl",e),Ft(this,"canvas",e),Ft(this,"blankTexture",e),Ft(this,"NaNTexture",e),Ft(this,"pushQueue",e),Ft(this,"textureLength",e),Ft(this,"textureShape",e),Object.defineProperty(this,"dirty",{get:()=>this._dirty||e.dirty||e.drawOptions.total!==this.drawOptions.total,set:e=>this._dirty=e}),this.dirty=!0,this.drawOptions={},this.isClone=!0,this.update({color:e.color,thickness:e.thickness}),this):(this.textures=[],this.textures2=[],this.lastY,this.minY=1/0,this.maxY=-1/0,this.total=0,this.drawOptions={},this.shader=this.createShader(e),this.gl=this.shader.gl,this.regl=this.shader.regl,this.canvas=this.gl.canvas,this.blankTexture=this.shader.blankTexture,this.NaNTexture=this.shader.NaNTexture,this.pushQueue=[],this.dirty=!0,void(U(e)&&this.update(e))):new Dt(e)}function Rt(e){if("number"==typeof e)return e;if(!ne)return parseFloat(e);let t=ve(e);return t[0]*Ce(t[1])}function Ft(e,t,n){Object.defineProperty(e,t,{get:()=>n[t],set:e=>n[t]=e})}Dt.prototype.createShader=function(e){let t,n,r;if(e||(e={}),r=Tt.get(e))return r;if(function(e){return"function"==typeof e&&e._gl&&e.prop&&e.texture&&e.buffer}(e)&&(e={regl:e}),!U(e)||e.canvas||e.gl||e.regl){if(n=ee(e),r=Tt.get(n))return r;t=be({gl:n,extensions:"OES_texture_float"})}else if(n=(t=be({extensions:"OES_texture_float"}))._gl,r=Tt.get(n))return r;let a=t.buffer({usage:"static",type:"int16",data:(e=>{let t=Array();t.push(-2,1,1,-2,-1,1);for(let n=-1;n<e;n++)t.push(n,1,-1,n,-1,-1),t.push(n,1,1,n,-1,1);return t})(this.maxSampleCount)}),i={primitive:(e,t)=>t.primitive||"triangle strip",offset:t.prop("offset"),count:t.prop("count"),frag:te(["// fragment shader with fading based on distance from average\n\nprecision highp float;\n#define GLSLIFY 1\n\nuniform vec4 viewport;\nuniform float thickness;\n\nvarying vec4 fragColor;\nvarying float normThickness;\nvarying vec3 statsLeft, statsRight, statsPrevRight, statsNextLeft;\n\nconst float TAU = 6.283185307179586;\n\nfloat pdf (float x, float mean, float variance) {\n\tif (variance == 0.) return x == mean ? 9999. : 0.;\n\telse return exp(-.5 * pow(x - mean, 2.) / variance) / sqrt(TAU * variance);\n}\n\nfloat fade(float y, vec3 stats) {\n\tfloat avg = stats.x;\n\tfloat sdev = stats.y;\n\tfloat nan = stats.z;\n\tif (nan == -1.) return 0.;\n\tfloat dist = abs(y - avg);\n\tfloat pdfCoef = pdf(0., 0., sdev * sdev );\n\t// pdfCoef makes sure pdf is normalized - has 1. value at the max\n\tdist = pdf(dist, 0., sdev * sdev  ) / pdfCoef;\n\treturn dist;\n}\n\nvoid main() {\n\tfloat halfThickness = normThickness * .5;\n\n\tfloat x = (gl_FragCoord.x - viewport.x) / viewport.z;\n\tfloat y = (gl_FragCoord.y - viewport.y) / viewport.w;\n\n\tgl_FragColor = fragColor;\n\n\tfloat avgRight = statsRight.x;\n\tfloat avgLeft = statsLeft.x;\n\tfloat avgNextLeft = statsNextLeft.x;\n\tfloat avgPrevRight = statsPrevRight.x;\n\tfloat sdevRight = statsRight.y;\n\tfloat sdevLeft = statsLeft.y;\n\tfloat sdevNextLeft = statsNextLeft.y;\n\tfloat sdevPrevRight = statsPrevRight.y;\n\n\tif (y > avgRight + halfThickness) {\n\t\tif (avgRight > avgLeft) {\n\t\t\t// local max\n\t\t\tif (avgRight > avgNextLeft) {\n\t\t\t\tgl_FragColor.a *= fade(y, statsRight);\n\t\t\t}\n\t\t\t// sdev can make y go over the\n\t\t\telse if (sdevRight > 0. && y > avgNextLeft + halfThickness) {\n\t\t\t\tgl_FragColor.a *= fade(y, statsNextLeft);\n\t\t\t}\n\t\t}\n\t}\n\tif (y > avgLeft + halfThickness) {\n\t\t// local max\n\t\tif (avgLeft > avgRight) {\n\t\t\t// local max\n\t\t\tif (avgLeft > avgPrevRight) {\n\t\t\t\tgl_FragColor.a *= fade(y, statsLeft);\n\t\t\t}\n\t\t\t// sdev can make y go over the\n\t\t\telse if (sdevLeft > 0. && y > avgPrevRight + halfThickness) {\n\t\t\t\tgl_FragColor.a *= fade(y, statsPrevRight);\n\t\t\t}\n\t\t}\n\t}\n\tif (y < avgRight - halfThickness) {\n\t\tif (avgRight < avgLeft) {\n\t\t\t// local min\n\t\t\tif (avgRight < avgNextLeft) {\n\t\t\t\tgl_FragColor.a *= fade(y, statsRight);\n\t\t\t}\n\t\t\t// sdev can make y go over the\n\t\t\telse if (sdevRight > 0. && y < avgNextLeft - halfThickness) {\n\t\t\t\tgl_FragColor.a *= fade(y, statsNextLeft);\n\t\t\t}\n\t\t}\n\t}\n\tif (y < avgLeft - halfThickness) {\n\t\t// local min\n\t\tif (avgLeft < avgRight) {\n\t\t\t// local min\n\t\t\tif (avgLeft < avgPrevRight) {\n\t\t\t\tgl_FragColor.a *= fade(y, statsLeft);\n\t\t\t}\n\t\t\t// sdev can make y go over the\n\t\t\telse if (sdevLeft > 0. && y < avgPrevRight - halfThickness) {\n\t\t\t\tgl_FragColor.a *= fade(y, statsPrevRight);\n\t\t\t}\n\t\t}\n\t}\n\n\t// if (dist == 0.) { discard; return; }\n\n\t// gl_FragColor.a *= dist;\n}\n"]),uniforms:{"samples.id":t.prop("textureId"),samplesData:t.prop("samples"),"samples.prev":t.prop("prevSamples"),"samples.next":t.prop("nextSamples"),"samples.shape":t.prop("dataShape"),"samples.length":t.prop("dataLength"),"samples.sum":(e,t)=>we.float(t.samples.sum),"samples.sum2":(e,t)=>we.float(t.samples.sum2),"samples.prevSum":(e,t)=>we.float(t.prevSamples.sum),"samples.prevSum2":(e,t)=>we.float(t.prevSamples.sum2),"fractions.id":t.prop("textureId"),fractionsData:t.prop("fractions"),"fractions.prev":t.prop("prevFractions"),"fractions.next":t.prop("nextFractions"),"fractions.shape":t.prop("dataShape"),"fractions.length":t.prop("dataLength"),"fractions.sum":(e,t)=>we.fract(t.samples.sum),"fractions.sum2":(e,t)=>we.fract(t.samples.sum2),"fractions.prevSum":(e,t)=>we.fract(t.prevSamples.sum),"fractions.prevSum2":(e,t)=>we.fract(t.prevSamples.sum2),passNum:t.prop("passNum"),passId:t.prop("passId"),passOffset:t.prop("passOffset"),total:t.prop("total"),range:t.prop("range"),pxStep:t.prop("pxStep"),posShift:t.prop("posShift"),sampleStep:t.prop("sampleStep"),translate:t.prop("translate"),amplitude:t.prop("amplitude"),viewport:t.prop("viewport"),opacity:t.prop("opacity"),color:t.prop("color"),thickness:(e,t)=>t.thickness*e.pixelRatio},attributes:{id:{buffer:a,stride:6,offset:0},sign:{buffer:a,stride:6,offset:2},side:{buffer:a,stride:6,offset:4}},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:(e,{clip:t,viewport:n})=>t?{x:t[0],y:t[1],width:t[2],height:t[3]}:{x:n[0],y:n[1],width:n[2],height:n[3]}},viewport:(e,{viewport:t})=>({x:t[0],y:t[1],width:t[2],height:t[3]}),stencil:!1},o=t(fe({vert:te(["// output range-average samples line with sdev weighting\n\nprecision highp float;\n#define GLSLIFY 1\n\n// linear interpolation\nvec4 lerp(vec4 a, vec4 b, float t) {\n\treturn t * b + (1. - t) * a;\n}\nvec2 lerp(vec2 a, vec2 b, float t) {\n\treturn t * b + (1. - t) * a;\n}\n\n// bring sample value to 0..1 from amplitude range\nfloat reamp(float v, vec2 amp) {\n\treturn (v - amp.x) / (amp.y - amp.x);\n}\n\nstruct Samples {\n\tfloat id;\n\t// sampler2D data;\n\tsampler2D prev;\n\tsampler2D next;\n\tvec2 shape;\n\tfloat length;\n\tfloat sum, prevSum, sum2, prevSum2;\n};\n\nattribute float id, sign, side;\n\nuniform Samples samples, fractions;\nuniform sampler2D samplesData, fractionsData;\nuniform float opacity, thickness, pxStep, sampleStep, total, translate, passNum, passId;\nuniform vec4 viewport, color;\nuniform vec2 amplitude;\n\nvarying vec4 fragColor;\nvarying vec3 statsLeft, statsRight, statsPrevRight, statsNextLeft;\nvarying float normThickness;\n\nconst float FLT_EPSILON = 1.19209290e-7;\n\n// returns sample picked from the texture\nvec4 picki (Samples samples, sampler2D data, float offset) {\n\t// translate is here in order to remove float32 error (at the latest stage)\n\toffset += translate;\n\n\tvec2 uv = vec2(\n\t\tfloor(mod(offset, samples.shape.x)) + .5,\n\t\tfloor(offset / samples.shape.x) + .5\n\t) / samples.shape;\n\n\tvec4 sample;\n\n\t// prev texture\n\tif (uv.y < 0.) {\n\t\tuv.y += 1.;\n\t\tsample = texture2D(samples.prev, uv);\n\t\tsample.y -= samples.prevSum;\n\t\tsample.z -= samples.prevSum2;\n\t}\n\t// next texture\n\telse if (uv.y > 1.) {\n\t\tuv.y -= 1.;\n\t\tsample = texture2D(samples.next, uv);\n\t\tsample.y += samples.sum;\n\t\tsample.z += samples.sum2;\n\t}\n\t// curr texture\n\telse {\n\t\tsample = texture2D(data, uv);\n\t}\n\n\treturn sample;\n}\n\n// returns {avg, sdev, isNaN}\nvec3 stats (float offset) {\n\tfloat sampleStep = sampleStep;\n\n\tfloat offset0 = offset - sampleStep * .5;\n\tfloat offset1 = offset + sampleStep * .5;\n\tfloat offset0l = floor(offset0);\n\tfloat offset1l = floor(offset1);\n\tfloat offset0r = ceil(offset0);\n\tfloat offset1r = ceil(offset1);\n\n\tvec4 sample = picki(samples, samplesData, offset);\n\t// if (sample.w == -1.) return vec3(0,0,-1);\n\n\t// head picks half the first sample\n\tvec4 sample0l = picki(samples, samplesData, offset0l);\n\tvec4 sample1l = picki(samples, samplesData, offset1l);\n\tvec4 sample0r = picki(samples, samplesData, offset0r);\n\tvec4 sample1r = picki(samples, samplesData, offset1r);\n\n\tvec4 sample0lf = picki(fractions, fractionsData, offset0l);\n\tvec4 sample1lf = picki(fractions, fractionsData, offset1l);\n\tvec4 sample0rf = picki(fractions, fractionsData, offset0r);\n\tvec4 sample1rf = picki(fractions, fractionsData, offset1r);\n\n\tfloat t0 = 0., t1 = 0.;\n\n\t// partial sample steps require precision\n\t// WARN: we removed lerp in order to  precision\n\t// if (mod(sampleStep, 1.) != 0. && sample0l.w != -1. && sample1r.w != -1.) {\n\t// \tt0 = offset0 - offset0l, t1 = offset1 - offset1l;\n\t// }\n\n\tif (sample0l.w == -1.) {\n\t\t// return vec3(0,0,-1);\n\t\t// sample0l.y = 0.;\n\t}\n\n\tfloat n = (offset1l - offset0l);\n\n\tfloat avg = (\n\t\t+ sample1l.y\n\t\t- sample0l.y\n\t\t+ sample1lf.y\n\t\t- sample0lf.y\n\t\t// + t1 * (sample1r.y - sample1l.y)\n\t\t// - t0 * (sample0r.y - sample0l.y)\n\t\t// + t1 * (sample1rf.y - sample1lf.y)\n\t\t// - t0 * (sample0rf.y - sample0lf.y)\n\t);\n\tavg /= n;\n\n\tfloat mx2 = (\n\t\t+ sample1l.z\n\t\t- sample0l.z\n\t\t+ sample1lf.z\n\t\t- sample0lf.z\n\t\t// + t1 * (sample1r.z - sample1l.z)\n\t\t// - t0 * (sample0r.z - sample0l.z)\n\t\t// + t1 * (sample1rf.z - sample1lf.z)\n\t\t// - t0 * (sample0rf.z - sample0lf.z)\n\t);\n\tmx2 /= n;\n\n\t// (x) = M(x) - M(x)\n\tfloat m2 = avg * avg;\n\tfloat variance = abs(mx2 - m2);\n\n\t// get float32 tolerance for the power of mx2/m2\n\t// float tol = FLT_EPSILON * pow(2., ceil(9. + log2(max(mx2, m2))));\n\n\t// float sdev = variance <= tol ? 0. : sqrt(variance);\n\tfloat sdev = sqrt(variance);\n\n\treturn vec3(avg, sdev, min(sample0r.w, sample1l.w));\n}\n\nvoid main() {\n\tgl_PointSize = 3.5;\n\tif (color.a == 0.) return;\n\n\tnormThickness = thickness / viewport.w;\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n\n\tfloat offset = id * sampleStep;\n\n\t// compensate snapping for low scale levels\n\tfloat posShift = 0.;\n\n\tvec3 statsCurr = stats(offset);\n\n\t// ignore NaN amplitudes\n\tif (statsCurr.z == -1.) return;\n\n\tvec3 statsPrev = stats(offset - sampleStep);\n\tvec3 statsPrev2 = stats(offset - 2. * sampleStep);\n\tvec3 statsNext = stats(offset + sampleStep);\n\tvec3 statsNext2 = stats(offset + 2. * sampleStep);\n\n\tfloat avgCurr = statsCurr.x;\n\tfloat avgPrev = statsPrev.x;\n\tfloat avgPrev2 = statsPrev2.z != -1. ? statsPrev2.x : avgPrev;\n\tfloat avgNext = statsNext.x;\n\tfloat avgNext2 = statsNext2.z != -1. ? statsNext2.x : avgNext;\n\n\tfloat ampRange = abs(\n\t\t+ amplitude.y - amplitude.x\n\t);\n\tfloat sdevCurr = statsCurr.y / ampRange;\n\tfloat sdevPrev = statsPrev.y / ampRange;\n\tfloat sdevPrev2 = statsPrev2.y / ampRange;\n\tfloat sdevNext = statsNext.y / ampRange;\n\tfloat sdevNext2 = statsNext2.y / ampRange;\n\n\tfloat sdev = sdevCurr;\n\n\tavgCurr = reamp(avgCurr, amplitude);\n\tavgNext = reamp(avgNext, amplitude);\n\tavgNext2 = reamp(avgNext2, amplitude);\n\tavgPrev = reamp(avgPrev, amplitude);\n\tavgPrev2 = reamp(avgPrev2, amplitude);\n\n\t// compensate for sampling rounding\n\tvec2 position = vec2(\n\t\t(pxStep * (id + .5)) / viewport.z,\n\t\tavgCurr\n\t);\n\n\tvec2 normalLeft = normalize(vec2(\n\t\t-(avgCurr - avgPrev), pxStep / viewport.w\n\t));\n\tvec2 normalRight = normalize(vec2(\n\t\t-(avgNext - avgCurr), pxStep / viewport.w\n\t));\n\n\tvec2 bisec = normalize(normalLeft + normalRight);\n\tvec2 vert = vec2(0, 1);\n\tfloat bisecLen = abs(1. / dot(normalLeft, bisec));\n\tfloat vertRightLen = abs(1. / dot(normalRight, vert));\n\tfloat vertLeftLen = abs(1. / dot(normalLeft, vert));\n\tfloat maxVertLen = max(vertLeftLen, vertRightLen);\n\tfloat minVertLen = min(vertLeftLen, vertRightLen);\n\n\t// 2 covers 68% of a line. 4 covers 95% of line\n\tfloat vertSdev = 2. * sdev * viewport.w / thickness;\n\n\tvec2 join;\n\n\tif (statsPrev.z == -1.) {\n\t\tjoin = normalRight;\n\t}\n\telse if (statsNext.z == -1.) {\n\t\tjoin = normalLeft;\n\t}\n\t// sdev less than projected to vertical shows simple line\n\t// FIXME: sdev should be compensated by curve bend\n\telse if (vertSdev < maxVertLen) {\n\t\t// sdev more than normal but less than vertical threshold\n\t\t// rotates join towards vertical\n\t\tif (vertSdev > minVertLen) {\n\t\t\tfloat t = (vertSdev - minVertLen) / (maxVertLen - minVertLen);\n\t\t\tjoin = lerp(bisec * bisecLen, vert * maxVertLen, t);\n\t\t}\n\t\telse {\n\t\t\tjoin = bisec * bisecLen;\n\t\t}\n\t}\n\t// sdev more than projected to vertical modifies only y coord\n\telse {\n\t\tjoin = vert * vertSdev;\n\t}\n\n\t// figure out segment varyings\n\tstatsCurr = vec3(avgCurr, sdevCurr, statsCurr.z);\n\tstatsPrev = vec3(avgPrev, sdevPrev, statsPrev.z);\n\tstatsNext = vec3(avgNext, sdevNext, statsNext.z);\n\tstatsNext2 = vec3(avgNext2, sdevNext2, statsNext2.z);\n\tstatsPrev2 = vec3(avgPrev2, sdevPrev2, statsPrev2.z);\n\tstatsRight = side < 0. ? statsCurr : statsNext;\n\tstatsLeft = side < 0. ? statsPrev : statsCurr;\n\tstatsPrevRight = side < 0. ? statsPrev2 : statsPrev;\n\tstatsNextLeft = side < 0. ? statsNext : statsNext2;\n\n\tposition += sign * join * .5 * thickness / viewport.zw;\n\n\t// shift position by the clip offset\n\tposition.x += passId * pxStep * samples.length / sampleStep / viewport.z;\n\n\tgl_Position = vec4(position * 2. - 1., 0, 1);\n}\n"])},i)),s=t(fe({vert:te(["// direct sample output, connected by line, to the contrary to range\n\nprecision highp float;\n#define GLSLIFY 1\n\n// bring sample value to 0..1 from amplitude range\nfloat reamp(float v, vec2 amp) {\n\treturn (v - amp.x) / (amp.y - amp.x);\n}\n\nstruct Samples {\n\tfloat id;\n\t// sampler2D data;\n\tsampler2D prev;\n\tsampler2D next;\n\tvec2 shape;\n\tfloat length;\n\tfloat sum, prevSum, sum2, prevSum2;\n};\n\nattribute float id, sign, side;\n\nuniform Samples samples;\nuniform sampler2D samplesData;\nuniform float opacity, thickness, pxStep, sampleStep, total, translate, posShift;\nuniform vec4 viewport, color;\nuniform vec2 amplitude, range;\nuniform float passNum, passId, passOffset;\n\nvarying vec4 fragColor;\nvarying vec3 statsLeft, statsRight, statsPrevRight, statsNextLeft;\nvarying float normThickness;\n\nbool isNaN (vec4 sample) {\n\treturn sample.w == -1.;\n}\n\nvec4 stats (float offset) {\n\t// translate is here in order to remove float32 error (at the latest stage)\n\toffset += translate;\n\n\tvec2 uv = vec2(\n\t\tfloor(mod(offset, samples.shape.x)) + .5,\n\t\tfloor((offset) / samples.shape.x) + .5\n\t) / samples.shape;\n\n\tvec4 sample;\n\n\t// prev texture\n\tif (uv.y < 0.) {\n\t\tuv.y += 1.;\n\t\tsample = texture2D(samples.prev, uv);\n\t}\n\t// next texture\n\telse if (uv.y > 1.) {\n\t\tuv.y -= 1.;\n\t\tsample = texture2D(samples.next, uv);\n\t}\n\t// curr texture\n\telse {\n\t\tsample = texture2D(samplesData, uv);\n\t}\n\n\treturn sample;\n}\n\nvoid main () {\n\tgl_PointSize = 4.5;\n\tif (color.a == 0.) return;\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n\n\tnormThickness = thickness / viewport.w;\n\n\tfloat offset = id * sampleStep;\n\n\t// calc average of curr..next sampling points\n\tvec4 sampleCurr = stats(offset);\n\tif (isNaN(sampleCurr)) return;\n\n\tvec4 sampleNext = stats(offset + sampleStep);\n\tvec4 sampleNext2 = stats(offset + 2. * sampleStep);\n\tvec4 samplePrev = stats(offset - sampleStep);\n\tvec4 samplePrev2 = stats(offset - 2. * sampleStep);\n\n\tbool isStart = isNaN(samplePrev);\n\tbool isEnd = isNaN(sampleNext);\n\n\tfloat avgCurr = reamp(sampleCurr.x, amplitude);\n\tfloat avgNext = reamp(isEnd ? sampleCurr.x : sampleNext.x, amplitude);\n\tfloat avgNext2 = reamp(sampleNext2.x, amplitude);\n\tfloat avgPrev = reamp(isStart ? sampleCurr.x : samplePrev.x, amplitude);\n\tfloat avgPrev2 = reamp(samplePrev2.x, amplitude);\n\n\t// fake sdev 2 = thickness\n\t// sdev = normThickness / 2.;\n\tfloat sdev = 0.;\n\n\tvec2 position = vec2(\n\t\tpxStep * (id + .5) / (viewport.z),\n\t\tavgCurr\n\t);\n\n\tfloat x = (pxStep) / viewport.z;\n\tvec2 normalLeft = normalize(vec2(\n\t\t-(avgCurr - avgPrev), x\n\t) / viewport.zw);\n\tvec2 normalRight = normalize(vec2(\n\t\t-(avgNext - avgCurr), x\n\t) / viewport.zw);\n\n\tvec2 join;\n\tif (isStart || isStart) {\n\t\tjoin = normalRight;\n\t}\n\telse if (isEnd || isEnd) {\n\t\tjoin = normalLeft;\n\t}\n\telse {\n\t\tvec2 bisec = normalLeft * .5 + normalRight * .5;\n\t\tfloat bisecLen = abs(1. / dot(normalLeft, bisec));\n\t\tjoin = bisec * bisecLen;\n\t}\n\n\t// FIXME: limit join by prev vertical\n\t// float maxJoinX = min(abs(join.x * thickness), 40.) / thickness;\n\t// join.x *= maxJoinX / join.x;\n\n\t// figure out closest to current min/max\n\tvec3 statsCurr = vec3(avgCurr, 0, sampleCurr.z);\n\tvec3 statsPrev = vec3(avgPrev, 0, samplePrev.z);\n\tvec3 statsNext = vec3(avgNext, 0, sampleNext.z);\n\tvec3 statsNext2 = vec3(avgNext2, 0, sampleNext2.z);\n\tvec3 statsPrev2 = vec3(avgPrev2, 0, samplePrev2.z);\n\n\tstatsRight = side < 0. ? statsCurr : statsNext;\n\tstatsLeft = side < 0. ? statsPrev : statsCurr;\n\tstatsPrevRight = side < 0. ? statsPrev2 : statsPrev;\n\tstatsNextLeft = side < 0. ? statsNext : statsNext2;\n\n\tposition += sign * join * .5 * thickness / viewport.zw;\n\n\t// compensate snapped sampleStep to enable smooth zoom\n\tposition.x += posShift / viewport.z;\n\n\t// shift position by the clip offset\n\t// FIXME: move to uniform\n\tposition.x += passId * pxStep * samples.length / sampleStep / viewport.z;\n\n\tgl_Position = vec4(position * 2. - 1., 0, 1);\n}\n"])},i)),f=t.texture({width:1,height:1,channels:this.textureChannels,type:"float"});f.sum=0,f.sum2=0;let u=t.texture({width:1,height:1,channels:this.textureChannels,type:"float",data:new Float32Array([NaN,0,0,-1])});return u.sum=0,u.sum2=0,r={drawRanges:o,drawLine:s,regl:t,idBuffer:a,NaNTexture:u,blankTexture:f,gl:n},Tt.set(n,r),r},Object.defineProperties(Dt.prototype,{viewport:{get:function(){return this.dirty?(e=this._viewport?[this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height]:[0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight],this.flip||(e[1]=this.gl.drawingBufferHeight-e[1]-e[3]),e):this.drawOptions.viewport;var e},set:function(e){this._viewport=e?ye(e):e}},color:{get:function(){return this.dirty?this._color||[0,0,0,255]:this.drawOptions.color},set:function(e){if(e||(e="transparent"),"string"==typeof e)this._color=X(e,"uint8");else if("number"==typeof e[0]){let t=Math.max(e.length,4);this._color&&kt.freeUint8(this._color),this._color=kt.mallocUint8(t);let n=(e.subarray||e.slice).bind(e);for(let e=0;e<t;e+=4)this._color.set(X(n(e,e+4),"uint8"),e)}else{let t=e.length;this._color&&kt.freeUint8(this._color),this._color=kt.mallocUint8(4*t);for(let n=0;n<t;n++)this._color.set(X(e[n],"uint8"),4*n)}}},amplitude:{get:function(){return this.dirty?this._amplitude||[this.minY,this.maxY]:this.drawOptions.amplitude},set:function(e){"number"==typeof e?this._amplitude=[-e,+e]:e.length?this._amplitude=[e[0],e[1]]:this._amplitude=e}},range:{get:function(){return this.dirty?null!=this._range?"number"==typeof this._range?[ae(this._range,this.total),this.total]:this._range:[0,this.total]:this.drawOptions.range},set:function(e){if(!e)return this._range=null;e.length?4===e.length?(this._range=[e[0],e[2]],this.amplitude=[e[1],e[3]]):this._range=[e[0],e[1]]:"number"==typeof e&&(this._range=e),this.dirty=!0}}}),Dt.prototype.update=function(e){if(!e)return this;if(null!=e.length)e={data:e};else if("object"!=typeof e)throw Error("Argument must be a data or valid object");if(this.dirty=!0,void 0!==(e=Z(e,{data:"data value values sample samples",range:"range dataRange dataBox dataBounds dataLimits",amplitude:"amp amplitude amplitudes ampRange bounds limits maxAmplitude maxAmp",thickness:"thickness width linewidth lineWidth line-width",pxStep:"step pxStep",color:"color colour colors colours fill fillColor fill-color",line:"line line-style lineStyle linestyle",viewport:"clip vp viewport viewBox viewbox viewPort area",opacity:"opacity alpha transparency visible visibility opaque",flip:"flip iviewport invertViewport inverseViewport",mode:"mode",shape:"shape textureShape",sampleStep:"sampleStep"})).mode&&(this.mode=e.mode),void 0!==e.shape){if(this.textures.length)throw Error("Cannot set texture shape because textures are initialized already");this.textureShape=e.shape,this.textureLength=this.textureShape[0]*this.textureShape[1]}if(e.line)if("string"==typeof e.line){let t=e.line.split(/\s+/);/0-9/.test(t[0][0])?(e.thickness||(e.thickness=t[0]),!e.color&&t[1]&&(e.color=t[1])):(!e.thickness&&t[1]&&(e.thickness=t[1]),e.color||(e.color=t[0]))}else e.color=e.line;return void 0!==e.thickness&&(this.thickness=Rt(e.thickness)),void 0!==e.pxStep&&(this.pxStep=Rt(e.pxStep)),void 0!==e.opacity&&(this.opacity=parseFloat(e.opacity)),void 0!==e.viewport&&(this.viewport=e.viewport),e.flip&&(this.flip=!!e.flip),void 0!==e.range&&(this.range=e.range),void 0!==e.color&&(this.color=e.color),void 0!==e.amplitude&&(this.amplitude=e.amplitude),e.data&&(this.total=0,this.lastY=null,this.minY=1/0,this.maxY=-1/0,this.push(e.data)),e.push&&this.push(e.push),e.sampleStep&&(this.sampleStep=e.sampleStep),this},Dt.prototype.calc=function(){if(!this.dirty)return this.drawOptions;this.flush();let{total:e,opacity:t,amplitude:n,viewport:r,range:a}=this,i=this.color,o=this.thickness,s=Math.abs(a[1]-a[0])||1,f=Math.max(r[2]/s,this.pxStep||.5),u=f*s/r[2];u=we.float(u),u=Math.max(Math.round(u),1),this.sampleStep&&(u=this.sampleStep);let l=(f=r[2]*u/s)/u,c=0;l>1&&(c=(Math.round(a[0])-a[0])*l);let h=this.mode,p=Math.ceil(Math.floor(1e3*s)/1e3/this.textureLength),d=Array(p),g=Math.round(a[0]/this.textureLength),m=Math.min(this.textureLength/u*f,r[2]);for(let e=0;e<p;e++){let t=g+e;if(t<-1)continue;if(t>this.textures.length)continue;let n=Math.round(e*m),i=Math.round((e+1)*m),o=[n+r[0],r[1],i-n,r[3]],s=Math.round(a[0]/this.textureLength)*this.textureLength,l=Math.round(a[0])-s,c=Math.min(Math.ceil(m/f),Math.ceil(this.textureLength/u));d[e]={passId:e,textureId:t,clip:o,passOffset:s,translate:l,count:Math.min(4+4*c*3+4,this.maxSampleCount),offset:0,samples:this.textures[t]||this.NaNTexture,fractions:this.textures2[t]||this.blankTexture,prevSamples:this.textures[t-1]||this.NaNTexture,nextSamples:this.textures[t+1]||this.NaNTexture,prevFractions:this.textures2[t-1]||this.blankTexture,nextFractions:this.textures2[t+1]||this.blankTexture,shift:0}}return this.drawOptions={thickness:o,color:i,pxStep:f,pxPerSample:l,viewport:r,sampleStep:u,span:s,total:e,opacity:t,amplitude:n,range:a,mode:h,passes:d,passNum:p,posShift:c,dataShape:this.textureShape,dataLength:this.textureLength},this.dirty=!1,this.drawOptions},Dt.prototype.render=function(){if(this.flush(),this.total<2)return this;let e=this.calc();return e.passes.forEach(t=>{fe(e,t),e.color,e.pxPerSample<=1||"range"===e.mode&&"line"!=e.mode?this.shader.drawRanges.call(this,e):this.shader.drawLine.call(this,e)}),this},Dt.prototype.push=function(...e){if(!e||!e.length)return this;for(let t=0;t<e.length;t++)if(e[t].length)if(e[t].length>1024)for(let n=0;n<e[t].length;n++)this.pushQueue.push(e[t][n]);else this.pushQueue.push(...e[t]);else this.pushQueue.push(e[t]);return this.cancelFlush&&(this.cancelFlush(),this.cancelFlush=null),this.dirty=!0,this.cancelFlush=de(()=>{this.cancelFlush=null,this.flush()}),this},Dt.prototype.flush=function(){if(this.cancelFlush&&(this.cancelFlush(),this.cancelFlush=null),this.pushQueue.length){let e=this.pushQueue;this.set(e,this.total),this.pushQueue.length=0}return this},Dt.prototype.set=function(e,t=0){if(!e||!e.length)return this;if(t+e.length>this.total+this.pushQueue.length&&this.flush(),t>this.total&&this.set(Array(t-this.total),this.total),this.dirty=!0,Array.isArray(e)){let t=kt.mallocFloat64(e.length);for(let n=0;n<e.length;n++)null==e[n]||isNaN(e[n])?t[n]=NaN:t[n]=e[n];e=t}for(let t=0;t<e.length;t++)this.minY>e[t]&&(this.minY=e[t]),this.maxY<e[t]&&(this.maxY=e[t]);this.textureShape||(this.textureShape=[512,512],this.textureLength=this.textureShape[0]*this.textureShape[1]);let[n,r]=this.textureShape,a=this.textureLength,i=t%a,o=Math.floor(t/a),s=Math.floor(i/n),f=i%n,u=a-i,l=this.textureChannels,c=this.textures[o],h=this.textures2[o];if(!c){let e=kt.mallocFloat64(a*l);for(let t=0;t<e.length;t+=l)e[t+0]=e[t+1]=e[t+2]=0,e[t+3]=-1;c=this.textures[o]=this.regl.texture({width:this.textureShape[0],height:this.textureShape[1],channels:l,type:"float",min:"nearest",mag:"nearest",wrap:["clamp","clamp"],data:we.float(e)}),this.lastY=c.sum=c.sum2=0,h=this.textures2[o]=this.regl.texture({width:this.textureShape[0],height:this.textureShape[1],channels:l,type:"float",min:"nearest",mag:"nearest",wrap:["clamp","clamp"]}),c.data=e}let p=Math.min(u,e.length),d=c.data.subarray(i*l,i*l+p*l);for(let t=0,n=p;t<n;t++)isNaN(e[t])?(d[t*l]=NaN,d[t*l+3]=-1):(d[t*l]=this.lastY=e[t],d[t*l+3]=0),c.sum+=this.lastY,c.sum2+=this.lastY*this.lastY,d[t*l+1]=c.sum,d[t*l+2]=c.sum2;this.total-t<p&&(this.total+=p-(this.total-t));let g=0;if(f){if(b(f,s,g=Math.min(n-f,p),1,d.subarray(0,g*l)),f+e.length<=n)return kt.freeFloat64(e),kt.freeFloat64(d),this;if(++s===r)return kt.freeFloat64(d),this.push(e.subarray(g)),kt.freeFloat64(e),this;i+=g}let m=Math.floor((p-g)/n),y=0;m&&(y=m*n,b(0,s,n,m,d.subarray(g*l,(g+y)*l)),s+=m);let v=p-g-y;if(v&&b(0,s,v,1,d.subarray(-v*l)),u<e.length)return this.set(e.subarray(u),this.total),kt.freeFloat64(e),kt.freeFloat64(d),this;function b(e,t,n,r,a){let i=kt.mallocFloat32(a.length),o=kt.mallocFloat32(a.length);for(let e=0;e<a.length;e++)i[e]=a[e],o[e]=a[e]-i[e];c.subimage({width:n,height:r,data:i},e,t),h.subimage({width:n,height:r,data:o},e,t),kt.freeFloat32(i),kt.freeFloat32(o)}return this},Dt.prototype.pick=function(e){if(!this.storeData)throw Error("Picking is disabled. Enable it via constructor options.");"number"!=typeof e&&(e=Math.max(e.clientX-function(e){if(e.getBoundingClientRect)return e.getBoundingClientRect();var t=0,n=0;do{t+=e.offsetLeft-e.scrollLeft,n+=e.offsetTop-e.scrollTop}while(e=e.offsetParent);return{left:t,top:n}}(this.canvas).left,0));let{span:t,translater:n,translateri:r,viewport:a,currTexture:i,sampleStep:o,pxPerSample:s,pxStep:f,amplitude:u}=this.calc(),l=this.textures[i];if(!l)return null;let c=Math.floor(t*e/a[2]),h=Math.floor(n+c),p=n-r;if(h<0||h>this.total)return null;let d=this.textureChannels,g=l.data.subarray(h*d,h*d+d)[0];return{average:g,sdev:0,offset:[h,h],x:a[2]*(c-p)/t+this.viewport.x,y:(-g-u[0])/(u[1]-u[0])*this.viewport.height+this.viewport.y}},Dt.prototype.clear=function(){if(!this.drawOptions)return this;let{gl:e,regl:t}=this,{x:n,y:r,width:a,height:i}=this.viewport;return e.enable(e.SCISSOR_TEST),e.scissor(n,r,a,i),t.clear({color:[0,0,0,0],depth:1}),e.clear(e.COLOR_BUFFRE_BIT|e.DEPTH_BUFFER_BIT),e.disable(e.SCISSOR_TEST),this},Dt.prototype.destroy=function(){this.textures.forEach(e=>{e.destroy()}),this.textures2.forEach(e=>{e.destroy()})},Dt.prototype.opacity=1,Dt.prototype.thickness=1,Dt.prototype.mode=null,Dt.prototype.flip=!1,Dt.prototype.textureShape,Dt.prototype.textureLength,Dt.prototype.textureChannels=4,Dt.prototype.maxSampleCount=16384,Et=Dt;var jt={bitrv2:function(e,t,n,r){let a,i,o,s,f,u,l,c,h,p;const d=new Int16Array(t).subarray(n),g=new Float64Array(r);for(d[0]=0,f=e,u=1;u<<3<f;){for(f>>=1,a=0;a<u;a++)d[u+a]=d[a]+f;u<<=1}const m=2*u;if(u<<3===f)for(o=0;o<u;o++){for(a=0;a<o;a++)i=2*a+d[o],s=2*o+d[a],l=g[i],c=g[i+1],h=g[s],p=g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c,s+=2*m,l=g[i+=m],c=g[i+1],h=g[s],p=g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c,s-=m,l=g[i+=m],c=g[i+1],h=g[s],p=g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c,s+=2*m,l=g[i+=m],c=g[i+1],h=g[s],p=g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c;s=(i=2*o+m+d[o])+m,l=g[i],c=g[i+1],h=g[s],p=g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c}else for(o=1;o<u;o++)for(a=0;a<o;a++)i=2*a+d[o],s=2*o+d[a],l=g[i],c=g[i+1],h=g[s],p=g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c,s+=m,l=g[i+=m],c=g[i+1],h=g[s],p=g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c},bitrv2conj:function(e,t,n,r){let a,i,o,s,f,u,l,c,h,p;const d=new Int16Array(t).subarray(n),g=new Float64Array(r);for(d[0]=0,f=e,u=1;u<<3<f;){for(f>>=1,a=0;a<u;a++)d[u+a]=d[a]+f;u<<=1}const m=2*u;if(u<<3===f)for(o=0;o<u;o++){for(a=0;a<o;a++)i=2*a+d[o],s=2*o+d[a],l=g[i],c=-g[i+1],h=g[s],p=-g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c,s+=2*m,l=g[i+=m],c=-g[i+1],h=g[s],p=-g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c,s-=m,l=g[i+=m],c=-g[i+1],h=g[s],p=-g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c,s+=2*m,l=g[i+=m],c=-g[i+1],h=g[s],p=-g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c;g[(s=2*o+d[o])+1]=-g[s+1],s=(i=s+m)+m,l=g[i],c=-g[i+1],h=g[s],p=-g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c,g[(s+=m)+1]=-g[s+1]}else for(g[1]=-g[1],g[m+1]=-g[m+1],o=1;o<u;o++){for(a=0;a<o;a++)i=2*a+d[o],s=2*o+d[a],l=g[i],c=-g[i+1],h=g[s],p=-g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c,s+=m,l=g[i+=m],c=-g[i+1],h=g[s],p=-g[s+1],g[i]=h,g[i+1]=p,g[s]=l,g[s+1]=c;g[(s=2*o+d[o])+1]=-g[s+1],g[s+m+1]=-g[s+m+1]}}};const Bt=function(e,t,n,r){let a,i,o,s,f,u,l,c,h,p,d,g,m,y,v,b,w,x,A,C,O;const _=new Float64Array(n),S=new Float64Array(r),k=t<<2;for(a=0;a<t;a+=2)s=(o=(i=a+t)+t)+t,y=_[a]+_[i],v=_[a+1]+_[i+1],b=_[a]-_[i],w=_[a+1]-_[i+1],x=_[o]+_[s],A=_[o+1]+_[s+1],C=_[o]-_[s],O=_[o+1]-_[s+1],_[a]=y+x,_[a+1]=v+A,_[o]=y-x,_[o+1]=v-A,_[i]=b-O,_[i+1]=w+C,_[s]=b+O,_[s+1]=w-C;for(c=S[2],a=k;a<t+k;a+=2)s=(o=(i=a+t)+t)+t,y=_[a]+_[i],v=_[a+1]+_[i+1],b=_[a]-_[i],w=_[a+1]-_[i+1],x=_[o]+_[s],A=_[o+1]+_[s+1],C=_[o]-_[s],O=_[o+1]-_[s+1],_[a]=y+x,_[a+1]=v+A,_[o]=A-v,_[o+1]=y-x,y=b-O,v=w+C,_[i]=c*(y-v),_[i+1]=c*(y+v),y=O+b,v=C-w,_[s]=c*(v-y),_[s+1]=c*(v+y);u=0;const E=2*k;for(f=E;f<e;f+=E){for(l=2*(u+=2),p=S[u],d=S[u+1],g=(c=S[l])-2*d*(h=S[l+1]),m=2*d*c-h,a=f;a<t+f;a+=2)s=(o=(i=a+t)+t)+t,y=_[a]+_[i],v=_[a+1]+_[i+1],b=_[a]-_[i],w=_[a+1]-_[i+1],x=_[o]+_[s],A=_[o+1]+_[s+1],C=_[o]-_[s],O=_[o+1]-_[s+1],_[a]=y+x,_[a+1]=v+A,y-=x,v-=A,_[o]=p*y-d*v,_[o+1]=p*v+d*y,y=b-O,v=w+C,_[i]=c*y-h*v,_[i+1]=c*v+h*y,y=b+O,v=w-C,_[s]=g*y-m*v,_[s+1]=g*v+m*y;for(g=(c=S[l+2])-2*p*(h=S[l+3]),m=2*p*c-h,a=f+k;a<t+(f+k);a+=2)s=(o=(i=a+t)+t)+t,y=_[a]+_[i],v=_[a+1]+_[i+1],b=_[a]-_[i],w=_[a+1]-_[i+1],x=_[o]+_[s],A=_[o+1]+_[s+1],C=_[o]-_[s],O=_[o+1]-_[s+1],_[a]=y+x,_[a+1]=v+A,y-=x,v-=A,_[o]=-d*y-p*v,_[o+1]=-d*v+p*y,y=b-O,v=w+C,_[i]=c*y-h*v,_[i+1]=c*v+h*y,y=b+O,v=w-C,_[s]=g*y-m*v,_[s+1]=g*v+m*y}},It=function(e,t,n){let r,a,i,o,s,f,u,l,c,h,p,d,g,m,y,v,b;const w=new Float64Array(t),x=new Float64Array(n);for(h=w[0]+w[2],p=w[1]+w[3],d=w[0]-w[2],g=w[1]-w[3],m=w[4]+w[6],y=w[5]+w[7],v=w[4]-w[6],b=w[5]-w[7],w[0]=h+m,w[1]=p+y,w[4]=h-m,w[5]=p-y,w[2]=d-b,w[3]=g+v,w[6]=d+b,w[7]=g-v,o=x[2],h=w[8]+w[10],p=w[9]+w[11],d=w[8]-w[10],g=w[9]-w[11],m=w[12]+w[14],y=w[13]+w[15],v=w[12]-w[14],b=w[13]-w[15],w[8]=h+m,w[9]=p+y,w[12]=y-p,w[13]=h-m,h=d-b,p=g+v,w[10]=o*(h-p),w[11]=o*(h+p),h=b+d,p=v-g,w[14]=o*(p-h),w[15]=o*(p+h),a=0,r=16;r<e;r+=16)i=2*(a+=2),f=x[a],u=x[a+1],l=(o=x[i])-2*u*(s=x[i+1]),c=2*u*o-s,h=w[r]+w[r+2],p=w[r+1]+w[r+3],d=w[r]-w[r+2],g=w[r+1]-w[r+3],m=w[r+4]+w[r+6],y=w[r+5]+w[r+7],v=w[r+4]-w[r+6],b=w[r+5]-w[r+7],w[r]=h+m,w[r+1]=p+y,h-=m,p-=y,w[r+4]=f*h-u*p,w[r+5]=f*p+u*h,h=d-b,p=g+v,w[r+2]=o*h-s*p,w[r+3]=o*p+s*h,h=d+b,p=g-v,w[r+6]=l*h-c*p,w[r+7]=l*p+c*h,l=(o=x[i+2])-2*f*(s=x[i+3]),c=2*f*o-s,h=w[r+8]+w[r+10],p=w[r+9]+w[r+11],d=w[r+8]-w[r+10],g=w[r+9]-w[r+11],m=w[r+12]+w[r+14],y=w[r+13]+w[r+15],v=w[r+12]-w[r+14],b=w[r+13]-w[r+15],w[r+8]=h+m,w[r+9]=p+y,h-=m,p-=y,w[r+12]=-u*h-f*p,w[r+13]=-u*p+f*h,h=d-b,p=g+v,w[r+10]=o*h-s*p,w[r+11]=o*p+s*h,h=d+b,p=g-v,w[r+14]=l*h-c*p,w[r+15]=l*p+c*h};jt.cftfsub=function(e,t,n){let r,a,i,o,s,f,u,l,c,h,p,d,g;const m=new Float64Array(t),y=new Float64Array(n);if(s=2,e>8)for(It(e,m.buffer,y.buffer),s=8;s<<2<e;)Bt(e,s,m.buffer,y.buffer),s<<=2;if(s<<2===e)for(r=0;r<s;r+=2)o=(i=(a=r+s)+s)+s,f=m[r]+m[a],u=m[r+1]+m[a+1],l=m[r]-m[a],c=m[r+1]-m[a+1],h=m[i]+m[o],p=m[i+1]+m[o+1],d=m[i]-m[o],g=m[i+1]-m[o+1],m[r]=f+h,m[r+1]=u+p,m[i]=f-h,m[i+1]=u-p,m[a]=l-g,m[a+1]=c+d,m[o]=l+g,m[o+1]=c-d;else for(r=0;r<s;r+=2)a=r+s,f=m[r]-m[a],u=m[r+1]-m[a+1],m[r]+=m[a],m[r+1]+=m[a+1],m[a]=f,m[a+1]=u},jt.cftbsub=function(e,t,n){let r,a,i,o,s,f,u,l,c,h,p,d,g;const m=new Float64Array(t),y=new Float64Array(n);if(s=2,e>8)for(It(e,m.buffer,y.buffer),s=8;s<<2<e;)Bt(e,s,m.buffer,y.buffer),s<<=2;if(s<<2===e)for(r=0;r<s;r+=2)o=(i=(a=r+s)+s)+s,f=m[r]+m[a],u=-m[r+1]-m[a+1],l=m[r]-m[a],c=-m[r+1]+m[a+1],h=m[i]+m[o],p=m[i+1]+m[o+1],d=m[i]-m[o],g=m[i+1]-m[o+1],m[r]=f+h,m[r+1]=u-p,m[i]=f-h,m[i+1]=u+p,m[a]=l-g,m[a+1]=c-d,m[o]=l+g,m[o+1]=c+d;else for(r=0;r<s;r+=2)a=r+s,f=m[r]-m[a],u=-m[r+1]+m[a+1],m[r]+=m[a],m[r+1]=-m[r+1]-m[a+1],m[a]=f,m[a+1]=u},jt.rftfsub=function(e,t,n,r,a){let i,o,s,f,u,l,c,h,p;const d=new Float64Array(t),g=new Float64Array(r).subarray(a),m=e>>1,y=2*n/m;for(s=0,i=2;i<m;i+=2)o=e-i,f=.5-g[n-(s+=y)],u=g[s],h=f*(l=d[i]-d[o])-u*(c=d[i+1]+d[o+1]),p=f*c+u*l,d[i]-=h,d[i+1]-=p,d[o]+=h,d[o+1]-=p},jt.rftbsub=function(e,t,n,r,a){let i,o,s,f,u,l,c,h,p;const d=new Float64Array(t),g=new Float64Array(r).subarray(a);d[1]=-d[1];const m=e>>1,y=2*n/m;for(s=0,i=2;i<m;i+=2)o=e-i,f=.5-g[n-(s+=y)],u=g[s],h=f*(l=d[i]-d[o])+u*(c=d[i+1]+d[o+1]),p=f*c-u*l,d[i]-=h,d[i+1]=p-d[i+1],d[o]+=h,d[o+1]=p-d[o+1];d[m+1]=-d[m+1]};var Pt={makewt:function(e,t,n){let r,a,i,o;const s=new Int16Array(t),f=new Float64Array(n);if(s[0]=e,s[1]=1,e>2&&(r=e>>1,a=Math.atan(1)/r,f[0]=1,f[1]=0,f[r]=Math.cos(a*r),f[r+1]=f[r],r>2)){for(let t=2;t<r;t+=2)i=Math.cos(a*t),o=Math.sin(a*t),f[t]=i,f[t+1]=o,f[e-t]=o,f[e-t+1]=i;jt.bitrv2(e,s.buffer,2,f.buffer)}},makect:function(e,t,n,r){let a,i,o;const s=new Int16Array(t),f=new Float64Array(n).subarray(r);if(s[1]=e,e>1)for(i=e>>1,o=Math.atan(1)/i,f[0]=Math.cos(o*i),f[i]=.5*f[0],a=1;a<i;a++)f[a]=.5*Math.cos(o*a),f[e-a]=.5*Math.sin(o*a)}},Lt={};const zt={FORWARDS:1,BACKWARDS:-1};Lt.DIRECTION=zt,Lt.rdft=function(e,t,n,r,a){const i=new Int16Array(r),o=new Float64Array(n),s=i[0],f=i[1];if(t===zt.FORWARDS){e>4?(jt.bitrv2(e,r,2,n),jt.cftfsub(e,n,a),jt.rftfsub(e,n,f,a,s)):4===e&&jt.cftfsub(e,n,a);const t=o[0]-o[1];o[0]+=o[1],o[1]=t}else o[1]=.5*(o[0]-o[1]),o[0]-=o[1],e>4?(jt.rftbsub(e,n,f,a,s),jt.bitrv2(e,r,2,n),jt.cftbsub(e,n,a)):4===e&&jt.cftfsub(e,n,a)},Lt.cdft=function(e,t,n,r,a){e>4?t===zt.FORWARDS?(jt.bitrv2(e,r,2,n),jt.cftfsub(e,n,a)):(jt.bitrv2conj(e,r,2,n),jt.cftbsub(e,n,a)):4===e&&jt.cftfsub(e,n,a)};var Nt={};Nt="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var Mt,Ut,qt,Wt=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8},Ht=Mt={};function Vt(){throw new Error("setTimeout has not been defined")}function Yt(){throw new Error("clearTimeout has not been defined")}function $t(e){if(Ut===setTimeout)return setTimeout(e,0);if((Ut===Vt||!Ut)&&setTimeout)return Ut=setTimeout,setTimeout(e,0);try{return Ut(e,0)}catch(t){try{return Ut.call(null,e,0)}catch(t){return Ut.call(this,e,0)}}}!function(){try{Ut="function"==typeof setTimeout?setTimeout:Vt}catch(e){Ut=Vt}try{qt="function"==typeof clearTimeout?clearTimeout:Yt}catch(e){qt=Yt}}();var Qt,Gt=[],Xt=!1,Zt=-1;function Jt(){Xt&&Qt&&(Xt=!1,Qt.length?Gt=Qt.concat(Gt):Zt=-1,Gt.length&&Kt())}function Kt(){if(!Xt){var e=$t(Jt);Xt=!0;for(var t=Gt.length;t;){for(Qt=Gt,Gt=[];++Zt<t;)Qt&&Qt[Zt].run();Zt=-1,t=Gt.length}Qt=null,Xt=!1,function(e){if(qt===clearTimeout)return clearTimeout(e);if((qt===Yt||!qt)&&clearTimeout)return qt=clearTimeout,clearTimeout(e);try{qt(e)}catch(t){try{return qt.call(null,e)}catch(t){return qt.call(this,e)}}}(e)}}function en(e,t){this.fun=e,this.array=t}function tn(){}Ht.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Gt.push(new en(e,t)),1!==Gt.length||Xt||$t(Kt)},en.prototype.run=function(){this.fun.apply(null,this.array)},Ht.title="browser",Ht.browser=!0,Ht.env={},Ht.argv=[],Ht.version="",Ht.versions={},Ht.on=tn,Ht.addListener=tn,Ht.once=tn,Ht.off=tn,Ht.removeListener=tn,Ht.removeAllListeners=tn,Ht.emit=tn,Ht.prependListener=tn,Ht.prependOnceListener=tn,Ht.listeners=function(e){return[]},Ht.binding=function(e){throw new Error("process.binding is not supported")},Ht.cwd=function(){return"/"},Ht.chdir=function(e){throw new Error("process.chdir is not supported")},Ht.umask=function(){return 0};var nn={};(function(e,t){var n=/%[sdj%]/g;nn.format=function(e){if(!g(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(i(arguments[r]));return t.join(" ")}r=1;for(var a=arguments,o=a.length,s=String(e).replace(n,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(a[r++]);case"%d":return Number(a[r++]);case"%j":try{return JSON.stringify(a[r++])}catch(e){return"[Circular]"}default:return e}}),f=a[r];r<o;f=a[++r])p(f)||!v(f)?s+=" "+f:s+=" "+i(f);return s},nn.deprecate=function(n,r){if(m(t.process))return function(){return nn.deprecate(n,r).apply(this,arguments)};if(!0===e.noDeprecation)return n;var a=!1;return function(){if(!a){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),a=!0}return n.apply(this,arguments)}};var r,a={};function i(e,t){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),h(t)?n.showHidden=t:t&&nn._extend(n,t),m(n.showHidden)&&(n.showHidden=!1),m(n.depth)&&(n.depth=2),m(n.colors)&&(n.colors=!1),m(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),f(n,e,n.depth)}function o(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function s(e,t){return e}function f(e,t,n){if(e.customInspect&&t&&x(t.inspect)&&t.inspect!==nn.inspect&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(n,e);return g(r)||(r=f(e,r,n)),r}var a=function(e,t){if(m(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return d(t)?e.stylize(""+t,"number"):h(t)?e.stylize(""+t,"boolean"):p(t)?e.stylize("null","null"):void 0}(e,t);if(a)return a;var i=Object.keys(t),o=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),w(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return u(t);if(0===i.length){if(x(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if(y(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(b(t))return e.stylize(Date.prototype.toString.call(t),"date");if(w(t))return u(t)}var v,A="",C=!1,O=["{","}"];return c(t)&&(C=!0,O=["[","]"]),x(t)&&(A=" [Function"+(t.name?": "+t.name:"")+"]"),y(t)&&(A=" "+RegExp.prototype.toString.call(t)),b(t)&&(A=" "+Date.prototype.toUTCString.call(t)),w(t)&&(A=" "+u(t)),0!==i.length||C&&0!=t.length?n<0?y(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),v=C?function(e,t,n,r,a){for(var i=[],o=0,s=t.length;o<s;++o)_(t,String(o))?i.push(l(e,t,n,r,String(o),!0)):i.push("");return a.forEach(function(a){a.match(/^\d+$/)||i.push(l(e,t,n,r,a,!0))}),i}(e,t,n,o,i):i.map(function(r){return l(e,t,n,o,r,C)}),e.seen.pop(),function(e,t,n){return e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(v,A,O)):O[0]+A+O[1]}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,n,r,a,i){var o,s,u;if((u=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),_(r,a)||(o="["+a+"]"),s||(e.seen.indexOf(u.value)<0?(s=p(n)?f(e,u.value,null):f(e,u.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),m(o)){if(i&&a.match(/^\d+$/))return s;(o=JSON.stringify(""+a)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function c(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function p(e){return null===e}function d(e){return"number"==typeof e}function g(e){return"string"==typeof e}function m(e){return void 0===e}function y(e){return v(e)&&"[object RegExp]"===A(e)}function v(e){return"object"==typeof e&&null!==e}function b(e){return v(e)&&"[object Date]"===A(e)}function w(e){return v(e)&&("[object Error]"===A(e)||e instanceof Error)}function x(e){return"function"==typeof e}function A(e){return Object.prototype.toString.call(e)}function C(e){return e<10?"0"+e.toString(10):e.toString(10)}nn.debuglog=function(t){if(m(r)&&(r=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(r)){var n=e.pid;a[t]=function(){var e=nn.format.apply(nn,arguments);console.error("%s %d: %s",t,n,e)}}else a[t]=function(){};return a[t]},nn.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},nn.isArray=c,nn.isBoolean=h,nn.isNull=p,nn.isNullOrUndefined=function(e){return null==e},nn.isNumber=d,nn.isString=g,nn.isSymbol=function(e){return"symbol"==typeof e},nn.isUndefined=m,nn.isRegExp=y,nn.isObject=v,nn.isDate=b,nn.isError=w,nn.isFunction=x,nn.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},nn.isBuffer=Wt;var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _(e,t){return Object.prototype.hasOwnProperty.call(e,t)}nn.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(":"),[e.getDate(),O[e.getMonth()],t].join(" ")),nn.format.apply(nn,arguments))},nn.inherits=Nt,nn._extend=function(e,t){if(!t||!v(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,Mt,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var rn={};(function(e){function t(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,a=0,i=Math.min(n,r);a<i;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0}function n(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var r=Object.prototype.hasOwnProperty,a=Array.prototype.slice,i="foo"===function(){}.name;function o(e){return Object.prototype.toString.call(e)}function s(t){return!n(t)&&"function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var f=rn=d,u=/\s*function\s+([^\(\s]*)\s*/;function l(e){if(nn.isFunction(e)){if(i)return e.name;var t=e.toString().match(u);return t&&t[1]}}function c(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function h(e){if(i||!nn.isFunction(e))return nn.inspect(e);var t=l(e);return"[Function"+(t?": "+t:"")+"]"}function p(e,t,n,r,a){throw new f.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:a})}function d(e,t){e||p(e,!0,t,"==",f.ok)}function g(e,r,i,f){if(e===r)return!0;if(n(e)&&n(r))return 0===t(e,r);if(nn.isDate(e)&&nn.isDate(r))return e.getTime()===r.getTime();if(nn.isRegExp(e)&&nn.isRegExp(r))return e.source===r.source&&e.global===r.global&&e.multiline===r.multiline&&e.lastIndex===r.lastIndex&&e.ignoreCase===r.ignoreCase;if(null!==e&&"object"==typeof e||null!==r&&"object"==typeof r){if(s(e)&&s(r)&&o(e)===o(r)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===t(new Uint8Array(e.buffer),new Uint8Array(r.buffer));if(n(e)!==n(r))return!1;var u=(f=f||{actual:[],expected:[]}).actual.indexOf(e);return-1!==u&&u===f.expected.indexOf(r)||(f.actual.push(e),f.expected.push(r),function(e,t,n,r){if(null==e||null==t)return!1;if(nn.isPrimitive(e)||nn.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=m(e),o=m(t);if(i&&!o||!i&&o)return!1;if(i)return g(e=a.call(e),t=a.call(t),n);var s,f,u=b(e),l=b(t);if(u.length!==l.length)return!1;for(u.sort(),l.sort(),f=u.length-1;f>=0;f--)if(u[f]!==l[f])return!1;for(f=u.length-1;f>=0;f--)if(!g(e[s=u[f]],t[s],n,r))return!1;return!0}(e,r,i,f))}return i?e===r:e==r}function m(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function y(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function v(e,t,n,r){var a;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),a=function(e){var t;try{e()}catch(e){t=e}return t}(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!a&&p(a,n,"Missing expected exception"+r);var i="string"==typeof r,o=!e&&a&&!n;if((!e&&nn.isError(a)&&i&&y(a,n)||o)&&p(a,n,"Got unwanted exception"+r),e&&a&&n&&!y(a,n)||!e&&a)throw a}f.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return c(h(e.actual),128)+" "+e.operator+" "+c(h(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||p;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,a=l(t),i=r.indexOf("\n"+a);if(i>=0){var o=r.indexOf("\n",i+1);r=r.substring(o+1)}this.stack=r}}},nn.inherits(f.AssertionError,Error),f.fail=p,f.ok=d,f.equal=function(e,t,n){e!=t&&p(e,t,n,"==",f.equal)},f.notEqual=function(e,t,n){e==t&&p(e,t,n,"!=",f.notEqual)},f.deepEqual=function(e,t,n){g(e,t,!1)||p(e,t,n,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(e,t,n){g(e,t,!0)||p(e,t,n,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(e,t,n){g(e,t,!1)&&p(e,t,n,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function e(t,n,r){g(t,n,!0)&&p(t,n,r,"notDeepStrictEqual",e)},f.strictEqual=function(e,t,n){e!==t&&p(e,t,n,"===",f.strictEqual)},f.notStrictEqual=function(e,t,n){e===t&&p(e,t,n,"!==",f.notStrictEqual)},f.throws=function(e,t,n){v(!0,e,t,n)},f.doesNotThrow=function(e,t,n){v(!1,e,t,n)},f.ifError=function(e){if(e)throw e};var b=Object.keys||function(e){var t=[];for(var n in e)r.call(e,n)&&t.push(n);return t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});class an{constructor(e,t={type:"real",radix:4}){rn(an.isPowerOf2(e)),this.real="real"===t.type,this.real||rn("complex"===t.type),this.size=e,this.ip=new Int16Array(2+Math.sqrt(e)),this.w=new Float64Array(e/2),this.internal=new Float64Array(e),Pt.makewt(e/4,this.ip.buffer,this.w.buffer),this.real?(Pt.makect(e/4,this.ip.buffer,this.w.buffer,e/4),this.fft=this.fftReal,this.ifft=this.ifftReal,this.fftInPlace=this.fftInPlaceReal,this.ifftInPlace=this.ifftInPlaceReal):(this.fft=this.fftComplex,this.ifft=this.ifftComplex,this.fftInPlace=this.fftInPlaceComplex,this.ifftInPlace=this.ifftInPlaceComplex)}static vectorSize(e){return rn(an.isPowerOf2(e)),e/2+1}static scalarSize(e){const t=2*(e-1);return rn(an.isPowerOf2(t)),t}static isPowerOf2(e){return"number"==typeof e&&e&&0==(e&e-1)}getScalarSize(){return this.size}getVectorSize(){return an.vectorSize(this.size)}scalarArrayFactory(){return new Float64Array(this.getScalarSize())}vectorArrayFactory(){return new Float64Array(this.getVectorSize())}fftReal(e,t,n){const r=new Float64Array(e);this.internal.set(r),Lt.rdft(this.size,Lt.DIRECTION.FORWARDS,this.internal.buffer,this.ip.buffer,this.w.buffer);const a=new Float64Array(n),i=new Float64Array(t);let o=0,s=0;for(;o!==this.size;)i[o]=this.internal[s++],a[o++]=-this.internal[s++];i[this.size/2]=-a[0],a[0]=0,a[this.size/2]=0}ifftReal(e,t,n){const r=new Float64Array(n),a=new Float64Array(t);let i=0,o=0;for(;i!==this.size;)this.internal[o++]=a[i],this.internal[o++]=-r[i++];this.internal[1]=a[this.size/2],Lt.rdft(this.size,Lt.DIRECTION.BACKWARDS,this.internal.buffer,this.ip.buffer,this.w.buffer),new Float64Array(e).set(this.internal.map(e=>2*e/this.size))}xfftComplex(e,t,n,r,a){const i=new Float64Array(t),o=new Float64Array(n),s=new Float64Array(r),f=new Float64Array(a);let u=0,l=0;for(;u!==this.size;)this.internal[l++]=i[u],this.internal[l++]=-o[u++];for(Lt.cdft(this.size,e,this.internal.buffer,this.ip.buffer,this.w.buffer),u=0,l=0;u!==this.size;)s[u]=this.internal[l++],f[u++]=-this.internal[l++]}fftComplex(e,t,n,r){this.xfftComplex(Lt.DIRECTION.FORWARDS,e,t,n,r)}ifftComplex(e,t,n,r){this.xfftComplex(Lt.DIRECTION.BACKWARDS,e,t,n,r);const a=new Float64Array(n),i=new Float64Array(r);for(let e=0;e<this.size/2;++e)a[e]=2*a[e]/this.size,i[e]=2*i[e]/this.size}fftInPlaceReal(e){Lt.rdft(this.size,Lt.DIRECTION.FORWARDS,e,this.ip.buffer,this.w.buffer)}fftInPlaceComplex(e){Lt.cdft(this.size,Lt.DIRECTION.FORWARDS,e,this.ip.buffer,this.w.buffer)}ifftInPlaceReal(e){Lt.rdft(this.size,Lt.DIRECTION.BACKWARDS,e,this.ip.buffer,this.w.buffer)}ifftInPlaceComplex(e){Lt.cdft(this.size,Lt.DIRECTION.BACKWARDS,e,this.ip.buffer,this.w.buffer)}}var on=an,sn={};(function(e){(function(){var t,n,r,a,i,o;"undefined"!=typeof performance&&null!==performance&&performance.now?sn=function(){return performance.now()}:null!=e&&e.hrtime?(sn=function(){return(t()-i)/1e6},n=e.hrtime,a=(t=function(){var e;return 1e9*(e=n())[0]+e[1]})(),o=1e9*e.uptime(),i=a-o):Date.now?(sn=function(){return Date.now()-r},r=Date.now()):(sn=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)}).call(this,Mt);var fn={};(function(e){for(var t="undefined"==typeof window?e:window,n=["moz","webkit"],r="AnimationFrame",a=t["request"+r],i=t["cancel"+r]||t["cancelRequest"+r],o=0;!a&&o<n.length;o++)a=t[n[o]+"Request"+r],i=t[n[o]+"Cancel"+r]||t[n[o]+"CancelRequest"+r];if(!a||!i){var s=0,f=0,u=[];a=function(e){if(0===u.length){var t=sn(),n=Math.max(0,1e3/60-(t-s));s=n+t,setTimeout(function(){var e=u.slice(0);u.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(s)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return u.push({handle:++f,callback:e,cancelled:!1}),f},i=function(e){for(var t=0;t<u.length;t++)u[t].handle===e&&(u[t].cancelled=!0)}}(fn=function(e){return a.call(t,e)}).cancel=function(){i.apply(t,arguments)},fn.polyfill=function(e){e||(e=t),e.requestAnimationFrame=a,e.cancelAnimationFrame=i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var un={},ln=function(e){if("undefined"==typeof window)return null;var t=window.OfflineAudioContext||window.webkitOfflineAudioContext,n=window.AudioContext||window.webkitAudioContext;if(!n)return null;"number"==typeof e&&(e={sampleRate:e});var r=e&&e.sampleRate;if(e&&e.offline)return t?new t(e.channels||2,e.length,r||44100):null;var a=un[r];if(a)return a;try{a=new n(e)}catch(e){a=new n}return un[a.sampleRate]=un[r]=a,a},cn={};function hn(e,t){if(!(this instanceof hn))return new hn(e,t);if(t||(e=(t=e)&&t.context),t||(t={}),void 0===e&&(e=ln()),null==t.numberOfChannels&&(t.numberOfChannels=1),null==t.sampleRate&&(t.sampleRate=e&&e.sampleRate||this.sampleRate),null==t.length&&(null!=t.duration?t.length=t.duration*t.sampleRate:t.length=1),e&&e.createBuffer)return e.createBuffer(t.numberOfChannels,Math.ceil(t.length),t.sampleRate);this.length=Math.ceil(t.length),this.numberOfChannels=t.numberOfChannels,this.sampleRate=t.sampleRate,this.duration=this.length/this.sampleRate,this._data=new Float32Array(this.length*this.numberOfChannels),this._channelData=[];for(var n=0;n<this.numberOfChannels;n++)this._channelData.push(this._data.subarray(n*this.length,(n+1)*this.length))}cn=hn,hn.prototype.numberOfChannels=1,hn.prototype.sampleRate=44100,hn.prototype.getChannelData=function(e){if(e>=this.numberOfChannels||e<0||null==e)throw Error("Cannot getChannelData: channel number ("+e+") exceeds number of channels ("+this.numberOfChannels+")");return this._channelData[e]},hn.prototype.copyFromChannel=function(e,t,n){null==n&&(n=0);for(var r=this._channelData[t],a=n,i=0;a<this.length&&i<e.length;a++,i++)e[i]=r[a]},hn.prototype.copyToChannel=function(e,t,n){var r=this._channelData[t];n||(n=0);for(var a=n,i=0;a<this.length&&i<e.length;a++,i++)r[a]=e[i]};var pn=function(e){return null!=e&&"number"==typeof e.length&&"number"==typeof e.sampleRate&&"function"==typeof e.getChannelData&&"number"==typeof e.duration};function dn(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var gn=function(e){return null!=e&&(dn(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&dn(e.slice(0,0))}(e)||!!e._isBuffer)},mn={8000:8e3,11025:11025,16000:16e3,22050:22050,44100:44100,48000:48e3,88200:88200,96000:96e3,176400:176400,192000:192e3,352800:352800,384000:384e3},yn={endianness:function(){return"LE"},hostname:function(){return"undefined"!=typeof location?location.hostname:""},loadavg:function(){return[]},uptime:function(){return 0},freemem:function(){return Number.MAX_VALUE},totalmem:function(){return Number.MAX_VALUE},cpus:function(){return[]},type:function(){return"Browser"},release:function(){return"undefined"!=typeof navigator?navigator.appVersion:""}};yn.networkInterfaces=yn.getNetworkInterfaces=function(){return{}},yn.arch=function(){return"javascript"},yn.platform=function(){return"browser"},yn.tmpdir=yn.tmpDir=function(){return"/tmp"},yn.EOL="\n",yn.homedir=function(){return"/"};for(var vn={parse:_n,stringify:function(e,t){t=void 0===t?{endianness:"le"}:null==t?{}:"string"==typeof t?_n(t):Sn(t),U(e)||(e=Sn(e));var n=[];return null!=e.type&&e.type!==t.type&&n.push(e.type||"float32"),null!=e.channels&&e.channels!==t.channels&&n.push(Cn[e.channels]),null!=e.endianness&&e.endianness!==t.endianness&&n.push(e.endianness||"le"),null!=e.interleaved&&e.interleaved!==t.interleaved&&"audiobuffer"!==e.type&&n.push(e.interleaved?"interleaved":"planar"),null!=e.sampleRate&&e.sampleRate!==t.sampleRate&&n.push(e.sampleRate),n.join(" ")},detect:Sn,type:kn},bn=yn.endianness instanceof Function?yn.endianness().toLowerCase():"le",wn={uint:"uint32",uint8:"uint8",uint8_clamped:"uint8",uint16:"uint16",uint32:"uint32",int:"int32",int8:"int8",int16:"int16",int32:"int32",float:"float32",float32:"float32",float64:"float64",array:"array",arraybuffer:"arraybuffer",buffer:"buffer",audiobuffer:"audiobuffer",ndarray:"ndarray",ndsamples:"ndsamples"},xn={mono:1,stereo:2,quad:4,5.1:6,2.1:3,"3-channel":3,"5-channel":5},An=6;An<32;An++)xn[An+"-channel"]=An;var Cn={};for(var On in xn)Cn[xn[On]]=On;function _n(e){for(var t={},n=e.split(/\s*[,;_]\s*|\s+/),r=0;r<n.length;r++){var a=n[r].toLowerCase();if("planar"===a&&null==t.interleaved)t.interleaved=!1,null==t.channels&&(t.channels=2);else if("interleave"!==a&&"interleaved"!==a||null!=t.interleaved)if(xn[a])t.channels=xn[a];else if("le"===a||"LE"===a||"littleendian"===a||"bigEndian"===a)t.endianness="le";else if("be"===a||"BE"===a||"bigendian"===a||"bigEndian"===a)t.endianness="be";else if(wn[a])t.type=wn[a],"audiobuffer"===a&&(t.endianness=bn,t.interleaved=!1);else if(mn[a])t.sampleRate=mn[a];else{if(!/^\d+$/.test(a))throw Error("Cannot identify part `"+a+"`");t.sampleRate=parseInt(a)}else t.interleaved=!0,null==t.channels&&(t.channels=2)}return t}function Sn(e){if(!e)return{};var t=Z(e,{channels:"channel channels numberOfChannels channelCount",sampleRate:"sampleRate rate",interleaved:"interleave interleaved",type:"type dtype",endianness:"endianness"});if(e.format&&(t.type="ndsamples"),null==t.sampleRate&&e.format&&e.format.sampleRate&&(t.sampleRate=e.format.sampleRate),e.planar&&(t.interleaved=!1),null!=t.interleaved&&null==t.channels&&(t.channels=2),null==t.type){var n=kn(e);n&&(t.type=n)}return"audiobuffer"===t.type&&(t.endianness=bn,t.interleaved=!1),t}function kn(e){return pn(e)?"audiobuffer":gn(e)?"buffer":Array.isArray(e)?"array":e instanceof ArrayBuffer?"arraybuffer":e.shape&&e.dtype?e.format?"ndsamples":"ndarray":e instanceof Float32Array?"float32":e instanceof Float64Array?"float64":e instanceof Uint8Array?"uint8":e instanceof Uint8ClampedArray?"uint8_clamped":e instanceof Int8Array?"int8":e instanceof Int16Array?"int16":e instanceof Uint16Array?"uint16":e instanceof Int32Array?"int32":e instanceof Uint32Array?"uint32":void 0}function En(e){return"string"==typeof e?vn.parse(e):vn.detect(e)}function Tn(e){return"string"!=typeof e&&(Array.isArray(e)||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)}var Dn=function(e,t,n,r){if(rn(e,"First argument should be data"),rn(t,"Second argument should be format string or object"),t===n)return e;if(Tn(t))r=t,n=vn.detect(r),t=vn.detect(e);else if(void 0===n&&void 0===r)n=En(t),t=vn.detect(e);else if(Tn(n))r=n,n=En(t),t=vn.detect(e);else{var a=En(t),i=vn.detect(e);i.dtype="arraybuffer"===a.type?i.type:a.type,t=fe(a,i);var o=En(n),s=vn.detect(r);o.type&&(s.dtype="arraybuffer"===o.type?s.type||t.dtype:o.type),n=fe(o,s)}if(null==n.channels&&null!=t.channels&&(n.channels=t.channels),null==n.type&&(n.type=t.type,n.dtype=t.dtype),null!=n.interleaved&&null==t.channels&&(t.channels=2),t.type===n.type&&t.interleaved===n.interleaved&&t.endianness===n.endianness)return e;var f;if(jn(t),jn(n),(e.buffers||e.buffer&&e.buffer.buffers)&&(e.buffer&&(e=e.buffer),e.buffers&&(e=e.join())),pn(e))if(e._data)f=e._data;else{f=new Float32Array(e.length*e.numberOfChannels);for(var u=0,l=e.numberOfChannels;u<l;u++)f.set(e.getChannelData(u),e.length*u)}else e instanceof ArrayBuffer?f=new Rn[t.dtype](e):gn(e)?(f=null!=e.byteOffset?e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength):e.buffer,f=new Rn[t.dtype](f)):f=e;var c="array"===n.type?Array.from(f):new Rn[n.dtype](f);if(t.max!==n.max){var h=t.max-t.min,p=n.max-n.min,d=0;for(l=f.length;d<l;d++){var g=f[d];g=(g-t.min)/h*p+n.min,c[d]=Math.max(n.min,Math.min(n.max,g))}}if(t.interleaved!=n.interleaved){var m=t.channels,y=Math.floor(f.length/m);t.interleaved&&!n.interleaved?c=c.map(function(e,t,n){return n[t%y*m+~~(t/y)]}):!t.interleaved&&n.interleaved&&(c=c.map(function(e,t,n){return n[t%m*y+~~(t/m)]}))}if("array"!=n.dtype&&"int8"!=n.dtype&&"uint8"!=n.dtype&&t.endianness&&n.endianness&&t.endianness!==n.endianness){var v="le"===n.endianness,b=new DataView(c.buffer),w=c.BYTES_PER_ELEMENT,x="set"+n.dtype[0].toUpperCase()+n.dtype.slice(1);for(d=0,l=c.length;d<l;d++)b[x](d*w,c[d],v)}if(n.type,r){if(Array.isArray(r))for(d=0;d<c.length;d++)r[d]=c[d];else if(r instanceof ArrayBuffer){var A=new Rn[n.dtype](r);A.set(c),r=A}else r.set(c);c=r}return"arraybuffer"!==n.type&&"buffer"!==n.type||(c=c.buffer),c},Rn={uint8:Uint8Array,uint8_clamped:Uint8ClampedArray,uint16:Uint16Array,uint32:Uint32Array,int8:Int8Array,int16:Int16Array,int32:Int32Array,float32:Float32Array,float64:Float64Array,array:Array,arraybuffer:Uint8Array,buffer:Uint8Array},Fn={float32:"float32",audiobuffer:"float32",ndsamples:"float32",ndarray:"float32",float64:"float64",buffer:"uint8",arraybuffer:"uint8",uint8:"uint8",uint8_clamped:"uint8",uint16:"uint16",uint32:"uint32",int8:"int8",int16:"int16",int32:"int32",array:"array"};function jn(e){switch(e.dtype||(e.dtype=Fn[e.type]||"array"),e.dtype){case"float32":case"float64":case"audiobuffer":case"ndsamples":case"ndarray":e.min=-1,e.max=1;break;case"uint8":e.min=0,e.max=255;break;case"uint16":e.min=0,e.max=65535;break;case"uint32":e.min=0,e.max=4294967295;break;case"int8":e.min=-128,e.max=127;break;case"int16":e.min=-32768,e.max=32767;break;case"int32":e.min=-2147483648,e.max=2147483647;break;default:e.min=-1,e.max=1}return e}var Bn=function(e){return atob(e)},In={exports:{}};function Pn(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t.buffer}!function(e){function t(e,t){if(e instanceof Boolean||"boolean"==typeof e)return!1;if(t instanceof Object||(t={}),t.hasOwnProperty("allowBlank")&&!t.allowBlank&&""===e)return!1;var n="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+/]{3}=)?";return t.mime&&(n="(data:\\w+\\/[a-zA-Z\\+\\-\\.]+;base64,)?"+n),!1===t.paddingRequired&&(n="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}(==)?|[A-Za-z0-9+\\/]{3}=?)?"),new RegExp("^"+n+"$","gi").test(e)}void 0!==In.exports?(In.exports&&(In.exports=In.exports=t),In.exports.isBase64=t):"function"==typeof define&&define.amd?define([],function(){return t}):e.isBase64=t}(this),In=In.exports;var Ln=function(e){if("string"!=typeof e)throw Error("Argument should be a string");return/^data\:/i.test(e)?function(e){var t=(e=e.replace(/\r?\n/g,"")).indexOf(",");if(-1===t||t<=4)throw new TypeError("malformed data-URI");for(var n=e.substring(5,t).split(";"),r=!1,a="US-ASCII",i=0;i<n.length;i++)"base64"==n[i]?r=!0:0==n[i].indexOf("charset=")&&(a=n[i].substring(8));var o=unescape(e.substring(t+1));r&&(o=Bn(o));var s=Pn(o);return s.type=n[0]||"text/plain",s.charset=a,s}(e):(In(e)&&(e=Bn(e)),Pn(e))};function zn(e){return"string"==typeof e?vn.parse(e):vn.detect(e)}var Nn=function e(t,n){var r,a,i,o,s,f,u;if("number"==typeof n?n={channels:n}:"string"==typeof n?n={format:n}:void 0===n&&(U(t)?(n=t,t=void 0):n={}),i=(n=Z(n,{format:"format type dtype dataType",channels:"channel channels numberOfChannels channelCount",sampleRate:"sampleRate rate",length:"length size",duration:"duration time"})).channels,o=n.sampleRate,n.format&&(s=zn(n.format)),s&&(i&&!s.channels?s.channels=i:s.channels&&!i&&(i=s.channels),!o&&s.sampleRate&&(o=s.sampleRate)),null==t)null!=n.duration?(o||(o=44100),r=o*n.duration):r=n.length;else if(pn(t))if(r=t.length,null==i&&(i=t.numberOfChannels),null==o&&(o=t.sampleRate),t._channelData)a=t._channelData.slice(0,i);else for(a=[],f=0,u=i;f<u;f++)a[f]=t.getChannelData(f);else if("number"==typeof t)r=t;else if(Array.isArray(t)&&(Array.isArray(t[0])||ArrayBuffer.isView(t[0])))for(r=t[0].length,a=[],i||(i=t.length),f=0;f<i;f++)a[f]=t[f]instanceof Float32Array?t[f]:new Float32Array(t[f]);else{if(t.shape&&t.data)return t.shape&&(i=t.shape[1]),!o&&t.format&&(o=t.format.sampleRate),e(t.data,{channels:i,sampleRate:o});for("string"==typeof t&&(t=Ln(t)),s||(s=zn(t)),i||(i=s.channels||1),t=Dn(t,s,"float32 planar"),r=Math.floor(t.length/i),a=[],f=0;f<i;f++)a[f]=t.subarray(f*r,(f+1)*r)}var l=new cn(null===n.context||0===r?null:n.context||ln(),{length:null==r?1:r,numberOfChannels:i||1,sampleRate:o||44100});if(a)for(f=0,u=a.length;f<u;f++)l.getChannelData(f).set(a[f]);return l},Mn=ln(),Un={context:Mn,create:qn,copy:Wn,shallow:Vn,clone:function(e){return Wn(e,Vn(e))},reverse:function(e,t,n,r){Hn(e),pn(t)||null==t||(r=n,n=t,t=null),t?(Hn(t),Wn(e,t)):t=e,n=null==n?0:ae(n,e.length),r=null==r?e.length:ae(r,e.length);for(var a=0,i=t.numberOfChannels;a<i;++a)t.getChannelData(a).subarray(n,r).reverse();return t},invert:function(e,t,n,r){return pn(t)||null==t||(r=n,n=t,t=null),Yn(e,t,function(e){return-e},n,r)},zero:function(e,t,n,r){return Yn(e,t,0,n,r)},noise:function(e,t,n,r){return Yn(e,t,function(e){return 2*Math.random()-1},n,r)},equal:function e(t,n){if(arguments.length>2){for(var r=0,a=arguments.length-1;r<a;r++)if(!e(arguments[r],arguments[r+1]))return!1;return!0}if(Hn(t),Hn(n),t.length!==n.length||t.numberOfChannels!==n.numberOfChannels)return!1;for(var i=0;i<t.numberOfChannels;i++){var o=t.getChannelData(i),s=n.getChannelData(i);for(r=0;r<o.length;r++)if(o[r]!==s[r])return!1}return!0},fill:Yn,slice:$n,concat:Qn,resize:function(e,t){return Hn(e),t<e.length?$n(e,0,t):Qn(e,qn(t-e.length,e.numberOfChannels))},pad:Gn,padLeft:function(e,t,n){return Gn(t,e,n)},padRight:function(e,t,n){return Gn(e,t,n)},rotate:function(e,t){Hn(e);for(var n=0;n<e.numberOfChannels;n++)for(var r=e.getChannelData(n),a=r.slice(),i=0,o=r.length;i<o;i++)r[(t+(t+i<0?o+i:i))%o]=a[i];return e},shift:function(e,t){Hn(e);for(var n=0;n<e.numberOfChannels;n++){var r=e.getChannelData(n);if(t>0)for(var a=r.length-t;a--;)r[a+t]=r[a];else{a=-t;for(var i=r.length-t;a<i;a++)r[a+t]=r[a]||0}}return e},normalize:function(e,t,n,r){pn(t)||(r=n,n=t,t=null),n=null==n?0:ae(n,e.length),r=null==r?e.length:ae(r,e.length);for(var a=0,i=0;i<e.numberOfChannels;i++)for(var o=e.getChannelData(i),s=n;s<r;s++)a=Math.max(Math.abs(o[s]),a);var f=Math.max(1/a,1);return Yn(e,t,function(e,t,n){return V(e*f,-1,1)},n,r)},removeStatic:function(e,t,n,r){var a=function(e,t,n){if(Hn(e),t=null==t?0:ae(t,e.length),(n=null==n?e.length:ae(n,e.length))-t<1)return[];for(var r=[],a=0;a<e.numberOfChannels;a++){for(var i=0,o=e.getChannelData(a),s=t;s<n;s++)i+=o[s];r.push(i/(n-t))}return r}(e,n,r);return Yn(e,t,function(e,t,n){return e-a[n]},n,r)},trim:function(e,t){return Xn(e,t,!0,!0)},trimLeft:function(e,t){return Xn(e,t,!0,!1)},trimRight:function(e,t){return Xn(e,t,!1,!0)},mix:function(e,t,n,r){Hn(e),Hn(t),null==n&&(n=.5);var a=n instanceof Function?n:function(e,t){return e*(1-n)+t*n};null==r?r=0:r<0&&(r+=e.length);for(var i=0;i<e.numberOfChannels;i++)for(var o=e.getChannelData(i),s=t.getChannelData(i),f=r,u=0;f<e.length&&u<t.length;f++,u++)o[f]=a.call(e,o[f],s[u],u,i);return e},size:function(e){return Hn(e),e.numberOfChannels*e.getChannelData(0).byteLength},data:function(e,t){Hn(e),t=t||[];for(var n=0;n<e.numberOfChannels;n++)ArrayBuffer.isView(t[n])?t[n].set(e.getChannelData(n)):t[n]=e.getChannelData(n);return t},subbuffer:function(e,t,n,r){if(Hn(e),Array.isArray(t)?(r=t,t=0,n=-0):Array.isArray(n)&&(r=n,n=-0),!Array.isArray(r)){r=Array(e.numberOfChannels);for(var a=0;a<e.numberOfChannels;a++)r[a]=a}t=null==t?0:ae(t,e.length),n=null==n?e.length:ae(n,e.length);for(var i=[],o=0;o<r.length;o++){var s=r[o],f=e.getChannelData(s);i.push(f.subarray(t,n))}var u=new cn(null,{length:0,sampleRate:e.sampleRate,numberOfChannels:e.numberOfChannels});return u.length=i[0].length,u._data=null,u._channelData=i,u.duration=u.length/u.sampleRate,u},repeat:function(e,t){if(Hn(e),!t||t<0)return new cn(null,{length:0,numberOfChannels:e.numberOfChannels,sampleRate:e.sampleRate});if(1===t)return e;for(var n=[],r=0;r<t;r++)n.push(e);return Qn(n)}};Mn&&Mn.sampleRate;function qn(e,t,n){return"number"==typeof t?t={channels:t}:"string"==typeof t?t={format:t}:t||(t={}),n&&(t.sampleRate=n),t.context=Mn,Nn(e,t)}function Wn(e,t,n){Hn(e),Hn(t),n=n||0;for(var r=0,a=Math.min(e.numberOfChannels,t.numberOfChannels);r<a;r++)t.getChannelData(r).set(e.getChannelData(r),n);return t}function Hn(e){if(!pn(e))throw new Error("Argument should be an AudioBuffer instance.")}function Vn(e){return Hn(e),ne?Mn.createBuffer(e.numberOfChannels,e.length,e.sampleRate):qn(e.length,e.numberOfChannels,e.sampleRate)}function Yn(e,t,n,r,a){if(Hn(e),pn(t)||null==t||("function"==typeof n?t=null:(a=r,r=n,n=t,t=null)),t?Hn(t):t=e,r=null==r?0:ae(r,e.length),a=null==a?e.length:ae(a,e.length),n instanceof Function)for(o=0,s=e.numberOfChannels;o<s;o++){var i=e.getChannelData(o);for(f=t.getChannelData(o),u=r;u<a;u++)f[u]=n.call(e,i[u],u,o,i)}else for(var o=0,s=e.numberOfChannels;o<s;o++)for(var f=t.getChannelData(o),u=r;u<a;u++)f[u]=n;return t}function $n(e,t,n){Hn(e),t=null==t?0:ae(t,e.length),n=null==n?e.length:ae(n,e.length);for(var r=[],a=0;a<e.numberOfChannels;a++){var i=e.getChannelData(a);r.push(i.slice(t,n))}return qn(r,e.numberOfChannels,e.sampleRate)}function Qn(){for(var e=[],t=0,n=arguments.length;t<n;t++){var r=arguments[t];if(Array.isArray(r))for(var a=0;a<r.length;a++)e.push(r[a]);else e.push(r)}var i=1,o=0,s=0;for(t=0;t<e.length;t++)Hn(h=e[t]),o+=h.length,i=Math.max(h.numberOfChannels,i),s=Math.max(h.sampleRate,s);for(var f=[],u=0;u<i;u++){var l=new Float32Array(o),c=0;for(t=0;t<e.length;t++){var h;u<(h=e[t]).numberOfChannels&&l.set(h.getChannelData(u),c),c+=h.length}f.push(l)}return qn(f,i,s)}function Gn(e,t,n){var r,a;return"number"==typeof e?(r=t,a=e):(r=e,a=t),n=n||0,Hn(r),a<r.length?r:r===t?Qn(Yn(qn(a-r.length,r.numberOfChannels),n),r):Qn(r,Yn(qn(a-r.length,r.numberOfChannels),n))}function Xn(e,t,n,r){var a,i;if(Hn(e),t=null==t?0:Math.abs(t),n){a=e.length;for(var o=0,s=e.numberOfChannels;o<s;o++)for(var f=e.getChannelData(o),u=0;u<f.length&&!(u>a);u++)if(Math.abs(f[u])>t){a=u;break}}else a=0;if(r){for(i=0,o=0,s=e.numberOfChannels;o<s;o++)for(u=(f=e.getChannelData(o)).length-1;u>=0&&!(u<i);u--)if(Math.abs(f[u])>t){i=u+1;break}}else i=e.length;return $n(e,a,i)}var Zn={};function Jn(e,t){if(!(this instanceof Jn))return new Jn(e,t);U(e)&&(t=e,e=null),"number"==typeof t&&(t={channels:t}),t&&null!=t.channels&&(t.numberOfChannels=t.channels),fe(this,t),this.buffers=[],this.length=0,this.duration=0,this.append(e)}Zn=Jn,Jn.prototype.numberOfChannels=1,Jn.prototype.sampleRate=null,Jn.isInstance=function(e){return e instanceof Jn},Jn.prototype.copyFromChannel=function(e,t,n,r){null==n&&(n=0),null==r&&(r=this.length),n=ae(n,this.length),r=ae(r,this.length);var a=this.offset(n),i=n-a[1],o=n,s=this.offset(r);if(a[0]===s[0]){var f=(c=this.buffers[a[0]]).getChannelData(t).subarray(a[1],s[1]);return e.set(f),this}for(var u=a[0],l=s[0];u<l;u++){var c;f=(c=this.buffers[u]).getChannelData(t),n>i&&(f=f.subarray(n-i)),t<c.numberOfChannels&&e.set(f,Math.max(0,-o+i)),i+=c.length}var h=this.buffers[s[0]];return s[1]&&e.set(h.getChannelData(t).subarray(0,s[1]),Math.max(0,i-o)),this},Jn.prototype.copyToChannel=function(e,t,n){null==n&&(n=0),n=ae(n,this.length);var r=this.offset(n),a=n-r[1];e=e.subarray(0,this.length-n);for(var i=r[0],o=this.buffers.length;i<o;i++){var s=this.buffers[i],f=s.getChannelData(t);if(t<s.numberOfChannels){var u=e.subarray(Math.max(0,a-n),a-n+s.length);f.set(u,n>a?n:0)}a+=s.length}return this},Jn.prototype.append=function(e){var t=0;if(e instanceof Jn)this.append(e.buffers);else if(pn(e)&&e.length)this._appendBuffer(e);else if(Array.isArray(e)&&"number"!=typeof e[0])for(var n=e.length;t<n;t++)this.append(e[t]);else e&&(e=Un.create(e,this.numberOfChannels,this.sampleRate),this._appendBuffer(e));return this},Jn.prototype.offset=function(e){var t,n=0,r=0;if(0===e)return[0,0];for(;r<this.buffers.length;r++){if(e<(t=n+this.buffers[r].length)||r==this.buffers.length-1)return[r,e-n];n=t}},Jn.prototype._appendBuffer=function(e){return e?(this.buffers.length?this.numberOfChannels=Math.max(this.numberOfChannels,e.numberOfChannels):this.numberOfChannels=e.numberOfChannels,this.duration+=e.duration,this.sampleRate||(this.sampleRate=e.sampleRate),this.buffers.push(e),this.length+=e.length,this):this},Jn.prototype.copy=function(e,t,n,r){if("number"==typeof e&&(r=n,n=t,t=e,e=null),null==r&&null!=n&&(r=n,n=t,t=0),("number"!=typeof n||n<0)&&(n=0),("number"!=typeof r||r>this.length)&&(r=this.length),n>=this.length)return e||new cn(null,{length:0});if(r<=0)return e||new cn(null,{length:0});var a,i,o=!!e,s=this.offset(n),f=r-n,u=f,l=o&&t||0,c=s[1];if(0===n&&r==this.length){if(!o)return 1===this.buffers.length?Un.slice(this.buffers[0]):Un.concat(this.buffers);for(i=0;i<this.buffers.length;i++)Un.copy(this.buffers[i],e,l),l+=this.buffers[i].length;return e}if(u<=this.buffers[s[0]].length-c)return o?Un.copy(Un.subbuffer(this.buffers[s[0]],c,c+u),e,t):Un.slice(this.buffers[s[0]],c,c+u);for(o||(e=Un.create(f,this.numberOfChannels)),i=s[0];i<this.buffers.length;i++){if(!(u>(a=this.buffers[i].length-c))){Un.copy(Un.subbuffer(this.buffers[i],c,c+u),e,l);break}Un.copy(Un.subbuffer(this.buffers[i],c),e,l),l+=a,u-=a,c&&(c=0)}return e},Jn.prototype.slice=function(e,t){if(e=e||0,t=null==t?this.length:t,(e=ae(e,this.length))==(t=ae(t,this.length)))return new Jn(0,this.numberOfChannels);var n=this.offset(e),r=this.offset(t),a=this.buffers.slice(n[0],r[0]+1);return 0==r[1]?a.pop():a[a.length-1]=Un.subbuffer(a[a.length-1],0,r[1]),0!=n[1]&&(a[0]=Un.subbuffer(a[0],n[1])),new Jn(a,this.numberOfChannels)},Jn.prototype.clone=function(e,t){for(var n=0,r=new Jn(0,this.numberOfChannels),a=this.slice(e,t);n<a.buffers.length;n++)r.append(Un.clone(a.buffers[n]));return r},Jn.prototype.destroy=function(){this.buffers.length=0,this.length=0,this.buffers=null},Jn.prototype.repeat=function(e){if(!(e=Math.floor(e))&&0!==e||!Number.isFinite(e))throw RangeError("Repeat count must be non-negative number.");if(!e)return this.consume(this.length),this;if(1===e)return this;for(var t=this,n=1;n<e;n++)t=new Jn(t.copy()),this.append(t);return this},Jn.prototype.insert=function(e,t){return null==t&&(t=e,e=0),e=ae(e,this.length),this.split(e),e=this.offset(e),t=new Jn(t),this.buffers.splice.apply(this.buffers,[e[0],0].concat(t.buffers)),this.length+=t.length,this.duration+=t.duration,this.numberOfChannels=Math.max(t.numberOfChannels,this.numberOfChannels),this},Jn.prototype.remove=function(e,t){if(!this.length)return null;if(null==t&&(t=e,e=0),!t)return this;t<0&&(e-=t=-t),e=ae(e,this.length),t=Math.min(this.length-e,t),this.split(e,e+t);var n=this.offset(e),r=this.offset(e+t);r[1]===this.buffers[r[0]].length&&(r[0]+=1);let a=this.buffers.splice(n[0],r[0]-n[0]);return a=new Jn(a,this.numberOfChannels),this.length-=a.length,this.duration=this.length/this.sampleRate,a},Jn.prototype.delete=function(){return this.remove.apply(this,arguments),this},Jn.prototype.consume=function(e){for(;this.buffers.length;){if(!(e>=this.buffers[0].length)){this.buffers[0]=Un.subbuffer(this.buffers[0],e),this.length-=e;break}e-=this.buffers[0].length,this.length-=this.buffers[0].length,this.buffers.shift()}return this.duration=this.length/this.sampleRate,this},Jn.prototype.map=function(e,t,n){let r=arguments[arguments.length-1];U(r)||(r={reversed:!1}),"number"!=typeof t&&(t=0),"number"!=typeof n&&(n=this.length),t=ae(t,this.length),n=ae(n,this.length),this.split(t,n);let a=this.offset(t),i=this.offset(n);if(r.reversed){let t=n-i[1];for(let n=i[0],r=a[0];n>=r;n--){let r=this.buffers[n],a=e.call(this,r,n,t,this.buffers,this);if(!1===a)break;void 0!==a&&(this.buffers[n]=a),t-=r.length}}else{i[1]&&(i[0]+=1,i[1]=0);let n=t-a[1];for(let t=a[0],r=i[0];t<r;t++){let r=this.buffers[t],a=e.call(this,r,t,n,this.buffers,this);if(!1===a)break;void 0!==a&&(this.buffers[t]=a),n+=r.length}}this.buffers=this.buffers.filter(e=>!!e&&!!e.length);let o=0;for(let e=0;e<this.buffers.length;e++)this.numberOfChannels=Math.max(this.buffers[e].numberOfChannels,this.numberOfChannels),o+=this.buffers[e].length;return this.length=o,this.duration=this.length/this.sampleRate,this},Jn.prototype.split=function(){let e=arguments;for(let t=0;t<e.length;t++){let n=e[t];if(Array.isArray(n))this.split.apply(this,n);else if("number"==typeof n){let e=this.offset(n),t=this.buffers[e[0]];if(e[1]>0&&e[1]<t.length){let n=Un.subbuffer(t,0,e[1]),r=Un.subbuffer(t,e[1]);this.buffers.splice(e[0],1,n,r)}}}return this},Jn.prototype.join=function(e,t){null==e&&(e=0),null==t&&(t=this.length),e=ae(e,this.length),t=ae(t,this.length);let n=this.offset(e),r=this.offset(t);r[1]&&(r[0]+=1,r[1]=0);let a=this.buffers.slice(n[0],r[0]),i=Un.concat(a);return this.buffers.splice.apply(this.buffers,[n[0],r[0]-n[0]+(r[1]?1:0)].concat(i)),i};var Kn=ln(),er={context:Kn,create:tr,copy:nr,shallow:ar,clone:function(e){return nr(e,ar(e))},reverse:function(e,t,n,r){rr(e),pn(t)||null==t||(r=n,n=t,t=null),t?(rr(t),nr(e,t)):t=e,n=null==n?0:ae(n,e.length),r=null==r?e.length:ae(r,e.length);for(var a=0,i=t.numberOfChannels;a<i;++a)t.getChannelData(a).subarray(n,r).reverse();return t},invert:function(e,t,n,r){return pn(t)||null==t||(r=n,n=t,t=null),ir(e,t,function(e){return-e},n,r)},zero:function(e,t,n,r){return ir(e,t,0,n,r)},noise:function(e,t,n,r){return ir(e,t,function(e){return 2*Math.random()-1},n,r)},equal:function e(t,n){if(arguments.length>2){for(var r=0,a=arguments.length-1;r<a;r++)if(!e(arguments[r],arguments[r+1]))return!1;return!0}if(rr(t),rr(n),t.length!==n.length||t.numberOfChannels!==n.numberOfChannels)return!1;for(var i=0;i<t.numberOfChannels;i++){var o=t.getChannelData(i),s=n.getChannelData(i);for(r=0;r<o.length;r++)if(o[r]!==s[r])return!1}return!0},fill:ir,slice:or,concat:sr,resize:function(e,t){return rr(e),t<e.length?or(e,0,t):sr(e,tr(t-e.length,e.numberOfChannels))},pad:fr,padLeft:function(e,t,n){return fr(t,e,n)},padRight:function(e,t,n){return fr(e,t,n)},rotate:function(e,t){rr(e);for(var n=0;n<e.numberOfChannels;n++)for(var r=e.getChannelData(n),a=r.slice(),i=0,o=r.length;i<o;i++)r[(t+(t+i<0?o+i:i))%o]=a[i];return e},shift:function(e,t){rr(e);for(var n=0;n<e.numberOfChannels;n++){var r=e.getChannelData(n);if(t>0)for(var a=r.length-t;a--;)r[a+t]=r[a];else{a=-t;for(var i=r.length-t;a<i;a++)r[a+t]=r[a]||0}}return e},normalize:function(e,t,n,r){pn(t)||(r=n,n=t,t=null),n=null==n?0:ae(n,e.length),r=null==r?e.length:ae(r,e.length);for(var a=0,i=0;i<e.numberOfChannels;i++)for(var o=e.getChannelData(i),s=n;s<r;s++)a=Math.max(Math.abs(o[s]),a);var f=Math.max(1/a,1);return ir(e,t,function(e,t,n){return V(e*f,-1,1)},n,r)},removeStatic:function(e,t,n,r){var a=function(e,t,n){if(rr(e),t=null==t?0:ae(t,e.length),(n=null==n?e.length:ae(n,e.length))-t<1)return[];for(var r=[],a=0;a<e.numberOfChannels;a++){for(var i=0,o=e.getChannelData(a),s=t;s<n;s++)i+=o[s];r.push(i/(n-t))}return r}(e,n,r);return ir(e,t,function(e,t,n){return e-a[n]},n,r)},trim:function(e,t){return ur(e,t,!0,!0)},trimLeft:function(e,t){return ur(e,t,!0,!1)},trimRight:function(e,t){return ur(e,t,!1,!0)},mix:function(e,t,n,r){rr(e),rr(t),null==n&&(n=.5);var a=n instanceof Function?n:function(e,t){return e*(1-n)+t*n};null==r?r=0:r<0&&(r+=e.length);for(var i=0;i<e.numberOfChannels;i++)for(var o=e.getChannelData(i),s=t.getChannelData(i),f=r,u=0;f<e.length&&u<t.length;f++,u++)o[f]=a.call(e,o[f],s[u],u,i);return e},size:function(e){return rr(e),e.numberOfChannels*e.getChannelData(0).byteLength},data:function(e,t){rr(e),t=t||[];for(var n=0;n<e.numberOfChannels;n++)ArrayBuffer.isView(t[n])?t[n].set(e.getChannelData(n)):t[n]=e.getChannelData(n);return t},subbuffer:function(e,t,n,r){if(rr(e),Array.isArray(t)?(r=t,t=0,n=-0):Array.isArray(n)&&(r=n,n=-0),!Array.isArray(r)){r=Array(e.numberOfChannels);for(var a=0;a<e.numberOfChannels;a++)r[a]=a}t=null==t?0:ae(t,e.length),n=null==n?e.length:ae(n,e.length);for(var i=[],o=0;o<r.length;o++){var s=r[o],f=e.getChannelData(s);i.push(f.subarray(t,n))}var u=new cn(null,{length:0,sampleRate:e.sampleRate,numberOfChannels:e.numberOfChannels});return u.length=i[0].length,u._data=null,u._channelData=i,u.duration=u.length/u.sampleRate,u},repeat:function(e,t){if(rr(e),!t||t<0)return new cn(null,{length:0,numberOfChannels:e.numberOfChannels,sampleRate:e.sampleRate});if(1===t)return e;for(var n=[],r=0;r<t;r++)n.push(e);return sr(n)}};Kn&&Kn.sampleRate;function tr(e,t,n){return"number"==typeof t?t={channels:t}:"string"==typeof t?t={format:t}:t||(t={}),n&&(t.sampleRate=n),t.context=Kn,Nn(e,t)}function nr(e,t,n){rr(e),rr(t),n=n||0;for(var r=0,a=Math.min(e.numberOfChannels,t.numberOfChannels);r<a;r++)t.getChannelData(r).set(e.getChannelData(r),n);return t}function rr(e){if(!pn(e))throw new Error("Argument should be an AudioBuffer instance.")}function ar(e){return rr(e),ne?Kn.createBuffer(e.numberOfChannels,e.length,e.sampleRate):tr(e.length,e.numberOfChannels,e.sampleRate)}function ir(e,t,n,r,a){if(rr(e),pn(t)||null==t||("function"==typeof n?t=null:(a=r,r=n,n=t,t=null)),t?rr(t):t=e,r=null==r?0:ae(r,e.length),a=null==a?e.length:ae(a,e.length),n instanceof Function)for(o=0,s=e.numberOfChannels;o<s;o++){var i=e.getChannelData(o);for(f=t.getChannelData(o),u=r;u<a;u++)f[u]=n.call(e,i[u],u,o,i)}else for(var o=0,s=e.numberOfChannels;o<s;o++)for(var f=t.getChannelData(o),u=r;u<a;u++)f[u]=n;return t}function or(e,t,n){rr(e),t=null==t?0:ae(t,e.length),n=null==n?e.length:ae(n,e.length);for(var r=[],a=0;a<e.numberOfChannels;a++){var i=e.getChannelData(a);r.push(i.slice(t,n))}return tr(r,e.numberOfChannels,e.sampleRate)}function sr(){for(var e=[],t=0,n=arguments.length;t<n;t++){var r=arguments[t];if(Array.isArray(r))for(var a=0;a<r.length;a++)e.push(r[a]);else e.push(r)}var i=1,o=0,s=0;for(t=0;t<e.length;t++)rr(h=e[t]),o+=h.length,i=Math.max(h.numberOfChannels,i),s=Math.max(h.sampleRate,s);for(var f=[],u=0;u<i;u++){var l=new Float32Array(o),c=0;for(t=0;t<e.length;t++){var h;u<(h=e[t]).numberOfChannels&&l.set(h.getChannelData(u),c),c+=h.length}f.push(l)}return tr(f,i,s)}function fr(e,t,n){var r,a;return"number"==typeof e?(r=t,a=e):(r=e,a=t),n=n||0,rr(r),a<r.length?r:r===t?sr(ir(tr(a-r.length,r.numberOfChannels),n),r):sr(r,ir(tr(a-r.length,r.numberOfChannels),n))}function ur(e,t,n,r){var a,i;if(rr(e),t=null==t?0:Math.abs(t),n){a=e.length;for(var o=0,s=e.numberOfChannels;o<s;o++)for(var f=e.getChannelData(o),u=0;u<f.length&&!(u>a);u++)if(Math.abs(f[u])>t){a=u;break}}else a=0;if(r){for(i=0,o=0,s=e.numberOfChannels;o<s;o++)for(u=(f=e.getChannelData(o)).length-1;u>=0&&!(u<i);u--)if(Math.abs(f[u])>t){i=u+1;break}}else i=e.length;return or(e,a,i)}var lr=function(e,t){if(e&&!U(e)||((t=e||{}).context||(t.context=ln()),e=t.context.destination),!e.context)throw Error("Pass AudioNode instance first");t||(t={}),t.context=e.context,t=Z(t,{context:"context",sampleRate:"sampleRate rate",channels:"channels channel numberOfChannels channelCount",samplesPerFrame:"samplesPerFrame length frame block blockSize blockLength frameSize frameLength"}),t=fe({mode:"script",samplesPerFrame:1024,channels:e.channelCount||2},t);let n,r,{context:a,channels:i,samplesPerFrame:o,sampleRate:s}=t,f=new cn(a,{length:o,numberOfChannels:i}),u=new Zn(0,i);if("script"===t.mode)n=function(){let e=a.createBufferSource();return e.loop=!0,e.buffer=new cn(a,{length:o,numberOfChannels:i}),(n=a.createScriptProcessor(o)).addEventListener("audioprocess",function(e){if(r)return;let t=g(e.inputBuffer.length);er.copy(t,e.outputBuffer),m(t.length)}),e.connect(n),e.start(),n}();else{if("buffer"!==t.mode)throw Error("Unknown mode. Choose from 'buffer' or 'script'");n=function(){(n=a.createBufferSource()).loop=!0,n.buffer=new cn(a,{length:2*o,numberOfChannels:i});let e=n.buffer;setTimeout(function n(i){if(r)return;let u=a.currentTime-f;if(t-u*s<o){let r=g(o);er.copy(r,e,t%e.length),t+=o,m(o),n()}else setTimeout(n,1e3*((t-o)/s-u))}),n.start();let t=0,f=a.currentTime;return n}()}n.connect(e);let l=[],c=[],h=0;return p.end=d,p;function p(e,t){return!r&&(null==e?(l.push(function(){d(),t&&t()}),c.push(h),null):(pn(e)||(e=Nn(e,{channels:i,context:a})),h+=e.length,u.append(e),t&&(l.push(t),c.push(h)),e))}function d(){m(h),r=!0,c=[],l=[],n.disconnect()}function g(e){e=e||o;let t=u.copy(0,e);return u.consume(e),t.length?(t.length<e&&(t=er.pad(t,e)),t):f}function m(e){if((h-=e)<0&&(h=0),c.length){for(let t=0,n=c.length;t<n;t++)c[t]=Math.max(c[t]-e,0);for(;c[0]<=0;)c.shift(),l.shift()()}}},cr=gr(Et),hr=gr(lr),pr=gr(on),dr=gr(fn);function gr(e){return e&&e.__esModule?e:{default:e}}let mr=new AudioContext,yr=mr.createAnalyser();yr.fftSize=512,yr.smoothingTimeConstant=.95,yr.connect(mr.destination);let vr=(0,cr.default)({color:"#001144",width:2}),br=(0,cr.default)({canvas:vr.canvas,color:"#006699",opacity:.2});(0,dr.default)(function e(){let t=new Uint8Array(yr.frequencyBinCount);yr.getByteFrequencyData(t),t[0]!==-1/0&&(br.update(t),br.render(),vr.render()),(0,dr.default)(e)});let wr=new Float64Array(512);wr[30]=1,vr.set(wr).render();let xr=(0,hr.default)(yr,{samplesPerFrame:256}),Ar=new pr.default(2*wr.length,{type:"real",radix:4}),Cr=Ar.scalarArrayFactory(),Or=Ar.vectorArrayFactory(),_r=Ar.vectorArrayFactory();xr(Or,function e(){Or.set(wr),Ar.ifft(Cr.buffer,Or.buffer,_r.buffer),xr(Cr,e)}),(0,W.on)(vr.canvas,"mousedown touchstart",e=>{let t=e.x-1,n=e.y;function r(e){for(let r=t,a=Math.sign(e.x-t);r!=e.x;r+=a){let a=r/vr.canvas.width,i=(r-t)/(e.x-t),o=1-(e.y*i+n*(1-i))/vr.canvas.height,s=Math.floor(a*wr.length),f=Math.ceil(a*wr.length);for(let e=s;e<f;e++)wr[e]=o}vr.set(wr).render(),br.render()}r(e),(0,W.on)(vr.canvas,"mousemove.draw touchmove.draw",e=>{r(e),t=e.x,n=e.y}),(0,W.on)(vr.canvas,"mouseup.draw touchend.draw mouseleave.draw",e=>{(0,W.off)(vr.canvas,".draw")})})}();
</script>
</html>
